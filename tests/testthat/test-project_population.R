# Run simple test
test_that("calculate project population", {
  # Input data ----
  ## Define stable parameters ----
  fert_first <- 16
  fert_last <- 50
  share_born_female <- 100 / 205

  ## One spatial unit ----
  subregional <- NULL

  ## Two nationalities ----
  binational <- TRUE

  ### Population for one spatial unit ----
  # population |>
  #   constructive::construct()
  population_short <- tibble::tibble(
    year = rep(2023L, 404L),
    spatial_unit = rep("Aargau", 404L),
    nat = rep(c("ch", "int"), each = 202L),
    sex = rep(rep(c("m", "f"), 2), each = 101L),
    age = rep(seq(0, 100, by = 1), 4),
    n_dec = c(
      2371, 2542, 2891, 2766, 2794, 2782, 2787, 2726, 2837, 2866, 2760, 2766, 2799,
      2823, 2707, 2768, 2660, 2744, 2759, 2767, 2730, 2686, 2639, 2872, 2812, 2874,
      2899, 3060, 2823, 2844, 3085, 3189, 3162, 3192, 3193, 3197, 3164, 3262, 3130,
      3280, 3263, 3300, 3269, 3288, 3131, 3091, 3087, 2931, 3008, 3194, 3242, 3371,
      3555, 3707, 3773, 4028, 4106, 4133, 4231, 4286, 4070, 4041, 3910, 3716, 3609,
      3443, 3416, 3277, 3219, 3054, 2977, 2865, 2641, 2672, 2552, 2582, 2485, 2406,
      2246, 2114, 2001, 1715, 1556, 1204, 1100, 1064, 915, 746, 688, 587, 446, 389,
      302, 234, 153, 118, 75, 35, 33, 15, 23, 2286, 2434, 2685, 2533, 2577, 2609,
      2671, 2660, 2642, 2599, 2580, 2653, 2600, 2763, 2581, 2683, 2549, 2564, 2527,
      2611, 2569, 2553, 2548, 2662, 2766, 2723, 2845, 2866, 2891, 2946, 2936, 3186,
      3172, 3268, 3149, 3267, 3238, 3240, 3184, 3288, 3272, 3375, 3408, 3272, 3224,
      3034, 3137, 3309, 3184, 3190, 3242, 3410, 3727, 3867, 3905, 4211, 4207, 4307,
      4287, 4399, 4297, 4143, 4054, 3949, 3751, 3732, 3716, 3524, 3425, 3272, 3168,
      3163, 2949, 2963, 2860, 2778, 2712, 2676, 2561, 2468, 2384, 2097, 1870, 1638,
      1556, 1432, 1275, 1259, 1059, 978, 806, 719, 560, 473, 378, 286, 203, 148, 97,
      67, 82, 945, 1123, 1157, 1137, 1159, 1189, 1143, 1228, 1121, 1162, 1113, 1156,
      1106, 1004, 1000, 1075, 954, 1076, 1064, 968, 919, 960, 986, 1162, 1231, 1378,
      1517, 1635, 1638, 1769, 1899, 1956, 2082, 2226, 2179, 2149, 2293, 2244, 2248,
      2321, 2216, 2253, 2236, 2176, 2086, 2051, 1928, 1879, 1784, 1726, 1690, 1694,
      1592, 1542, 1570, 1529, 1532, 1506, 1501, 1415, 1272, 1132, 1021, 1007, 817,
      753, 628, 592, 567, 495, 430, 403, 398, 440, 357, 369, 313, 310, 242, 281,
      263, 275, 208, 234, 202, 166, 118, 124, 95, 58, 41, 19, 18, 11, 16, 7, 3, 0,
      0, 0, 1, 928, 974, 1100, 1145, 1094, 1075, 1049, 1128, 1064, 1089, 1023, 1039,
      933, 1023, 958, 920, 884, 808, 832, 798, 766, 780, 818, 948, 1028, 1162, 1317,
      1382, 1515, 1571, 1668, 1792, 1808, 1919, 1913, 1958, 1966, 1986, 2002, 1973,
      1966, 1986, 1912, 1873, 1714, 1776, 1634, 1542, 1568, 1485, 1392, 1481, 1390,
      1281, 1303, 1220, 1223, 1181, 1079, 1098, 980, 876, 824, 827, 696, 640, 541,
      509, 517, 500, 445, 403, 382, 374, 360, 374, 263, 292, 230, 241, 199, 234,
      207, 226, 204, 156, 152, 93, 93, 60, 59, 34, 30, 21, 21, 13, 10, 4, 3, 1, 1
    ),
  )

  ### Parameters for one spatial unit ----
  # fso_parameters |>
  #   filter(year == 2024) |>
  #   constructive::construct()
  parameters_short_1 <- tibble::tibble(
    year = rep(2024, 404L),
    scen = rep("reference", 404L),
    spatial_unit = rep("Aargau", 404L),
    nat = rep(c("ch", "int"), each = 202L),
    sex = rep(rep(c("m", "f"), 2), each = 101L),
    age = rep(seq(0, 100, by = 1), 4),
    birthrate = rep(
      c(
        0, 0.000786, 0.001905, 0.003492, 0.007046, 0.012176, 0.019929, 0.02971,
        0.042272, 0.056318, 0.072873, 0.090109, 0.107578, 0.122186, 0.132523,
        0.135355, 0.12911, 0.11495, 0.095094, 0.073338, 0.0528, 0.03633, 0.023788,
        0.015445, 0.009697, 0.006117, 0.004249, 0.002776, 0.001966, 0.001269,
        0.001205, 0.000939, 0, 0.002294, 0.006246, 0.013237, 0.022263, 0.03287,
        0.045122, 0.058621, 0.074553, 0.089661, 0.105906, 0.119392, 0.134024,
        0.143492, 0.149355, 0.148472, 0.143324, 0.133261, 0.120031, 0.104639,
        0.087857, 0.071573, 0.057, 0.043748, 0.032828, 0.023834, 0.016591, 0.010969,
        0.007469, 0.004657, 0.002814, 0.001222, 0.000647, 0.000637, 0
      ),
      rep(c(120L, 1L, 169L, 1L, 51L), c(1L, 31L, 1L, 33L, 1L))
    ),
    int_mothers = rep(0.2499218016890835, 404L),
    mor = c(
      0.003395, 0.000414, 0.000389, 0.000343, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.000365, 0.000357, 0.000372, 0.000361, 0.000362, 0.000361, 0.000367,
      0.000372, 0.000379, 0.000349, 0.000357, 0.000349, 0.000346, 0.000328,
      0.000353, 0.00035, 0.000645, 0.000312, 0.000627, 0.00062, 0.00062, 0.000619,
      0.000626, 0.000607, 0.000633, 0.000604, 0.000608, 0.000902, 0.000911,
      0.000906, 0.000951, 0.000964, 0.001287, 0.001356, 0.001652, 0.001869,
      0.001841, 0.002066, 0.002242, 0.002689, 0.002907, 0.00322, 0.003647, 0.003865,
      0.00425, 0.004897, 0.005155, 0.005689, 0.006135, 0.006727, 0.007224, 0.007839,
      0.008194, 0.009155, 0.009943, 0.010813, 0.011761, 0.013268, 0.014394, 0.01647,
      0.018812, 0.021693, 0.024955, 0.0291, 0.033385, 0.038771, 0.044989, 0.051297,
      0.059126, 0.067276, 0.07542, 0.084626, 0.093989, 0.103217, 0.113372, 0.122658,
      0.132139, 0.141207, 0.15894, 0.179487, 0.208469, 0.237288, 0.28, 0.314286,
      0.333333, 0.394737, 0.002766, 0.000432, 0.000407, 0.000369, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000376, 0.000362, 0.000368,
      0.000352, 0.000349, 0.000345, 0.000338, 0.000338, 0.000312, 0.000313,
      0.000303, 0.000314, 0.000303, 0.000306, 0.000305, 0.00031, 0.000301, 0.000606,
      0.000588, 0.000582, 0.000607, 0.000617, 0.000655, 0.000951, 0.000903,
      0.000938, 0.001249, 0.001229, 0.001461, 0.001606, 0.001807, 0.001789,
      0.002135, 0.002375, 0.002553, 0.002797, 0.002953, 0.003257, 0.003619,
      0.003945, 0.004309, 0.0048, 0.00509, 0.00565, 0.006244, 0.007008, 0.007641,
      0.008208, 0.00917, 0.010173, 0.011477, 0.012939, 0.014399, 0.016224, 0.018688,
      0.021081, 0.024306, 0.028104, 0.03242, 0.037958, 0.044553, 0.05204, 0.06141,
      0.072129, 0.084954, 0.099057, 0.114402, 0.131351, 0.148611, 0.165923, 0.18585,
      0.206077, 0.226481, 0.2457, 0.263514, 0.28866, 0.342282, 0.003226, 0.001043,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000935, 0.001048, 0.000929,
      0.000925, 0.001005, 0.001048, 0.000997, 0.000962, 0.00082, 0.000772, 0.000693,
      0.000631, 0.000587, 0.000584, 0.000544, 0.000509, 0.000495, 0.000468, 0.00044,
      0.000449, 0.000455, 0.000429, 0.000439, 0.000439, 0.000427, 0.000447,
      0.000881, 0.000891, 0.000915, 0.000955, 0.000973, 0.001034, 0.001062,
      0.001119, 0.001733, 0.001772, 0.00177, 0.001883, 0.001945, 0.002553, 0.002628,
      0.003289, 0.003351, 0.004038, 0.004293, 0.00476, 0.005362, 0.00597, 0.00711,
      0.007638, 0.008208, 0.009654, 0.010195, 0.012422, 0.014213, 0.014035,
      0.017435, 0.017677, 0.020501, 0.022472, 0.02449, 0.025641, 0.029126, 0.029046,
      0.032143, 0.038095, 0.040219, 0.043269, 0.051282, 0.054455, 0.066066,
      0.075949, 0.089069, 0.10582, 0.12069, 0.146341, 0.157895, 0.222222, 0.272727,
      0.25, 0.285714, 0.333333, 0, 0, 1, 0.002525, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000814, 0.000723, 0.000691,
      0.000635, 0.000614, 0.000582, 0.000545, 0.000542, 0.000513, 0.000515,
      0.000505, 0.000504, 0.0005, 0.000497, 0.000505, 0.000507, 0.000503, 0.000522,
      0.000533, 0.000582, 0.000563, 0.000611, 0.000647, 0.000637, 0.001345,
      0.001432, 0.001349, 0.001436, 0.001558, 0.001536, 0.002461, 0.002468, 0.00256,
      0.002812, 0.002769, 0.003102, 0.00347, 0.003692, 0.003695, 0.004348, 0.004721,
      0.005571, 0.0059, 0.005825, 0.008032, 0.009019, 0.009938, 0.010485, 0.010695,
      0.011111, 0.013369, 0.015209, 0.017123, 0.021645, 0.020747, 0.025189,
      0.029979, 0.033898, 0.039911, 0.04902, 0.057508, 0.065789, 0.074468, 0.086022,
      0.1, 0.116667, 0.147059, 0.166667, 0.190476, 0.190476, 0.230769, 0.2, 0.25,
      0.333333, 0.333333
    ),
    emi_int = c(
      0.002279, 0.005495, 0.005114, 0.004843, 0.0047, 0.004295, 0.003954, 0.003588,
      0.003302, 0.003172, 0.002791, 0.002536, 0.002169, 0.002144, 0.001771,
      0.001847, 0.001806, 0.002256, 0.002915, 0.003986, 0.004698, 0.005495,
      0.005957, 0.006442, 0.006616, 0.006757, 0.006959, 0.006899, 0.006863,
      0.006022, 0.005977, 0.006159, 0.005958, 0.005376, 0.005013, 0.005011,
      0.004692, 0.004425, 0.004292, 0.004153, 0.003963, 0.003678, 0.003636,
      0.003365, 0.003345, 0.003194, 0.003235, 0.003239, 0.003071, 0.002992,
      0.003131, 0.003085, 0.00356, 0.003657, 0.003777, 0.004241, 0.004469, 0.004871,
      0.005081, 0.005436, 0.0056, 0.005405, 0.005197, 0.004604, 0.004306, 0.00665,
      0.005228, 0.003806, 0.003662, 0.003417, 0.003274, 0.002687, 0.002443,
      0.002272, 0.001871, 0.001567, 0.001549, 0.001207, 0.001247, 0.00089, 0.000946,
      0.001, 0.000583, 0.000643, 0.000831, 0.000909, 0.00094, 0.001093, 0.00134,
      0.001453, 0.001704, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00319, 0.005709, 0.005341,
      0.005214, 0.005132, 0.004657, 0.004599, 0.003744, 0.003383, 0.003028,
      0.002693, 0.002713, 0.002262, 0.001923, 0.00181, 0.00155, 0.001864, 0.001962,
      0.00273, 0.003563, 0.004596, 0.00506, 0.005484, 0.005887, 0.006389, 0.006508,
      0.00661, 0.006327, 0.005932, 0.00588, 0.005771, 0.00545, 0.005022, 0.004729,
      0.00459, 0.004446, 0.004285, 0.004015, 0.003395, 0.003455, 0.003345, 0.003362,
      0.003259, 0.002934, 0.003056, 0.003102, 0.002966, 0.003188, 0.003324,
      0.003141, 0.003448, 0.003393, 0.004106, 0.004025, 0.004138, 0.004097,
      0.004037, 0.004041, 0.003947, 0.003732, 0.003637, 0.003724, 0.003621,
      0.003453, 0.003545, 0.002933, 0.002412, 0.001884, 0.001419, 0.001168,
      0.000917, 0.000947, 0.000948, 0.000678, 0.000675, 0.000699, 0.00072, 0.000737,
      0.000747, 0.00039, 0.000405, 0.000419, 0.000477, 0.000535, 0.000611, 0.000643,
      0.000698, 0.000784, 0.000794, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.008958,
      0.044565, 0.0375, 0.031115, 0.026385, 0.022433, 0.020185, 0.016623, 0.015472,
      0.012489, 0.012048, 0.010782, 0.009516, 0.009042, 0.007968, 0.007, 0.007442,
      0.008386, 0.012082, 0.015038, 0.022727, 0.02938, 0.035417, 0.039554, 0.043029,
      0.043867, 0.044993, 0.043507, 0.043425, 0.042125, 0.040701, 0.038968,
      0.037832, 0.036984, 0.035939, 0.034878, 0.033969, 0.03358, 0.032086, 0.031584,
      0.031021, 0.029783, 0.028838, 0.02907, 0.027574, 0.026833, 0.026329, 0.025415,
      0.024494, 0.024664, 0.023754, 0.023077, 0.023022, 0.022613, 0.022698,
      0.024204, 0.026161, 0.029373, 0.030544, 0.029314, 0.032509, 0.025157,
      0.030919, 0.038198, 0.051587, 0.085679, 0.063745, 0.02707, 0.016892, 0.015873,
      0.014141, 0.013953, 0.012407, 0.012563, 0.011338, 0.011204, 0.01084, 0.009585,
      0.009677, 0.008264, 0.007117, 0.007576, 0.007273, 0.004808, 0.004274, 0.00495,
      0.005988, 0.008403, 0.008065, 0.010526, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.004274, 0.035635, 0.031828, 0.029091, 0.027948, 0.02468, 0.021395, 0.020019,
      0.016844, 0.015038, 0.013774, 0.012708, 0.012512, 0.012862, 0.012708,
      0.012526, 0.013043, 0.013575, 0.016089, 0.015625, 0.017544, 0.019582,
      0.021795, 0.025672, 0.028481, 0.030156, 0.030981, 0.030372, 0.029667,
      0.030363, 0.030554, 0.029976, 0.029018, 0.027655, 0.026055, 0.025091,
      0.023493, 0.021872, 0.020645, 0.018981, 0.017748, 0.016785, 0.015609,
      0.015167, 0.014415, 0.014002, 0.013514, 0.013464, 0.01297, 0.012755, 0.012795,
      0.012213, 0.012154, 0.01223, 0.013271, 0.015349, 0.018033, 0.022895, 0.026249,
      0.032437, 0.034608, 0.035678, 0.035388, 0.036408, 0.04474, 0.027299, 0.025,
      0.020333, 0.017647, 0.015474, 0.014, 0.013483, 0.012407, 0.010471, 0.010695,
      0.011111, 0.010695, 0.015209, 0.013699, 0.012987, 0.012448, 0.015075,
      0.012821, 0.014493, 0.013274, 0.014706, 0.012821, 0.013158, 0.010638,
      0.010753, 0.016667, 0.016667, 0.029412, 0.033333, 0, 0, 0, 0, 0, 0, 0
    ),
    emi_nat = c(
      0.007976, 0.02071, 0.02203, 0.018679, 0.015907, 0.013601, 0.011862, 0.010405,
      0.008804, 0.007755, 0.006978, 0.006159, 0.005423, 0.004645, 0.004251,
      0.004064, 0.003974, 0.005263, 0.008382, 0.013043, 0.01807, 0.024176, 0.030901,
      0.038272, 0.045613, 0.05192, 0.056019, 0.057951, 0.057516, 0.054906, 0.051336,
      0.047002, 0.042333, 0.037951, 0.033835, 0.030379, 0.027213, 0.024652,
      0.022379, 0.020447, 0.018902, 0.017775, 0.016364, 0.015601, 0.014599,
      0.014053, 0.013264, 0.012634, 0.012282, 0.011636, 0.011271, 0.010796,
      0.010383, 0.010127, 0.009711, 0.009276, 0.008937, 0.008768, 0.008468,
      0.008036, 0.007933, 0.007617, 0.007424, 0.007161, 0.00915, 0.012746, 0.00639,
      0.00644, 0.006103, 0.005902, 0.005894, 0.00571, 0.005585, 0.005301, 0.00524,
      0.005094, 0.005035, 0.004829, 0.004572, 0.004452, 0.004255, 0.004498,
      0.004082, 0.003856, 0.004153, 0.003636, 0.003759, 0.003279, 0.004021,
      0.002907, 0.003407, 0.004484, 0.002571, 0.003311, 0.004274, 0, 0, 0, 0, 0, 0,
      0.008772, 0.028107, 0.023007, 0.018994, 0.015792, 0.013194, 0.011115, 0.00936,
      0.008271, 0.007192, 0.006541, 0.005814, 0.005654, 0.005385, 0.005429,
      0.005424, 0.006336, 0.008239, 0.01209, 0.018606, 0.027959, 0.038926, 0.05092,
      0.061617, 0.069899, 0.074837, 0.076019, 0.074165, 0.069784, 0.063646,
      0.057026, 0.049728, 0.043315, 0.037201, 0.031824, 0.027628, 0.023875,
      0.021001, 0.018519, 0.016646, 0.015511, 0.014364, 0.013333, 0.012617,
      0.012225, 0.011787, 0.011536, 0.011157, 0.010879, 0.010678, 0.010345,
      0.010179, 0.009971, 0.009928, 0.009827, 0.009475, 0.009261, 0.009033,
      0.008823, 0.008631, 0.008411, 0.008378, 0.007965, 0.007893, 0.009876,
      0.009064, 0.007235, 0.006997, 0.00681, 0.006423, 0.006418, 0.005997, 0.005691,
      0.005765, 0.0054, 0.005245, 0.00504, 0.004794, 0.004484, 0.004295, 0.004052,
      0.004195, 0.003815, 0.003743, 0.003663, 0.003213, 0.002793, 0.003137,
      0.002383, 0.002833, 0.002045, 0.002481, 0.001391, 0.001786, 0.002114,
      0.002646, 0, 0, 0, 0, 0, 0.004886, 0.023913, 0.021429, 0.019879, 0.01759,
      0.015531, 0.014298, 0.012248, 0.011401, 0.009813, 0.008606, 0.008086, 0.00692,
      0.006329, 0.00498, 0.005, 0.004651, 0.006289, 0.010223, 0.016917, 0.025826,
      0.03482, 0.044792, 0.052738, 0.05852, 0.062551, 0.064586, 0.06526, 0.06422,
      0.062271, 0.059921, 0.056872, 0.054192, 0.050913, 0.048068, 0.044975,
      0.042345, 0.039686, 0.037879, 0.035587, 0.034037, 0.032942, 0.0315, 0.030859,
      0.029871, 0.029229, 0.028279, 0.02749, 0.027157, 0.026345, 0.025492, 0.024852,
      0.023613, 0.022613, 0.021401, 0.020382, 0.019621, 0.018277, 0.017264,
      0.015989, 0.014841, 0.013365, 0.012367, 0.011753, 0.010913, 0.011016,
      0.010624, 0.009554, 0.008446, 0.007055, 0.006061, 0.006977, 0.004963,
      0.005025, 0.004535, 0.002801, 0.00271, 0.003195, 0.003226, 0.004132, 0.003559,
      0.003788, 0.003636, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.003419, 0.024499, 0.021561, 0.019091, 0.017467, 0.015539, 0.013953,
      0.012393, 0.011525, 0.010338, 0.009183, 0.00782, 0.0077, 0.006431, 0.005865,
      0.005219, 0.005435, 0.007919, 0.013614, 0.02524, 0.038847, 0.050914, 0.060256,
      0.066015, 0.068565, 0.067121, 0.065404, 0.061503, 0.057164, 0.052805,
      0.048377, 0.044365, 0.040737, 0.037058, 0.033872, 0.030842, 0.028601,
      0.025941, 0.024169, 0.022478, 0.021298, 0.019837, 0.019134, 0.018305,
      0.018153, 0.017503, 0.017455, 0.017136, 0.016861, 0.017219, 0.016835,
      0.016523, 0.01688, 0.016547, 0.015613, 0.015349, 0.014754, 0.014718, 0.013548,
      0.012975, 0.01184, 0.011213, 0.010274, 0.008495, 0.007255, 0.005747, 0.004688,
      0.003697, 0.003922, 0.003868, 0.004, 0.004494, 0.002481, 0.002618, 0.002674,
      0.002778, 0.002674, 0.003802, 0.003425, 0.004329, 0.004149, 0.005025,
      0.004274, 0.004831, 0.004425, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    acq = rep(
      c(
        0, 0.001629, 0.015217, 0.016071, 0.016422, 0.016711, 0.017256, 0.017662,
        0.019248, 0.021173, 0.024086, 0.028399, 0.032345, 0.037197, 0.042495,
        0.046813, 0.051, 0.052093, 0.051363, 0.046468, 0.023496, 0.019628, 0.018498,
        0.016667, 0.014199, 0.012909, 0.011373, 0.01016, 0.009229, 0.008563, 0.007937,
        0.007914, 0.008425, 0.008691, 0.009126, 0.010332, 0.011014, 0.012099,
        0.013083, 0.013815, 0.01468, 0.015511, 0.015794, 0.015972, 0.0161, 0.016085,
        0.016291, 0.01609, 0.016079, 0.014909, 0.015135, 0.013905, 0.013609, 0.013577,
        0.012563, 0.012322, 0.011465, 0.011118, 0.010444, 0.00996, 0.009327, 0.009187,
        0.008648, 0.007951, 0.007835, 0.006944, 0.00612, 0.00664, 0.004777, 0.005068,
        0.005291, 0.00404, 0.004651, 0.002481, 0.002513, 0.002268, 0.002801, 0.00271,
        0.003195, 0.003226, 0.004132, 0.003559, 0.003788, 0.003636, 0, 0.002564,
        0.023385, 0.022587, 0.019091, 0.018341, 0.017367, 0.017674, 0.019066,
        0.021277, 0.023496, 0.028466, 0.033236, 0.037536, 0.042872, 0.050831,
        0.055324, 0.057609, 0.056561, 0.050743, 0.042067, 0.036341, 0.032637,
        0.026923, 0.023227, 0.020042, 0.016537, 0.013769, 0.01139, 0.010854, 0.010561,
        0.010185, 0.011391, 0.012277, 0.013827, 0.015633, 0.016728, 0.016854,
        0.017803, 0.01863, 0.01998, 0.020284, 0.020346, 0.020141, 0.020397, 0.019754,
        0.019253, 0.018581, 0.01836, 0.01751, 0.016582, 0.016162, 0.015086, 0.01418,
        0.013669, 0.01249, 0.012279, 0.009836, 0.009812, 0.008467, 0.008341, 0.007286,
        0.007136, 0.005708, 0.004854, 0.004837, 0.00431, 0.003125, 0.003697, 0.001961,
        0.001934, 0.002, 0.002247, 0.002481, 0.002618, 0
      ),
      rep(c(202L, 1L, 18L, 1L, 27L), c(1L, 83L, 1L, 74L, 1L))
    ),
    imm_int_n = c(
      5, 55, 21, 21, 19, 18, 18, 17, 16, 14, 13, 12, 11, 9, 8, 7, 7, 7, 7, 8, 10,
      12, 14, 16, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 17, 17, 16, 16, 15,
      15, 14, 14, 13, 12, 12, 11, 11, 11, 11, 12, 13, 14, 14, 15, 15, 15, 15, 14,
      14, 13, 13, 12, 11, 11, 10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 5, 5, 4, 4, 4, 3, 3, 3,
      2, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 50, 19, 18, 17, 15,
      14, 13, 12, 11, 10, 9, 9, 8, 8, 8, 8, 9, 8, 8, 9, 10, 11, 12, 14, 15, 16, 17,
      17, 18, 19, 18, 18, 18, 18, 18, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 9, 9,
      8, 8, 8, 9, 9, 9, 9, 9, 8, 8, 8, 8, 8, 8, 8, 8, 7, 7, 7, 7, 6, 6, 6, 5, 5, 5,
      4, 4, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0,
      0, 17, 127, 64, 62, 60, 58, 57, 56, 55, 54, 54, 53, 53, 51, 49, 47, 46, 49,
      57, 71, 89, 110, 132, 152, 170, 184, 193, 200, 203, 203, 199, 194, 188, 181,
      173, 165, 156, 148, 140, 132, 124, 117, 111, 104, 98, 93, 88, 83, 78, 74, 70,
      66, 62, 57, 52, 47, 41, 36, 32, 27, 23, 19, 16, 14, 11, 10, 8, 7, 6, 5, 4, 3,
      3, 2, 2, 2, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 20, 136, 65, 62, 59, 57, 55, 54, 52, 51, 50, 49, 47, 46, 43, 41, 38,
      36, 37, 45, 63, 88, 114, 138, 154, 165, 169, 170, 166, 160, 153, 145, 137,
      129, 121, 113, 106, 99, 93, 87, 82, 77, 72, 68, 64, 61, 57, 54, 51, 49, 46,
      44, 42, 39, 36, 33, 29, 25, 22, 19, 16, 14, 12, 10, 9, 7, 6, 6, 5, 4, 4, 4, 4,
      3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0,
      0, 0
    ),
    imm_nat_n = c(
      47, 88, 88, 79, 62, 49, 41, 35, 30, 26, 23, 21, 19, 17, 17, 16, 16, 17, 19,
      25, 34, 49, 69, 89, 110, 119, 130, 141, 151, 153, 158, 159, 160, 156, 147,
      135, 123, 110, 101, 91, 84, 75, 69, 64, 59, 55, 50, 47, 44, 43, 44, 42, 43,
      41, 40, 40, 41, 40, 41, 38, 37, 37, 34, 31, 33, 35, 29, 25, 21, 18, 15, 14,
      13, 11, 11, 10, 10, 9, 8, 8, 7, 6, 5, 5, 4, 4, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1,
      0, 0, 0, 0, 0, 57, 81, 79, 75, 57, 47, 38, 32, 27, 23, 20, 17, 16, 14, 13, 12,
      14, 20, 32, 51, 73, 94, 115, 137, 168, 182, 189, 190, 190, 179, 171, 163, 157,
      145, 135, 122, 112, 99, 92, 83, 75, 67, 62, 55, 51, 45, 41, 39, 38, 37, 38,
      39, 41, 43, 43, 44, 44, 42, 42, 42, 43, 41, 39, 37, 35, 33, 28, 25, 21, 18,
      17, 15, 14, 13, 13, 12, 12, 11, 10, 10, 9, 8, 8, 7, 6, 5, 5, 4, 4, 4, 3, 3, 2,
      1, 1, 1, 1, 1, 0, 0, 0, 20, 28, 29, 29, 25, 23, 22, 21, 19, 18, 17, 15, 13,
      12, 12, 12, 12, 14, 18, 23, 31, 37, 48, 60, 79, 91, 103, 116, 122, 127, 132,
      136, 137, 135, 135, 132, 130, 121, 116, 111, 103, 96, 91, 84, 81, 73, 68, 62,
      58, 52, 49, 44, 42, 38, 36, 34, 32, 29, 27, 25, 22, 18, 16, 13, 12, 11, 9, 6,
      5, 4, 3, 3, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 19, 33, 33, 31, 27, 23, 21, 18, 16, 14, 12, 11, 9, 8, 7,
      6, 7, 9, 13, 22, 32, 41, 51, 60, 73, 82, 91, 97, 101, 103, 100, 98, 97, 90,
      86, 81, 75, 67, 62, 56, 52, 48, 44, 41, 38, 35, 34, 32, 30, 28, 27, 26, 25,
      25, 23, 22, 21, 18, 17, 15, 14, 11, 10, 8, 8, 7, 6, 4, 4, 3, 2, 2, 2, 2, 2, 2,
      2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
  )


  # first projection ----
  project_population_default_1 <- project_population(
    population_short,
    parameters_short_1,
    fert_first,
    fert_last,
    share_born_female,
    subregional,
    binational
  )

  expect_snapshot(constructive::construct(project_population_default_1))

  # second projection ----
  ### Parameters for one spatial unit ----
  # fso_parameters |>
  #   filter(year == 2025) |>
  #   constructive::construct()
  parameters_short_2 <- tibble::tibble(
    nat = rep(c("ch", "int"), each = 606L),
    sex = rep(rep(c("m", "f"), 6), each = 101L),
    age = rep(seq(0, 100, by = 1), 12),
    start_n = c(
      0, 2481, 2452, 2595, 2935, 2804, 2827, 2814, 2816, 2760, 2869, 2901, 2799,
      2812, 2847, 2872, 2759, 2823, 2705, 2781, 2767, 2764, 2724, 2683, 2637, 2859,
      2793, 2851, 2880, 3042, 2830, 2865, 3109, 3225, 3212, 3248, 3250, 3254, 3220,
      3315, 3186, 3331, 3308, 3344, 3311, 3327, 3169, 3124, 3119, 2960, 3035, 3218,
      3263, 3392, 3569, 3717, 3781, 4030, 4102, 4129, 4220, 4267, 4053, 4020, 3889,
      3689, 3562, 3417, 3387, 3245, 3182, 3016, 2937, 2822, 2598, 2624, 2500, 2523,
      2419, 2334, 2169, 2031, 1908, 1624, 1461, 1119, 1012, 965, 820, 659, 600, 505,
      378, 326, 247, 187, 119, 88, 54, 24, 45, 0, 2371, 2344, 2477, 2728, 2570,
      2608, 2637, 2697, 2687, 2670, 2631, 2613, 2690, 2638, 2809, 2628, 2729, 2595,
      2602, 2561, 2636, 2582, 2554, 2541, 2654, 2752, 2715, 2834, 2865, 2896, 2961,
      2967, 3223, 3222, 3324, 3213, 3330, 3301, 3307, 3250, 3348, 3327, 3426, 3451,
      3314, 3258, 3067, 3164, 3329, 3204, 3209, 3260, 3426, 3738, 3873, 3911, 4209,
      4202, 4300, 4280, 4390, 4286, 4131, 4040, 3922, 3730, 3711, 3694, 3500, 3399,
      3244, 3139, 3131, 2915, 2925, 2819, 2734, 2665, 2623, 2503, 2404, 2312, 2025,
      1795, 1562, 1471, 1340, 1178, 1147, 951, 862, 697, 609, 463, 381, 296, 218,
      150, 106, 162, 0, 2651, 2460, 2599, 2941, 2809, 2831, 2818, 2822, 2765, 2873,
      2907, 2805, 2818, 2853, 2878, 2764, 2830, 2712, 2788, 2770, 2766, 2726, 2685,
      2639, 2863, 2797, 2854, 2883, 3045, 2834, 2870, 3112, 3229, 3216, 3254, 3254,
      3259, 3226, 3321, 3190, 3338, 3315, 3350, 3317, 3332, 3175, 3131, 3123, 2965,
      3040, 3222, 3269, 3397, 3573, 3721, 3784, 4034, 4106, 4131, 4222, 4270, 4057,
      4022, 3890, 3692, 3563, 3419, 3390, 3247, 3186, 3017, 2940, 2825, 2601, 2627,
      2503, 2525, 2422, 2335, 2172, 2033, 1910, 1628, 1464, 1123, 1018, 973, 829,
      669, 610, 515, 388, 335, 254, 192, 122, 90, 54, 24, 45, 0, 2535, 2351, 2484,
      2733, 2575, 2612, 2639, 2701, 2692, 2674, 2636, 2618, 2696, 2643, 2816, 2636,
      2736, 2602, 2607, 2564, 2637, 2585, 2556, 2544, 2658, 2754, 2718, 2837, 2870,
      2902, 2966, 2973, 3228, 3226, 3331, 3219, 3337, 3307, 3313, 3257, 3354, 3332,
      3431, 3458, 3318, 3261, 3071, 3167, 3332, 3208, 3212, 3263, 3428, 3740, 3874,
      3914, 4210, 4204, 4301, 4281, 4392, 4287, 4132, 4041, 3925, 3731, 3714, 3696,
      3501, 3400, 3247, 3141, 3133, 2919, 2928, 2822, 2738, 2668, 2625, 2508, 2409,
      2317, 2030, 1800, 1566, 1476, 1346, 1184, 1153, 956, 868, 702, 614, 468, 386,
      301, 223, 154, 109, 167, 0, 2279, 2448, 2588, 2930, 2799, 2821, 2808, 2812,
      2754, 2864, 2895, 2793, 2804, 2842, 2866, 2752, 2815, 2700, 2776, 2765, 2761,
      2721, 2679, 2632, 2856, 2789, 2846, 2875, 3037, 2827, 2863, 3104, 3221, 3208,
      3245, 3245, 3248, 3215, 3310, 3180, 3327, 3301, 3338, 3307, 3322, 3163, 3121,
      3113, 2957, 3030, 3214, 3258, 3388, 3565, 3713, 3777, 4027, 4099, 4124, 4216,
      4267, 4051, 4018, 3886, 3687, 3561, 3415, 3385, 3243, 3181, 3013, 2933, 2819,
      2595, 2620, 2497, 2519, 2415, 2329, 2164, 2027, 1904, 1618, 1455, 1114, 1007,
      961, 816, 656, 596, 500, 375, 323, 245, 185, 118, 87, 53, 24, 45, 0, 2177,
      2338, 2472, 2724, 2566, 2605, 2632, 2694, 2683, 2666, 2626, 2609, 2685, 2631,
      2803, 2622, 2723, 2589, 2597, 2556, 2631, 2577, 2550, 2537, 2652, 2748, 2712,
      2830, 2862, 2892, 2957, 2964, 3218, 3215, 3318, 3207, 3325, 3296, 3299, 3243,
      3340, 3319, 3421, 3446, 3308, 3252, 3062, 3159, 3326, 3201, 3206, 3257, 3424,
      3736, 3869, 3907, 4207, 4201, 4298, 4278, 4388, 4284, 4129, 4038, 3923, 3728,
      3711, 3690, 3496, 3396, 3242, 3136, 3127, 2912, 2923, 2816, 2731, 2661, 2619,
      2499, 2400, 2306, 2020, 1790, 1556, 1465, 1334, 1173, 1142, 945, 856, 691,
      603, 457, 375, 291, 214, 147, 103, 156, 0, 1173, 994, 1127, 1165, 1149, 1170,
      1199, 1160, 1238, 1135, 1172, 1121, 1155, 1103, 1002, 994, 1062, 952, 1074,
      1089, 1010, 974, 1029, 1069, 1254, 1334, 1482, 1627, 1742, 1754, 1882, 2006,
      2060, 2174, 2305, 2259, 2228, 2352, 2299, 2295, 2353, 2246, 2274, 2248, 2185,
      2094, 2055, 1932, 1882, 1785, 1729, 1687, 1690, 1588, 1537, 1557, 1512, 1506,
      1473, 1468, 1378, 1247, 1104, 986, 961, 756, 709, 610, 578, 554, 483, 419,
      392, 386, 427, 346, 357, 303, 299, 233, 269, 253, 262, 199, 223, 191, 155,
      109, 112, 83, 50, 33, 15, 13, 8, 11, 5, 2, 0, 0, 0, 1127, 987, 994, 1113,
      1155, 1106, 1089, 1062, 1136, 1071, 1091, 1024, 1031, 926, 1002, 934, 896,
      861, 792, 826, 811, 803, 843, 901, 1041, 1132, 1269, 1422, 1491, 1614, 1663,
      1750, 1863, 1869, 1968, 1956, 1993, 1993, 2007, 2015, 1981, 1972, 1987, 1913,
      1872, 1716, 1774, 1635, 1546, 1566, 1486, 1396, 1479, 1391, 1282, 1298, 1213,
      1208, 1161, 1055, 1068, 955, 853, 801, 797, 683, 629, 534, 505, 510, 492, 438,
      397, 378, 369, 354, 368, 259, 286, 225, 234, 194, 226, 200, 215, 195, 147,
      140, 86, 84, 53, 52, 29, 24, 17, 17, 10, 7, 3, 4, 0, 1242, 997, 1129, 1170,
      1153, 1176, 1206, 1165, 1243, 1141, 1176, 1124, 1160, 1105, 1005, 996, 1063,
      953, 1076, 1098, 1021, 989, 1046, 1092, 1277, 1360, 1508, 1653, 1769, 1783,
      1907, 2030, 2083, 2195, 2323, 2277, 2244, 2363, 2311, 2306, 2360, 2254, 2282,
      2252, 2193, 2100, 2060, 1938, 1887, 1790, 1733, 1693, 1693, 1592, 1540, 1559,
      1511, 1503, 1473, 1465, 1374, 1243, 1100, 983, 954, 748, 703, 609, 579, 553,
      483, 419, 393, 387, 428, 347, 357, 303, 299, 233, 270, 251, 261, 199, 222,
      191, 155, 109, 112, 84, 51, 35, 16, 14, 8, 12, 5, 2, 0, 0, 0, 1194, 992, 998,
      1119, 1158, 1111, 1094, 1067, 1140, 1077, 1095, 1028, 1035, 929, 1002, 935,
      895, 860, 793, 830, 819, 816, 860, 922, 1064, 1158, 1293, 1447, 1513, 1635,
      1683, 1767, 1878, 1884, 1980, 1967, 2003, 2002, 2014, 2021, 1988, 1978, 1992,
      1917, 1876, 1722, 1778, 1639, 1549, 1571, 1488, 1399, 1482, 1393, 1285, 1300,
      1215, 1205, 1160, 1052, 1066, 950, 850, 798, 794, 681, 628, 533, 504, 510,
      492, 438, 398, 377, 370, 356, 369, 259, 287, 226, 236, 193, 226, 199, 216,
      194, 148, 142, 87, 85, 54, 53, 29, 25, 17, 17, 10, 8, 3, 4, 0, 1088, 984,
      1121, 1161, 1144, 1166, 1196, 1153, 1233, 1130, 1169, 1117, 1153, 1099, 999,
      992, 1061, 949, 1070, 1081, 998, 960, 1010, 1050, 1231, 1310, 1458, 1601,
      1715, 1728, 1856, 1981, 2036, 2153, 2286, 2241, 2213, 2337, 2285, 2283, 2341,
      2237, 2266, 2239, 2180, 2089, 2049, 1926, 1873, 1781, 1723, 1684, 1686, 1585,
      1535, 1556, 1512, 1505, 1476, 1470, 1381, 1248, 1106, 990, 967, 765, 714, 610,
      580, 554, 484, 419, 393, 387, 427, 347, 357, 303, 299, 233, 269, 252, 263,
      199, 222, 190, 155, 108, 111, 83, 49, 33, 15, 13, 8, 11, 5, 2, 0, 0, 0, 1047,
      977, 988, 1109, 1151, 1101, 1084, 1057, 1132, 1067, 1087, 1019, 1029, 924,
      1001, 934, 896, 860, 792, 823, 805, 793, 826, 879, 1017, 1108, 1243, 1398,
      1465, 1594, 1643, 1732, 1846, 1856, 1957, 1946, 1984, 1985, 1999, 2009, 1976,
      1969, 1982, 1909, 1867, 1713, 1771, 1632, 1542, 1563, 1482, 1391, 1475, 1386,
      1279, 1297, 1212, 1207, 1162, 1057, 1072, 957, 855, 803, 800, 685, 629, 536,
      504, 511, 493, 438, 398, 377, 368, 355, 367, 258, 286, 226, 234, 193, 225,
      198, 215, 193, 146, 140, 86, 84, 53, 52, 28, 25, 17, 16, 10, 7, 3, 4
    ),
    year = rep(2025, 1212L),
    scen = rep(rep(c("reference", "high", "low"), 2), each = 202L),
    spatial_unit = rep("Aargau", 1212L),
    birthrate = rep(
      c(
        0, 0.000764, 0.001165, 0.00265, 0.005423, 0.009798, 0.016558, 0.025273,
        0.03643, 0.049419, 0.064995, 0.081562, 0.098485, 0.113969, 0.124791, 0.128426,
        0.123673, 0.110565, 0.092099, 0.071365, 0.051621, 0.035345, 0.023476,
        0.015111, 0.009548, 0.006091, 0.004036, 0.002701, 0.001833, 0.001298, 0.00126,
        0.000899, 0, 0.000762, 0.001939, 0.003403, 0.006961, 0.012135, 0.019677,
        0.030115, 0.042205, 0.05668, 0.07333, 0.091099, 0.108461, 0.124078, 0.134468,
        0.137327, 0.131369, 0.11707, 0.097052, 0.075007, 0.054175, 0.037048, 0.024316,
        0.015664, 0.009826, 0.006368, 0.004312, 0.002996, 0.002136, 0.001295,
        0.001258, 0.000897, 0, 0.000383, 0.000779, 0.001898, 0.003883, 0.007466,
        0.013041, 0.020408, 0.030303, 0.042105, 0.055909, 0.071915, 0.087977,
        0.103082, 0.113998, 0.118555, 0.115088, 0.103706, 0.086809, 0.06768, 0.04903,
        0.033659, 0.022321, 0.014271, 0.009279, 0.005813, 0.003755, 0.002708,
        0.001838, 0.001301, 0.000947, 9e-04, 0, 0.00113, 0.004698, 0.01012, 0.018029,
        0.027728, 0.038369, 0.050934, 0.065229, 0.080512, 0.09604, 0.110943, 0.124577,
        0.135363, 0.140837, 0.142564, 0.137699, 0.12893, 0.116623, 0.102113, 0.086141,
        0.070237, 0.056359, 0.043176, 0.032162, 0.023168, 0.016219, 0.011078, 0.00732,
        0.004812, 0.002914, 0.001693, 0.000611, 0.000646, 0, 0.002264, 0.005872,
        0.012602, 0.021429, 0.032067, 0.044444, 0.058146, 0.072265, 0.08946, 0.10522,
        0.121234, 0.133598, 0.145305, 0.150163, 0.150519, 0.145103, 0.135248,
        0.121639, 0.106181, 0.08947, 0.073195, 0.058488, 0.044927, 0.033506, 0.024066,
        0.01665, 0.011537, 0.007821, 0.004795, 0.002899, 0.001687, 0.000609, 0.000644,
        0, 0.001131, 0.003527, 0.0076, 0.014528, 0.02327, 0.033109, 0.044367,
        0.056738, 0.071868, 0.086919, 0.101787, 0.113312, 0.124834, 0.130675,
        0.132458, 0.128904, 0.121423, 0.109837, 0.096349, 0.081653, 0.067185,
        0.053199, 0.040908, 0.03083, 0.022245, 0.015752, 0.010609, 0.006819, 0.004293,
        0.002922, 0.001696, 0.000613, 0.000649, 0
      ),
      rep(
        c(120L, 1L, 171L, 1L, 171L, 1L, 169L, 1L, 169L, 1L, 169L, 1L, 51L),
        c(1L, 31L, 1L, 31L, 1L, 31L, 1L, 33L, 1L, 33L, 1L, 33L, 1L)
      )
    ),
    int_mothers = rep(
      c(0.25, 0.24984728161270617, 0.25, 0.24984728161270617, 0.25),
      c(202L, 202L, 404L, 202L, 202L)
    ),
    mor = c(
      0.003221, 0.000398, 0.000404, 0.000382, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.000359, 0.000351, 0.000368, 0.000359, 0.000361, 0.000362, 0.000367,
      0.000373, 0.00038, 0.000351, 0.000359, 0.000352, 0.000348, 0.000329, 0.000352,
      0.000347, 0.00032, 0.000616, 0.000617, 0.00061, 0.00061, 0.000609, 0.000616,
      0.000599, 0.000623, 0.000596, 0.000901, 0.000891, 9e-04, 0.000896, 0.001255,
      0.001273, 0.001275, 0.00168, 0.001639, 0.001856, 0.002136, 0.00235, 0.002514,
      0.002952, 0.003431, 0.003717, 0.00414, 0.004355, 0.004972, 0.005387, 0.005671,
      0.006214, 0.006686, 0.007339, 0.00786, 0.008484, 0.009449, 0.010174, 0.011006,
      0.011942, 0.013626, 0.014888, 0.016939, 0.019062, 0.021604, 0.024584, 0.02853,
      0.032998, 0.037814, 0.044324, 0.050839, 0.059132, 0.067762, 0.077748,
      0.088977, 0.10057, 0.112195, 0.125853, 0.136553, 0.146535, 0.161162, 0.177914,
      0.194332, 0.219251, 0.243697, 0.272727, 0.296296, 0.333333, 0.377778,
      0.002957, 0.000418, 0.000423, 4e-04, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0.000377, 0.000364, 0.000369, 0.000353, 0.000348,
      0.000344, 0.000336, 0.000335, 0.000308, 0.000308, 0.000298, 0.000308,
      0.000297, 3e-04, 0.000299, 0.00061, 0.000592, 0.000597, 0.00058, 0.000576,
      6e-04, 0.000916, 0.000973, 0.000945, 0.001198, 0.001244, 0.001242, 0.001529,
      0.001455, 0.001869, 0.002063, 0.002043, 0.002374, 0.002616, 0.002789,
      0.003036, 0.003415, 0.003732, 0.004113, 0.004459, 0.004847, 0.005361,
      0.005928, 0.0065, 0.007144, 0.007652, 0.008634, 0.009557, 0.010543, 0.01167,
      0.012996, 0.014904, 0.016825, 0.019137, 0.022112, 0.02517, 0.029124, 0.033737,
      0.039003, 0.04567, 0.053743, 0.063222, 0.074571, 0.087399, 0.101045, 0.117647,
      0.134415, 0.151862, 0.170632, 0.18986, 0.212598, 0.232715, 0.256293, 0.28,
      0.301887, 0.356923, 0.003342, 0.000372, 0.000402, 0.000381, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0.000358, 0.00035, 0.000366, 0.000358, 0.000361, 0.000362,
      0.000367, 0.000373, 0.000379, 0.00035, 0.000359, 0.000351, 0.000347, 0.000328,
      0.000351, 0.000346, 0.000319, 0.000307, 0.000616, 0.000609, 0.000609,
      0.000608, 0.000614, 0.000597, 0.000621, 0.000594, 0.000599, 0.000889,
      0.000898, 0.000894, 0.000939, 0.00127, 0.001273, 0.001341, 0.001635, 0.001852,
      0.002131, 0.002345, 0.00251, 0.00268, 0.003163, 0.003464, 0.003891, 0.00411,
      0.004496, 0.004914, 0.005418, 0.005963, 0.006426, 0.006789, 0.007298,
      0.007894, 0.008556, 0.009241, 0.01005, 0.011273, 0.012247, 0.01381, 0.015763,
      0.017895, 0.020376, 0.023767, 0.027256, 0.031692, 0.036841, 0.042794,
      0.049215, 0.056511, 0.064208, 0.072096, 0.08059, 0.08946, 0.098914, 0.107623,
      0.116298, 0.126091, 0.136422, 0.152239, 0.173228, 0.197917, 0.229508,
      0.255556, 0.296296, 0.333333, 0.4, 0.002724, 0.00039, 0.000421, 0.000399, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000376,
      0.000364, 0.000368, 0.000352, 0.000348, 0.000343, 0.000335, 0.000334,
      0.000307, 0.000307, 0.000297, 0.000307, 0.000296, 0.000299, 0.000299,
      0.000304, 0.000591, 0.000595, 0.000579, 0.000575, 0.000599, 0.00061, 0.000647,
      0.000943, 0.000897, 0.001242, 0.00124, 0.001222, 0.001454, 0.001601, 0.001804,
      0.002041, 0.002136, 0.002377, 0.002556, 0.002801, 0.003186, 0.003497, 0.00387,
      0.00421, 0.004588, 0.004823, 0.005384, 0.005953, 0.00657, 0.007059, 0.008009,
      0.008596, 0.009577, 0.010966, 0.012297, 0.013822, 0.015705, 0.017616, 0.02019,
      0.023121, 0.026982, 0.031075, 0.036444, 0.042766, 0.050415, 0.058923,
      0.069042, 0.081047, 0.095362, 0.109718, 0.125432, 0.142248, 0.159479,
      0.179296, 0.196636, 0.215232, 0.237136, 0.253247, 0.275229, 0.328358,
      0.003543, 0.000434, 0.000405, 0.000384, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.000346, 0.00036, 0.000353, 0.000368, 0.00036, 0.000362, 0.000363, 0.000368,
      0.000374, 0.000381, 0.000351, 0.00036, 0.000353, 0.000349, 0.000659, 0.000353,
      0.000347, 0.000641, 0.000617, 0.000618, 0.000611, 0.000611, 0.000611,
      0.000617, 6e-04, 0.000624, 0.000896, 0.000903, 0.000893, 0.000902, 0.001198,
      0.001258, 0.001275, 0.001599, 0.001682, 0.001971, 0.00217, 0.002447, 0.002648,
      0.002798, 0.003225, 0.003436, 0.003968, 0.004388, 0.004847, 0.005215,
      0.005621, 0.006168, 0.006716, 0.007206, 0.007887, 0.008704, 0.009369,
      0.010047, 0.011106, 0.011952, 0.013282, 0.014671, 0.016329, 0.018122,
      0.020619, 0.023638, 0.027006, 0.031069, 0.035653, 0.041147, 0.047854,
      0.055176, 0.063698, 0.073565, 0.084381, 0.096374, 0.108277, 0.121324,
      0.134044, 0.147651, 0.158, 0.170439, 0.188854, 0.212245, 0.237838, 0.262712,
      0.287356, 0.320755, 0.333333, 0.4, 0.003242, 0.000455, 0.000424, 0.000402, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000393, 0.000395,
      0.000378, 0.000365, 0.000369, 0.000354, 0.000349, 0.000345, 0.000337,
      0.000335, 0.000309, 0.000308, 0.000299, 0.000309, 0.000298, 0.000301,
      0.000601, 0.000611, 0.000594, 0.000598, 0.000581, 0.000578, 0.000902,
      0.000919, 0.000975, 0.000946, 0.001199, 0.001246, 0.001244, 0.001531,
      0.001748, 0.00187, 0.002066, 0.002301, 0.002613, 0.002855, 0.003024, 0.003271,
      0.003645, 0.003967, 0.004357, 0.004957, 0.005355, 0.0059, 0.006468, 0.00705,
      0.007726, 0.008543, 0.009256, 0.010525, 0.011518, 0.012713, 0.014374,
      0.016341, 0.018312, 0.021049, 0.024055, 0.027611, 0.03168, 0.036868, 0.042574,
      0.049721, 0.058465, 0.068236, 0.08015, 0.093697, 0.109361, 0.125793, 0.143524,
      0.163295, 0.18408, 0.205689, 0.229333, 0.253859, 0.27972, 0.29932, 0.330097,
      0.383387, 0.003397, 0.000851, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.001009, 0.000945, 0.001046, 0.00092, 0.000903, 0.000964, 0.000991, 0.000933,
      0.000894, 0.000766, 0.000719, 0.00065, 0.000594, 0.000556, 0.000551, 0.000516,
      0.000486, 0.000474, 0.000451, 0.000427, 0.000436, 0.000442, 0.000421,
      0.000431, 0.000432, 0.000846, 0.000886, 0.000877, 0.000888, 0.000914,
      0.000954, 0.000973, 0.001034, 0.001593, 0.001679, 0.001734, 0.001779,
      0.001777, 0.001891, 0.001956, 0.00258, 0.002662, 0.00335, 0.003423, 0.004135,
      0.004389, 0.004864, 0.00551, 0.007243, 0.007531, 0.008136, 0.009957, 0.011542,
      0.012163, 0.014532, 0.014553, 0.016787, 0.017926, 0.020833, 0.021176,
      0.023188, 0.025281, 0.026446, 0.030151, 0.030238, 0.033645, 0.035714,
      0.042065, 0.045226, 0.053812, 0.062992, 0.07767, 0.092166, 0.107623, 0.145455,
      0.18, 0.212121, 0.266667, 0.230769, 0.375, 0.363636, 0.4, 0.5, 0, 0, 0.002659,
      0.000881, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0.000842, 0.000754, 0.000677, 0.000647, 0.000602, 0.000587, 0.00056,
      0.000528, 0.000528, 0.000503, 0.000507, 0.000498, 0.000499, 0.000496,
      0.000495, 0.000504, 0.000507, 0.000503, 0.000523, 0.000534, 0.000583,
      0.000564, 0.000611, 0.001292, 0.001276, 0.001345, 0.00143, 0.001352, 0.001437,
      0.001559, 0.002318, 0.002486, 0.002503, 0.00261, 0.002876, 0.003788, 0.003176,
      0.003557, 0.00507, 0.00506, 0.005887, 0.006385, 0.005629, 0.005946, 0.007866,
      0.008155, 0.009153, 0.010088, 0.010596, 0.013569, 0.014144, 0.016327,
      0.019305, 0.021016, 0.022272, 0.025696, 0.030848, 0.035477, 0.0399, 0.051044,
      0.05641, 0.068027, 0.078853, 0.093023, 0.107143, 0.132075, 0.153846, 0.175439,
      0.170213, 0.235294, 0.235294, 0.3, 0.285714, 0.333333, 0.25, 0.003146,
      0.000805, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000943, 0, 0.000915,
      0.000891, 0.000948, 0.000968, 0.000911, 0.000867, 0.000745, 0.000699,
      0.000633, 0.00058, 0.000544, 0.000539, 0.000506, 0.000478, 0.000466, 0.000445,
      0.000422, 0.000431, 0.000437, 0.000418, 0.000428, 0.000429, 0.000421,
      0.000881, 0.000872, 0.000886, 0.000909, 0.00095, 0.000969, 0.00103, 0.001058,
      0.001115, 0.001728, 0.00177, 0.001772, 0.001884, 0.001951, 0.002576, 0.002666,
      0.003359, 0.003427, 0.004148, 0.004405, 0.004886, 0.00554, 0.00625, 0.007634,
      0.008253, 0.008627, 0.009909, 0.010417, 0.012739, 0.014568, 0.014388,
      0.017903, 0.018182, 0.021102, 0.023155, 0.025316, 0.02649, 0.026846, 0.030172,
      0.03352, 0.04008, 0.042389, 0.045226, 0.054054, 0.062992, 0.071197, 0.082949,
      0.098655, 0.11976, 0.156863, 0.171429, 0.1875, 0.214286, 0.25, 0.25, 0.4, 0.5,
      0, 0, 0.00246, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0.000815, 0.000734, 0.000661, 0.000634, 0.000591, 0.000577,
      0.000552, 0.000522, 0.000522, 0.000498, 0.000503, 0.000494, 0.000496,
      0.000494, 0.000493, 0.000501, 0.000504, 0.000502, 0.000521, 0.000533, 0.00058,
      0.000562, 0.000609, 0.000644, 0.001272, 0.001341, 0.001426, 0.001349,
      0.001434, 0.001555, 0.002313, 0.002481, 0.002512, 0.002616, 0.002886,
      0.002852, 0.003198, 0.003574, 0.003827, 0.005086, 0.004435, 0.0048, 0.00565,
      0.005964, 0.007866, 0.008155, 0.009153, 0.010063, 0.01061, 0.010811, 0.014045,
      0.01355, 0.015444, 0.017422, 0.022124, 0.025478, 0.025907, 0.031042, 0.040201,
      0.046296, 0.051546, 0.06734, 0.077739, 0.08046, 0.105882, 0.12963, 0.132075,
      0.172414, 0.163265, 0.176471, 0.235294, 0.2, 0.25, 0.333333, 0.25, 0.003709,
      0.000918, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.001012, 0.000946,
      0.001052, 0.000927, 0.000914, 0.000983, 0.001014, 0.00096, 0.00092, 0.000787,
      0.000739, 0.000666, 0.000608, 0.000569, 0.000564, 0.000526, 0.000495,
      0.000482, 0.000457, 0.000432, 0.000441, 0.000446, 0.000425, 0.000434, 0.00087,
      0.000851, 0.000891, 0.000881, 0.000893, 0.000917, 0.000958, 0.001465,
      0.001558, 0.001603, 0.001685, 0.001741, 0.001784, 0.001783, 0.002528,
      0.002613, 0.002583, 0.003328, 0.003348, 0.004096, 0.004124, 0.005106,
      0.005663, 0.006407, 0.007194, 0.008515, 0.009333, 0.011307, 0.011523,
      0.013841, 0.016319, 0.016598, 0.019162, 0.020434, 0.023377, 0.023529,
      0.026012, 0.02809, 0.029752, 0.033501, 0.034409, 0.037313, 0.039761, 0.045714,
      0.050251, 0.058559, 0.068602, 0.084142, 0.093023, 0.117647, 0.157576,
      0.183673, 0.242424, 0.266667, 0.307692, 0.375, 0.363636, 0.4, 0.5, 0, 0,
      0.002909, 0.00095, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0.000869, 0.000777, 0.000695, 0.000664, 0.000613, 0.000596,
      0.000568, 0.000535, 0.000533, 0.000507, 0.00051, 0.000501, 0.000502, 0.000499,
      0.000497, 0.000505, 0.000508, 0.000505, 0.000524, 0.000536, 0.000584,
      0.000565, 0.001226, 0.001297, 0.00128, 0.00135, 0.001437, 0.001357, 0.002165,
      0.002347, 0.00232, 0.002486, 0.002504, 0.003474, 0.003824, 0.003768, 0.004217,
      0.004725, 0.005047, 0.005038, 0.005865, 0.006385, 0.007477, 0.007944,
      0.007843, 0.008138, 0.009164, 0.010076, 0.01328, 0.013605, 0.014104, 0.016371,
      0.01938, 0.020979, 0.026549, 0.029915, 0.031088, 0.040089, 0.045455, 0.051163,
      0.062176, 0.075085, 0.085714, 0.104651, 0.119048, 0.132075, 0.153846,
      0.178571, 0.2, 0.235294, 0.25, 0.3, 0.285714, 0.333333, 0.25
    ),
    emi_int = c(
      0.001624, 0.004434, 0.004486, 0.004239, 0.004089, 0.003566, 0.003537,
      0.003198, 0.002841, 0.002899, 0.00244, 0.002068, 0.001786, 0.001778, 0.001405,
      0.001393, 0.00145, 0.002125, 0.002588, 0.003236, 0.003975, 0.004703, 0.00514,
      0.005218, 0.005309, 0.005946, 0.006087, 0.005963, 0.005903, 0.005588, 0.0053,
      0.004887, 0.004825, 0.004651, 0.004359, 0.00431, 0.004, 0.003995, 0.003727,
      0.00362, 0.003453, 0.003302, 0.003023, 0.00299, 0.00302, 0.003006, 0.00284,
      0.002561, 0.002565, 0.002703, 0.002636, 0.002797, 0.002758, 0.003243,
      0.003362, 0.003497, 0.003703, 0.004218, 0.004632, 0.004844, 0.004502,
      0.004453, 0.004441, 0.003731, 0.0036, 0.005693, 0.004492, 0.003219, 0.003248,
      0.003082, 0.002828, 0.002321, 0.002043, 0.001772, 0.00154, 0.001524, 0.0012,
      0.001189, 0.000827, 0.000857, 0.000922, 0.000985, 0.000524, 0.000616,
      0.000684, 0.000894, 0.000988, 0.001036, 0.00122, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0.002559, 0.004639, 0.004693, 0.004441, 0.004399, 0.00428, 0.003451,
      0.003413, 0.002966, 0.002605, 0.002622, 0.002281, 0.001914, 0.001859,
      0.001516, 0.001424, 0.001522, 0.001832, 0.002312, 0.003075, 0.003514,
      0.004552, 0.005035, 0.00509, 0.00551, 0.005652, 0.005451, 0.005525, 0.005293,
      0.005236, 0.004834, 0.004728, 0.004382, 0.004034, 0.004035, 0.003911,
      0.003424, 0.003003, 0.003029, 0.003024, 0.002769, 0.002688, 0.002705,
      0.002627, 0.002608, 0.002414, 0.002762, 0.002608, 0.002845, 0.002704,
      0.002809, 0.003116, 0.003067, 0.003503, 0.003478, 0.003615, 0.00358, 0.003564,
      0.003332, 0.003256, 0.003271, 0.003189, 0.003033, 0.002905, 0.003218, 0.00255,
      0.002145, 0.001617, 0.001354, 0.000857, 0.000883, 0.000925, 0.000637,
      0.000639, 0.000686, 0.000684, 0.000709, 0.000366, 0.000375, 0.000381, 4e-04,
      0.000416, 0.000433, 0.000494, 0.000557, 0.00064, 0.00068, 0, 0.000849, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.002246, 0.005281, 0.004878, 0.005002, 0.00442,
      0.004272, 0.003886, 0.003903, 0.003544, 0.003255, 0.002785, 0.002408,
      0.002139, 0.002129, 0.001753, 0.001737, 0.001809, 0.002473, 0.00295, 0.003945,
      0.004693, 0.005423, 0.005869, 0.006704, 0.006442, 0.006986, 0.006793,
      0.006657, 0.00659, 0.006568, 0.005999, 0.005923, 0.005463, 0.005265, 0.004975,
      0.004917, 0.00461, 0.004603, 0.00434, 0.003914, 0.004075, 0.003895, 0.00362,
      0.003582, 0.003316, 0.003301, 0.00315, 0.003194, 0.003202, 0.003035, 0.003289,
      0.003104, 0.003365, 0.003533, 0.003918, 0.004031, 0.004493, 0.004958,
      0.005358, 0.005568, 0.005211, 0.005152, 0.00493, 0.004724, 0.00437, 0.006501,
      0.005613, 0.003802, 0.003835, 0.003388, 0.003139, 0.002652, 0.002381,
      0.002124, 0.001922, 0.001523, 0.001199, 0.001188, 0.001239, 0.000857,
      0.000921, 0.000984, 0.001047, 0.000614, 0.000683, 0.00089, 0.000982, 0.001028,
      0.001206, 0.001495, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.003145, 0.005523,
      0.00553, 0.005233, 0.005123, 0.00466, 0.003828, 0.003789, 0.003332, 0.002972,
      0.002992, 0.002656, 0.002292, 0.001855, 0.001892, 0.001776, 0.001897,
      0.002193, 0.00269, 0.003452, 0.0039, 0.00493, 0.005803, 0.005869, 0.006289,
      0.006396, 0.006173, 0.006255, 0.005992, 0.005923, 0.005513, 0.005394,
      0.005045, 0.004647, 0.00465, 0.004203, 0.004039, 0.003896, 0.003931, 0.003622,
      0.003684, 0.003578, 0.003601, 0.003498, 0.002892, 0.003014, 0.003067,
      0.002931, 0.003158, 0.003301, 0.003429, 0.003425, 0.003984, 0.004084,
      0.004011, 0.00413, 0.004088, 0.004038, 0.004044, 0.003953, 0.003737, 0.003643,
      0.003499, 0.003388, 0.003712, 0.002803, 0.002412, 0.001885, 0.001353,
      0.001143, 0.000882, 0.000924, 0.000955, 0.000638, 0.000685, 0.000683,
      0.000709, 0.00073, 0.000375, 0.000381, 0.000399, 0.000415, 0.000432, 0.000493,
      0.000556, 0.000639, 0.000678, 0.000743, 0.000845, 0.000867, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0.001339, 0.003949, 0.003676, 0.003478, 0.003413, 0.003215,
      0.002836, 0.002849, 0.002489, 0.002179, 0.002095, 0.001727, 0.001432,
      0.001427, 0.001407, 0.001047, 0.001453, 0.001776, 0.002222, 0.002882,
      0.003255, 0.003622, 0.004043, 0.004479, 0.004559, 0.004902, 0.00502, 0.004919,
      0.00487, 0.00461, 0.004245, 0.004191, 0.003866, 0.003726, 0.003741, 0.00339,
      0.00339, 0.003079, 0.00311, 0.003021, 0.00283, 0.002705, 0.002726, 0.002397,
      0.002419, 0.002408, 0.002213, 0.002243, 0.002249, 0.002367, 0.00231, 0.002489,
      0.002455, 0.002656, 0.002805, 0.002963, 0.003177, 0.003228, 0.003903,
      0.004122, 0.003795, 0.00375, 0.003703, 0.003235, 0.003088, 0.004882, 0.003651,
      0.002928, 0.002659, 0.002467, 0.002201, 0.001991, 0.001705, 0.001419,
      0.001541, 0.001145, 0.001201, 0.000794, 0.000828, 0.000859, 0.000462,
      0.000493, 0.000525, 0.000618, 0.000687, 0.000898, 0.000993, 0.001041,
      0.001225, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.002342, 0.003675, 0.003422,
      0.004045, 0.003671, 0.003118, 0.003071, 0.00266, 0.002598, 0.002236, 0.001875,
      0.001904, 0.001533, 0.00149, 0.00114, 0.00107, 0.001144, 0.001469, 0.001931,
      0.00231, 0.002739, 0.003801, 0.004269, 0.004314, 0.00473, 0.004525, 0.004731,
      0.004425, 0.004594, 0.004193, 0.004149, 0.00372, 0.003711, 0.003418, 0.003421,
      0.003315, 0.003118, 0.003008, 0.002427, 0.002425, 0.002467, 0.002395,
      0.002109, 0.002046, 0.002322, 0.002116, 0.002153, 0.002286, 0.002216,
      0.002405, 0.002499, 0.002495, 0.00307, 0.002921, 0.002944, 0.003102, 0.003071,
      0.002852, 0.002856, 0.002792, 0.002805, 0.002735, 0.002568, 0.002422,
      0.002724, 0.002039, 0.001609, 0.001347, 0.001084, 0.000858, 0.000883,
      0.000617, 0.000638, 0.00064, 0.000343, 0.000342, 0.000355, 0.000366, 0.000376,
      0.000382, 4e-04, 0.000417, 0.000434, 0.000495, 0.000559, 0.000643, 0.000683,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00515, 0.036658, 0.031187,
      0.026619, 0.022318, 0.019147, 0.017094, 0.015013, 0.012069, 0.011309,
      0.009692, 0.009386, 0.008029, 0.006926, 0.006346, 0.005988, 0.006036,
      0.006591, 0.009454, 0.013966, 0.019284, 0.023762, 0.029774, 0.033042,
      0.035547, 0.03748, 0.037481, 0.036437, 0.036263, 0.035591, 0.034208, 0.032944,
      0.031904, 0.031068, 0.029899, 0.029501, 0.028331, 0.027828, 0.027211,
      0.026533, 0.025708, 0.025499, 0.024488, 0.023747, 0.023132, 0.022426,
      0.021968, 0.021411, 0.020704, 0.020191, 0.019608, 0.019086, 0.018969,
      0.018935, 0.019521, 0.020169, 0.021837, 0.02381, 0.025896, 0.025119, 0.027929,
      0.021045, 0.025662, 0.031703, 0.043611, 0.07076, 0.054233, 0.022567, 0.014754,
      0.013841, 0.012635, 0.010352, 0.011933, 0.010204, 0.010363, 0.009368,
      0.008671, 0.008403, 0.006601, 0.006689, 0.008584, 0.007435, 0.003953,
      0.003817, 0.005025, 0.004484, 0.005236, 0.006452, 0.009174, 0.008929,
      0.012048, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.002705, 0.028394, 0.026342,
      0.024145, 0.02336, 0.020779, 0.018987, 0.016529, 0.014124, 0.012324, 0.012138,
      0.011916, 0.010742, 0.010669, 0.010799, 0.010978, 0.010707, 0.011161,
      0.012776, 0.013889, 0.014528, 0.01603, 0.01868, 0.022539, 0.023307, 0.025937,
      0.026502, 0.025217, 0.025316, 0.025486, 0.025403, 0.025256, 0.024571,
      0.023618, 0.021937, 0.020833, 0.019427, 0.018565, 0.01706, 0.015944, 0.014888,
      0.014134, 0.013692, 0.013085, 0.012546, 0.011752, 0.011655, 0.011274,
      0.011009, 0.010349, 0.010217, 0.010094, 0.010029, 0.010142, 0.010784, 0.01248,
      0.015408, 0.019786, 0.023179, 0.02584, 0.029384, 0.029026, 0.029319, 0.029308,
      0.037453, 0.023839, 0.020498, 0.015898, 0.013109, 0.011881, 0.011765,
      0.010163, 0.009132, 0.010076, 0.010582, 0.01084, 0.011299, 0.01087, 0.011583,
      0.013986, 0.013333, 0.012821, 0.010309, 0.013274, 0.01, 0.009302, 0.010256,
      0.013605, 0.014286, 0.011628, 0.011905, 0.018868, 0.019231, 0.034483,
      0.041667, 0, 0, 0, 0, 0, 0, 0.006359, 0.042673, 0.036108, 0.030115, 0.025641,
      0.021683, 0.019558, 0.016584, 0.013734, 0.012872, 0.010517, 0.010204,
      0.009786, 0.008621, 0.008145, 0.006965, 0.007028, 0.007526, 0.010493,
      0.015799, 0.021858, 0.028404, 0.033367, 0.038241, 0.041209, 0.04307, 0.043382,
      0.04244, 0.042347, 0.040701, 0.039821, 0.037756, 0.036946, 0.035526, 0.034624,
      0.034438, 0.032938, 0.03164, 0.031316, 0.031155, 0.030356, 0.029237, 0.02795,
      0.027607, 0.027531, 0.026448, 0.025238, 0.024757, 0.023736, 0.023317,
      0.022905, 0.022504, 0.021855, 0.021855, 0.021985, 0.023377, 0.025016,
      0.028458, 0.02994, 0.029192, 0.032082, 0.024017, 0.029767, 0.037273, 0.051882,
      0.082809, 0.062834, 0.027027, 0.01642, 0.015544, 0.014467, 0.012422, 0.011933,
      0.012723, 0.01292, 0.009346, 0.011527, 0.011204, 0.009901, 0.010033, 0.008584,
      0.007407, 0.007968, 0.007663, 0.005025, 0.004505, 0.005236, 0.006452,
      0.009174, 0.008929, 0.011905, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.004174,
      0.033501, 0.030242, 0.029058, 0.02681, 0.025043, 0.021602, 0.019196, 0.01687,
      0.014912, 0.012999, 0.012785, 0.012646, 0.01256, 0.011841, 0.012974, 0.012834,
      0.013408, 0.013953, 0.015132, 0.016867, 0.019536, 0.022059, 0.024419, 0.0282,
      0.029135, 0.030225, 0.029389, 0.029026, 0.029742, 0.029358, 0.029115,
      0.028297, 0.027157, 0.025478, 0.023737, 0.022877, 0.020969, 0.019481,
      0.018868, 0.017318, 0.016097, 0.015167, 0.014558, 0.014606, 0.013859,
      0.013357, 0.012936, 0.012813, 0.012912, 0.012094, 0.012097, 0.012152,
      0.012146, 0.012922, 0.014786, 0.017692, 0.022222, 0.027386, 0.031034, 0.03327,
      0.033771, 0.033684, 0.034118, 0.04386, 0.026448, 0.023495, 0.019108, 0.016886,
      0.013889, 0.013725, 0.012195, 0.011416, 0.01005, 0.01061, 0.010811, 0.011236,
      0.01084, 0.015444, 0.013937, 0.013274, 0.012712, 0.015544, 0.013274, 0.015075,
      0.013889, 0.015464, 0.013514, 0.014085, 0.011494, 0.011765, 0.018519,
      0.018868, 0.034483, 0.04, 0, 0, 0, 0, 0, 0, 0.002817, 0.030331, 0.025407,
      0.022302, 0.018949, 0.015734, 0.01458, 0.011706, 0.011275, 0.009732, 0.007965,
      0.007699, 0.006267, 0.006071, 0.00546, 0.005005, 0.00504, 0.005655, 0.007376,
      0.01215, 0.015726, 0.021042, 0.023958, 0.027723, 0.030476, 0.031682, 0.032061,
      0.030864, 0.030606, 0.029738, 0.028935, 0.027478, 0.026754, 0.026031,
      0.025081, 0.024497, 0.02365, 0.023046, 0.023107, 0.022319, 0.021463, 0.021358,
      0.020563, 0.019859, 0.019652, 0.019266, 0.018669, 0.018058, 0.017134,
      0.017085, 0.016844, 0.016251, 0.016033, 0.016014, 0.015773, 0.016938,
      0.018638, 0.020503, 0.021262, 0.021003, 0.023129, 0.017379, 0.021635,
      0.027125, 0.037374, 0.059979, 0.044444, 0.019608, 0.011475, 0.010345, 0.01083,
      0.008264, 0.009547, 0.010178, 0.010336, 0.009368, 0.008646, 0.008403,
      0.006601, 0.006689, 0.004292, 0.003717, 0.003968, 0.003802, 0.005025,
      0.004505, 0.005263, 0.006452, 0.009259, 0.009009, 0.012048, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0.000986, 0.023878, 0.021494, 0.021255, 0.018936, 0.018245,
      0.015441, 0.013838, 0.012299, 0.011484, 0.010309, 0.0092, 0.008832, 0.008746,
      0.008658, 0.008991, 0.009636, 0.010045, 0.010465, 0.011364, 0.012151,
      0.014907, 0.015132, 0.01816, 0.020478, 0.020649, 0.021661, 0.020917, 0.021459,
      0.02116, 0.02133, 0.021302, 0.020785, 0.019502, 0.018858, 0.017374, 0.016444,
      0.015121, 0.01461, 0.013507, 0.012444, 0.01164, 0.011173, 0.010595, 0.010477,
      0.010177, 0.009924, 0.009034, 0.009191, 0.008431, 0.008317, 0.008097,
      0.008627, 0.008136, 0.00938, 0.010164, 0.013107, 0.015677, 0.019884, 0.023236,
      0.025544, 0.024254, 0.024033, 0.024561, 0.032379, 0.02, 0.017518, 0.014308,
      0.011194, 0.009921, 0.009785, 0.008114, 0.009132, 0.01005, 0.01061, 0.01087,
      0.011268, 0.010899, 0.011628, 0.01049, 0.00885, 0.008547, 0.010363, 0.008889,
      0.010101, 0.009302, 0.010363, 0.006849, 0.007143, 0.011628, 0.011905,
      0.018868, 0.019231, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    emi_nat = c(
      0.008932, 0.020556, 0.022023, 0.018882, 0.016014, 0.013909, 0.012027,
      0.010306, 0.008878, 0.007609, 0.006971, 0.00586, 0.005359, 0.004623, 0.004215,
      0.00383, 0.003987, 0.005313, 0.008503, 0.012945, 0.01807, 0.02424, 0.030837,
      0.03839, 0.045506, 0.051766, 0.056212, 0.057874, 0.057292, 0.054898, 0.051237,
      0.046771, 0.042457, 0.03814, 0.033935, 0.03048, 0.027385, 0.024585, 0.02236,
      0.020513, 0.018832, 0.017712, 0.016626, 0.01555, 0.014799, 0.013826, 0.013253,
      0.012804, 0.012183, 0.011486, 0.011203, 0.010876, 0.01042, 0.010024, 0.009526,
      0.009416, 0.008992, 0.008685, 0.008532, 0.008234, 0.00782, 0.007734, 0.007402,
      0.007214, 0.009, 0.012741, 0.006457, 0.006438, 0.0062, 0.005855, 0.005657,
      0.005637, 0.005448, 0.005315, 0.005004, 0.004954, 0.0048, 0.004756, 0.004547,
      0.004713, 0.00461, 0.004431, 0.004193, 0.00431, 0.004107, 0.003575, 0.003953,
      0.004145, 0.003659, 0.003035, 0.003333, 0.00396, 0.002646, 0.003067, 0.004049,
      0.005348, 0, 0, 0, 0, 0, 0.009808, 0.027836, 0.023038, 0.018975, 0.015762,
      0.01323, 0.01112, 0.00948, 0.008157, 0.007071, 0.006367, 0.005701, 0.005358,
      0.005204, 0.005307, 0.00534, 0.006469, 0.008428, 0.012331, 0.018832, 0.027724,
      0.039074, 0.050736, 0.061472, 0.070051, 0.074981, 0.075945, 0.074033,
      0.069866, 0.063874, 0.056975, 0.049983, 0.043141, 0.037232, 0.031968,
      0.027377, 0.023965, 0.021021, 0.018782, 0.016934, 0.015385, 0.014337,
      0.013526, 0.012843, 0.01217, 0.011768, 0.011357, 0.011086, 0.011062, 0.010814,
      0.010612, 0.010284, 0.010123, 0.009924, 0.009631, 0.009553, 0.009205,
      0.009028, 0.008805, 0.008605, 0.008411, 0.0082, 0.008166, 0.007746, 0.009653,
      0.008924, 0.007239, 0.007006, 0.006768, 0.006571, 0.006178, 0.006165,
      0.005734, 0.005749, 0.005489, 0.005128, 0.004966, 0.004755, 0.004503,
      0.004194, 0.003995, 0.00416, 0.003893, 0.003457, 0.003343, 0.003201, 0.003399,
      0.002985, 0.002547, 0.002616, 0.002103, 0.00232, 0.001435, 0.001642, 0.00216,
      0.002625, 0, 0, 0, 0, 0, 0.008982, 0.020747, 0.021951, 0.018853, 0.015981,
      0.013884, 0.01201, 0.010291, 0.008859, 0.007595, 0.006961, 0.005848, 0.005348,
      0.004613, 0.004206, 0.003822, 0.00398, 0.0053, 0.008481, 0.012912, 0.018051,
      0.024223, 0.030814, 0.038361, 0.045472, 0.052043, 0.056132, 0.057814,
      0.057579, 0.054844, 0.051164, 0.047038, 0.042416, 0.038092, 0.033893,
      0.030424, 0.027351, 0.024547, 0.022319, 0.020476, 0.019122, 0.017675,
      0.016591, 0.015522, 0.014772, 0.013806, 0.013228, 0.012775, 0.012168,
      0.011804, 0.011184, 0.010863, 0.010401, 0.010009, 0.009796, 0.009406,
      0.008985, 0.008676, 0.008524, 0.00823, 0.007816, 0.007728, 0.007395, 0.00721,
      0.008997, 0.01273, 0.006455, 0.006435, 0.006195, 0.005852, 0.00565, 0.005635,
      0.005442, 0.00531, 0.004998, 0.004949, 0.004794, 0.004752, 0.004542, 0.004711,
      0.004604, 0.004427, 0.004188, 0.0043, 0.004098, 0.003562, 0.003929, 0.004111,
      0.003619, 0.00299, 0.003279, 0.003883, 0.002577, 0.002985, 0.003937, 0.005208,
      0, 0, 0, 0, 0, 0.009434, 0.028008, 0.022969, 0.019324, 0.015734, 0.013204,
      0.011103, 0.009473, 0.008145, 0.007058, 0.006358, 0.00569, 0.005348, 0.005193,
      0.005297, 0.005682, 0.006449, 0.008406, 0.012298, 0.018796, 0.027691, 0.03906,
      0.050677, 0.061815, 0.069969, 0.074868, 0.076253, 0.074319, 0.069792,
      0.063763, 0.056857, 0.049899, 0.043054, 0.037175, 0.031928, 0.027619, 0.02392,
      0.020977, 0.018748, 0.016903, 0.015352, 0.014311, 0.013505, 0.012824,
      0.012146, 0.011754, 0.011346, 0.011071, 0.011051, 0.010804, 0.010599,
      0.010274, 0.010113, 0.009918, 0.009626, 0.009551, 0.009198, 0.009026,
      0.008801, 0.008603, 0.008409, 0.008197, 0.008164, 0.007744, 0.009651,
      0.008917, 0.007237, 0.007001, 0.006764, 0.00657, 0.006176, 0.00616, 0.005731,
      0.005745, 0.005481, 0.005123, 0.004961, 0.004748, 0.004498, 0.004571,
      0.003987, 0.004151, 0.003884, 0.003448, 0.003333, 0.003193, 0.003388,
      0.002972, 0.002534, 0.002602, 0.002092, 0.002304, 0.001425, 0.001629,
      0.002137, 0.002591, 0, 0, 0, 0, 0, 0.008925, 0.020623, 0.02165, 0.018547,
      0.016041, 0.013934, 0.011698, 0.010328, 0.00889, 0.007625, 0.006983, 0.005872,
      0.005371, 0.004636, 0.004222, 0.003838, 0.003997, 0.005329, 0.008519,
      0.012968, 0.018083, 0.024267, 0.030871, 0.038447, 0.045593, 0.051821,
      0.056293, 0.057976, 0.057391, 0.054988, 0.051291, 0.046804, 0.042526,
      0.037876, 0.033978, 0.030508, 0.027427, 0.024631, 0.022395, 0.020544,
      0.018868, 0.017734, 0.016359, 0.015578, 0.014817, 0.013847, 0.013279,
      0.012816, 0.012207, 0.011498, 0.011221, 0.01089, 0.010436, 0.010035, 0.009537,
      0.009426, 0.009002, 0.008691, 0.008539, 0.008244, 0.007827, 0.007734,
      0.007406, 0.007218, 0.009007, 0.012747, 0.006459, 0.006442, 0.006204,
      0.005859, 0.005659, 0.005642, 0.005455, 0.005321, 0.00501, 0.004962, 0.004806,
      0.004764, 0.004555, 0.004723, 0.004621, 0.00444, 0.004202, 0.004326, 0.004124,
      0.003591, 0.003972, 0.004162, 0.003676, 0.003049, 0.003356, 0.004, 0.002667,
      0.003096, 0.004082, 0.005405, 0, 0, 0, 0, 0, 0.009836, 0.02802, 0.023097,
      0.019013, 0.015786, 0.01325, 0.011132, 0.009498, 0.008166, 0.007082, 0.006377,
      0.005712, 0.005366, 0.005214, 0.005321, 0.005351, 0.006484, 0.008447, 0.01236,
      0.018868, 0.027778, 0.039149, 0.050834, 0.061569, 0.069767, 0.074661,
      0.076055, 0.074115, 0.069611, 0.063592, 0.056708, 0.049713, 0.043185, 0.03729,
      0.032037, 0.027426, 0.02401, 0.021053, 0.018507, 0.016672, 0.015418, 0.014371,
      0.013558, 0.012862, 0.012188, 0.01179, 0.011378, 0.011104, 0.010763, 0.010824,
      0.010622, 0.010293, 0.010132, 0.00993, 0.009636, 0.009563, 0.009214, 0.009033,
      0.008807, 0.008609, 0.008415, 0.008204, 0.007937, 0.00775, 0.009658, 0.008922,
      0.007242, 0.007006, 0.006775, 0.006579, 0.006184, 0.006169, 0.00574, 0.005756,
      0.005495, 0.005132, 0.004972, 0.00476, 0.00451, 0.0042, 0.004002, 0.004167,
      0.003903, 0.003465, 0.003352, 0.003213, 0.00273, 0.002999, 0.002558, 0.002627,
      0.002116, 0.002336, 0.001447, 0.001658, 0.002188, 0.002667, 0, 0, 0, 0, 0,
      0.006009, 0.02387, 0.022133, 0.019521, 0.017167, 0.015666, 0.013675, 0.01251,
      0.011207, 0.009693, 0.008811, 0.007679, 0.007136, 0.006061, 0.00544, 0.00499,
      0.00503, 0.006591, 0.010504, 0.01676, 0.025712, 0.034653, 0.044148, 0.052478,
      0.058934, 0.062998, 0.064468, 0.064777, 0.063921, 0.062572, 0.059863,
      0.056854, 0.053838, 0.050971, 0.047838, 0.045119, 0.042054, 0.039946, 0.03784,
      0.035668, 0.033987, 0.032724, 0.031612, 0.030783, 0.029804, 0.029291,
      0.028176, 0.027737, 0.026915, 0.026036, 0.02521, 0.02487, 0.023711, 0.022485,
      0.021411, 0.020169, 0.019268, 0.018519, 0.017264, 0.015614, 0.014986,
      0.013788, 0.012831, 0.011775, 0.011156, 0.010406, 0.010582, 0.008463,
      0.008197, 0.00692, 0.00722, 0.006211, 0.004773, 0.005102, 0.005181, 0.004684,
      0.00289, 0.002801, 0.0033, 0.003344, 0.004292, 0.003717, 0.003953, 0.003817,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.004509, 0.023957,
      0.021277, 0.019115, 0.017071, 0.015584, 0.013562, 0.011938, 0.011299,
      0.009683, 0.009337, 0.008249, 0.007813, 0.00679, 0.006479, 0.005988, 0.005353,
      0.007813, 0.013937, 0.025253, 0.038741, 0.050555, 0.061021, 0.066429,
      0.067703, 0.067243, 0.065371, 0.061466, 0.056962, 0.052985, 0.048947,
      0.044498, 0.040571, 0.037037, 0.033708, 0.030996, 0.02863, 0.026091, 0.024084,
      0.022422, 0.02134, 0.020192, 0.01927, 0.018621, 0.017773, 0.017628, 0.017483,
      0.016911, 0.017125, 0.016818, 0.016603, 0.016824, 0.016476, 0.016227,
      0.015816, 0.015601, 0.015408, 0.014839, 0.014073, 0.01292, 0.012322, 0.011236,
      0.009424, 0.008206, 0.007491, 0.006274, 0.004392, 0.004769, 0.003745, 0.00396,
      0.003922, 0.004065, 0.004566, 0.005038, 0.002646, 0.00271, 0.002825, 0.002717,
      0.003861, 0.003497, 0.004444, 0.004274, 0, 0.004425, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0.006359, 0.024155, 0.022066, 0.019486, 0.017949,
      0.015611, 0.014456, 0.012438, 0.011159, 0.009654, 0.008764, 0.007653,
      0.007117, 0.006034, 0.00543, 0.004975, 0.00502, 0.006585, 0.010493, 0.016729,
      0.025501, 0.03526, 0.044489, 0.052581, 0.058608, 0.062647, 0.064706, 0.064987,
      0.064126, 0.062182, 0.060011, 0.057158, 0.054187, 0.050888, 0.047836, 0.04477,
      0.042161, 0.039661, 0.037664, 0.035915, 0.034258, 0.032627, 0.0315, 0.030675,
      0.029751, 0.029184, 0.028571, 0.02767, 0.026832, 0.026497, 0.025698, 0.024812,
      0.023627, 0.022445, 0.021357, 0.020779, 0.019243, 0.018531, 0.017299,
      0.015614, 0.015017, 0.013828, 0.012872, 0.011818, 0.01119, 0.010482, 0.010695,
      0.008535, 0.00821, 0.006908, 0.007233, 0.006211, 0.004773, 0.005089, 0.005168,
      0.004673, 0.002882, 0.002801, 0.0033, 0.003344, 0.004292, 0.003704, 0.003984,
      0.003831, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.004174,
      0.024288, 0.022177, 0.019038, 0.016979, 0.015544, 0.013501, 0.012797,
      0.011246, 0.009649, 0.009285, 0.008219, 0.007782, 0.006763, 0.006459,
      0.005988, 0.005348, 0.007821, 0.013953, 0.025221, 0.038554, 0.051282,
      0.060049, 0.066279, 0.06833, 0.067669, 0.064767, 0.061098, 0.05736, 0.052875,
      0.04893, 0.044563, 0.040747, 0.037274, 0.03397, 0.030808, 0.02847, 0.025961,
      0.023976, 0.022344, 0.021277, 0.020121, 0.019211, 0.018574, 0.017736,
      0.017591, 0.017422, 0.017435, 0.017084, 0.016785, 0.017187, 0.016801, 0.01644,
      0.016194, 0.015793, 0.015564, 0.015385, 0.014815, 0.014108, 0.012931,
      0.012357, 0.011257, 0.009474, 0.008235, 0.007519, 0.006297, 0.004405,
      0.004777, 0.003752, 0.003968, 0.003922, 0.004065, 0.004566, 0.005025,
      0.002653, 0.002703, 0.002809, 0.00271, 0.003861, 0.003484, 0.004425, 0.004237,
      0, 0.004425, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.006573,
      0.023897, 0.021341, 0.019625, 0.017227, 0.015734, 0.013722, 0.012542,
      0.011275, 0.009732, 0.00885, 0.007699, 0.007162, 0.006071, 0.00546, 0.005005,
      0.00504, 0.006598, 0.010537, 0.016822, 0.025902, 0.03507, 0.044792, 0.052475,
      0.059048, 0.062551, 0.064885, 0.065158, 0.064335, 0.062391, 0.060185,
      0.057112, 0.054013, 0.051081, 0.04784, 0.045057, 0.042392, 0.039765, 0.037655,
      0.035886, 0.034166, 0.032892, 0.031739, 0.030891, 0.029924, 0.028899,
      0.028243, 0.027818, 0.026999, 0.026161, 0.025267, 0.024376, 0.023753,
      0.022539, 0.021451, 0.020195, 0.01928, 0.018519, 0.017276, 0.015583, 0.014966,
      0.013758, 0.012821, 0.011754, 0.011111, 0.010341, 0.010458, 0.009804,
      0.008197, 0.006897, 0.00722, 0.006198, 0.004773, 0.005089, 0.005168, 0.004684,
      0.002882, 0.002801, 0.0033, 0.003344, 0.004292, 0.003717, 0.003968, 0.003802,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.003945, 0.023878,
      0.021494, 0.019231, 0.017133, 0.015639, 0.013624, 0.011993, 0.011353,
      0.009717, 0.009372, 0.00828, 0.007851, 0.006803, 0.006494, 0.005994, 0.005353,
      0.007813, 0.013953, 0.025253, 0.038882, 0.050932, 0.06053, 0.066586, 0.068259,
      0.067847, 0.064982, 0.061142, 0.057225, 0.053242, 0.048934, 0.044431,
      0.040416, 0.037378, 0.033944, 0.03117, 0.028263, 0.02621, 0.024181, 0.022511,
      0.020906, 0.019737, 0.019299, 0.018163, 0.01781, 0.017675, 0.017513, 0.01694,
      0.017157, 0.016861, 0.016635, 0.016869, 0.016535, 0.016271, 0.015873,
      0.015637, 0.01542, 0.014851, 0.014085, 0.012909, 0.012299, 0.011194, 0.009404,
      0.008187, 0.007472, 0.00625, 0.00438, 0.004769, 0.003731, 0.003968, 0.003914,
      0.004057, 0.004566, 0.005025, 0.002653, 0.002717, 0.002817, 0.002725,
      0.003876, 0.003497, 0.004425, 0.004274, 0, 0.004444, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    acq = rep(
      c(
        0, 0.000858, 0.01364, 0.014085, 0.014197, 0.014592, 0.015666, 0.016239,
        0.016681, 0.018966, 0.021002, 0.02467, 0.028157, 0.032114, 0.038095, 0.042611,
        0.043912, 0.045272, 0.045198, 0.038866, 0.021415, 0.016529, 0.015842,
        0.014374, 0.011662, 0.011225, 0.009569, 0.008246, 0.008097, 0.007376,
        0.006889, 0.006842, 0.007439, 0.007478, 0.008252, 0.00874, 0.009978, 0.010624,
        0.011221, 0.01233, 0.012614, 0.013072, 0.0136, 0.014248, 0.014072, 0.014235,
        0.014188, 0.013849, 0.014112, 0.013975, 0.013284, 0.012325, 0.012146,
        0.011855, 0.011243, 0.010705, 0.01041, 0.009634, 0.009259, 0.008632, 0.008147,
        0.008174, 0.007257, 0.007217, 0.006341, 0.006085, 0.005203, 0.005291,
        0.004231, 0.004918, 0.00346, 0.00361, 0.004141, 0.002387, 0.002551, 0.002591,
        0.002342, 0.00289, 0.002801, 0.0033, 0.003344, 0.004292, 0.003717, 0.003953,
        0, 0.000902, 0.020408, 0.01925, 0.017103, 0.016173, 0.015584, 0.015371,
        0.016529, 0.017891, 0.022007, 0.024276, 0.029331, 0.032227, 0.037827,
        0.043197, 0.047904, 0.050321, 0.049107, 0.045296, 0.037879, 0.033898, 0.02836,
        0.023661, 0.021352, 0.017758, 0.01537, 0.011484, 0.009456, 0.007736, 0.008048,
        0.008055, 0.009621, 0.011429, 0.011809, 0.013376, 0.014736, 0.015337,
        0.015554, 0.016056, 0.017439, 0.01737, 0.017668, 0.017748, 0.017111, 0.01725,
        0.017094, 0.0169, 0.016347, 0.014679, 0.014877, 0.014049, 0.013459, 0.012894,
        0.01217, 0.010784, 0.00936, 0.009245, 0.008244, 0.00745, 0.006891, 0.006635,
        0.005618, 0.005236, 0.004689, 0.003745, 0.003764, 0.002928, 0.00318, 0.001873,
        0.00198, 0.001961, 0.002033, 0.002283, 0, 0.00318, 0.016103, 0.017051,
        0.015943, 0.016239, 0.017346, 0.017007, 0.019071, 0.021459, 0.02494, 0.028046,
        0.032313, 0.037367, 0.042241, 0.045249, 0.047761, 0.049197, 0.048918,
        0.044071, 0.024164, 0.018215, 0.01763, 0.016178, 0.01434, 0.011905, 0.01018,
        0.009559, 0.008621, 0.007864, 0.007914, 0.007852, 0.007866, 0.007882,
        0.009121, 0.010023, 0.010762, 0.011858, 0.012478, 0.013542, 0.01428, 0.014744,
        0.015254, 0.015528, 0.015776, 0.015986, 0.01596, 0.015238, 0.015049, 0.01548,
        0.014308, 0.013966, 0.013849, 0.012995, 0.012404, 0.011935, 0.011688,
        0.010904, 0.010589, 0.00998, 0.009504, 0.008874, 0.008006, 0.008045, 0.007273,
        0.007121, 0.006289, 0.005348, 0.00569, 0.004926, 0.005181, 0.003617, 0.004141,
        0.004773, 0.002545, 0.002584, 0.002336, 0.002882, 0.002801, 0.0033, 0.003344,
        0.004292, 0.003704, 0.003984, 0.003831, 0, 0.002504, 0.023451, 0.022177,
        0.019038, 0.017873, 0.017271, 0.017102, 0.018282, 0.020619, 0.023684,
        0.026927, 0.032877, 0.036965, 0.041546, 0.048439, 0.053892, 0.055615,
        0.054749, 0.05, 0.041614, 0.036145, 0.031746, 0.026961, 0.023256, 0.018438,
        0.015977, 0.012953, 0.010828, 0.009675, 0.009253, 0.010398, 0.010695,
        0.011885, 0.013845, 0.015393, 0.016162, 0.017285, 0.017474, 0.018482,
        0.018868, 0.019297, 0.020121, 0.019717, 0.019578, 0.019301, 0.01919, 0.018002,
        0.017998, 0.017084, 0.016785, 0.015913, 0.014785, 0.014296, 0.013495,
        0.011486, 0.010895, 0.01, 0.009053, 0.008299, 0.007759, 0.006654, 0.006567,
        0.006316, 0.004706, 0.005013, 0.003778, 0.004405, 0.003185, 0.003752,
        0.001984, 0.001961, 0.002033, 0.002283, 0, 0.011029, 0.012195, 0.012489,
        0.01292, 0.013986, 0.01458, 0.01505, 0.017346, 0.019465, 0.021239, 0.025663,
        0.029543, 0.033825, 0.035487, 0.039039, 0.039315, 0.0377, 0.034773, 0.018692,
        0.014801, 0.014028, 0.0125, 0.009901, 0.009524, 0.008936, 0.00687, 0.006859,
        0.006246, 0.005831, 0.006366, 0.005927, 0.006562, 0.007367, 0.007896,
        0.008749, 0.009371, 0.009941, 0.010697, 0.011379, 0.011827, 0.011961, 0.01207,
        0.012357, 0.012059, 0.012385, 0.012446, 0.012201, 0.012461, 0.011746, 0.01123,
        0.010447, 0.010095, 0.010083, 0.009464, 0.009121, 0.008997, 0.007937,
        0.007973, 0.007453, 0.006803, 0.006517, 0.00641, 0.006329, 0.005051, 0.005171,
        0.003922, 0.004202, 0.003279, 0.003448, 0.00361, 0.004132, 0.002387, 0.002545,
        0.002584, 0.002342, 0.002882, 0.002801, 0.0033, 0.003344, 0, 0.003717, 0,
        0.004931, 0.018147, 0.0174, 0.015182, 0.014427, 0.013901, 0.013624, 0.013838,
        0.016083, 0.018551, 0.021556, 0.024839, 0.029441, 0.033042, 0.038961,
        0.042957, 0.043897, 0.043527, 0.039535, 0.031566, 0.027947, 0.024845,
        0.021438, 0.01816, 0.01479, 0.011799, 0.009928, 0.008045, 0.007868, 0.007509,
        0.007528, 0.007912, 0.009238, 0.010293, 0.011853, 0.012775, 0.013361,
        0.013609, 0.014106, 0.015008, 0.015928, 0.015688, 0.015744, 0.015641,
        0.015191, 0.014997, 0.014594, 0.014116, 0.01348, 0.01297, 0.012796, 0.012146,
        0.011503, 0.010847, 0.00938, 0.0086, 0.00771, 0.007426, 0.006628, 0.006024,
        0.005676, 0.004664, 0.00418, 0.004678, 0.003736, 0.00375, 0.00292, 0.00318,
        0.001866, 0.001984, 0.001957, 0.002028, 0.002283, 0
      ),
      rep(
        c(606L, 1L, 18L, 1L, 28L, 1L, 17L, 1L, 29L, 1L, 19L, 1L, 28L),
        c(1L, 83L, 1L, 73L, 1L, 84L, 1L, 73L, 1L, 81L, 1L, 73L, 1L)
      )
    ),
    imm_int_n = c(
      5, 17, 16, 16, 15, 14, 14, 13, 12, 11, 10, 9, 8, 7, 6, 6, 5, 5, 5, 6, 8, 9,
      11, 12, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 13, 13, 12, 12, 12, 11, 11,
      11, 10, 10, 9, 9, 8, 8, 8, 8, 9, 9, 10, 11, 11, 12, 12, 11, 11, 11, 10, 9, 9,
      9, 8, 7, 7, 7, 6, 6, 6, 5, 5, 5, 4, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1,
      1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 15, 15, 14, 13, 12, 11, 10, 9, 8, 8, 7,
      6, 6, 6, 6, 6, 7, 6, 6, 7, 8, 9, 9, 10, 11, 12, 12, 13, 14, 14, 14, 14, 14,
      14, 14, 13, 13, 12, 11, 10, 10, 9, 8, 7, 7, 7, 6, 6, 6, 6, 7, 7, 7, 7, 7, 6,
      6, 6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 4, 4, 4, 4, 3, 3, 3, 3, 3, 2, 2, 2, 2,
      2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 7, 23, 22, 21, 20, 19,
      18, 17, 16, 14, 13, 12, 11, 9, 8, 7, 7, 7, 7, 8, 10, 12, 14, 16, 17, 18, 19,
      19, 19, 19, 19, 19, 18, 18, 18, 17, 17, 16, 16, 15, 15, 14, 14, 13, 12, 12,
      11, 11, 11, 11, 12, 13, 14, 14, 15, 15, 15, 15, 15, 14, 13, 13, 12, 11, 11,
      10, 9, 9, 8, 8, 7, 7, 7, 6, 6, 5, 5, 4, 4, 4, 3, 3, 3, 2, 2, 2, 1, 1, 1, 1, 1,
      1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 23, 20, 18, 17, 15, 14, 13, 12, 11, 10, 9, 9,
      8, 8, 8, 8, 9, 8, 8, 9, 10, 11, 12, 14, 15, 16, 17, 17, 18, 19, 19, 19, 19,
      19, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 9, 9, 8, 8, 8, 9, 9, 9, 9, 9,
      8, 8, 8, 8, 8, 8, 8, 8, 7, 7, 7, 7, 6, 6, 6, 5, 5, 5, 4, 4, 4, 4, 3, 3, 3, 3,
      2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 4, 11, 10, 10, 10,
      10, 9, 9, 8, 7, 7, 6, 5, 5, 4, 4, 4, 3, 4, 4, 5, 6, 7, 8, 9, 9, 10, 10, 10,
      10, 9, 9, 9, 9, 9, 9, 9, 8, 8, 8, 8, 7, 7, 7, 6, 6, 6, 6, 5, 6, 6, 6, 7, 8, 8,
      8, 8, 8, 7, 7, 7, 7, 6, 6, 6, 5, 5, 5, 4, 4, 4, 4, 3, 3, 3, 3, 3, 2, 2, 2, 2,
      2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 10, 10, 9, 9,
      8, 7, 7, 6, 6, 5, 5, 4, 4, 4, 4, 4, 5, 4, 4, 5, 5, 6, 6, 7, 7, 8, 9, 9, 9, 9,
      10, 10, 10, 10, 10, 9, 9, 8, 8, 7, 6, 6, 5, 5, 5, 5, 4, 4, 4, 4, 5, 5, 5, 5,
      4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2,
      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 14, 55, 53, 51,
      49, 47, 47, 46, 45, 45, 44, 44, 43, 42, 40, 38, 38, 40, 47, 58, 72, 89, 107,
      124, 138, 149, 158, 163, 165, 165, 163, 159, 154, 147, 140, 134, 127, 120,
      114, 107, 101, 95, 90, 85, 80, 75, 71, 67, 64, 60, 57, 53, 50, 46, 43, 38, 34,
      29, 25, 22, 19, 16, 13, 11, 9, 8, 7, 6, 5, 4, 3, 3, 2, 2, 1, 1, 1, 1, 1, 1, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18, 57, 53, 50,
      48, 46, 45, 44, 42, 41, 40, 40, 38, 37, 35, 33, 31, 30, 30, 37, 51, 72, 93,
      113, 127, 136, 140, 140, 137, 132, 126, 119, 112, 105, 98, 92, 86, 81, 76, 71,
      67, 63, 59, 55, 52, 49, 47, 44, 42, 40, 38, 36, 34, 32, 29, 27, 23, 21, 18,
      15, 13, 12, 10, 8, 7, 6, 5, 5, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
      2, 2, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 17, 67, 64, 62, 60, 58, 57,
      56, 55, 54, 54, 53, 53, 51, 49, 47, 46, 49, 57, 71, 89, 110, 132, 152, 171,
      185, 194, 201, 203, 203, 200, 195, 189, 182, 174, 166, 157, 148, 140, 132,
      124, 117, 110, 104, 98, 93, 88, 83, 78, 74, 70, 66, 62, 57, 52, 47, 41, 36,
      31, 27, 23, 19, 16, 14, 11, 10, 8, 7, 6, 5, 4, 3, 3, 2, 2, 2, 1, 1, 1, 1, 1,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 23, 69, 65, 62,
      59, 57, 55, 54, 52, 51, 50, 49, 47, 46, 43, 41, 38, 36, 37, 45, 63, 88, 114,
      139, 156, 167, 172, 170, 167, 161, 155, 147, 138, 129, 121, 113, 106, 99, 93,
      87, 82, 77, 72, 68, 64, 61, 57, 54, 51, 49, 46, 44, 42, 39, 36, 33, 29, 25,
      22, 19, 16, 14, 12, 10, 9, 7, 6, 6, 5, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 2,
      2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 11, 42, 40, 39, 38,
      37, 36, 35, 35, 34, 34, 34, 33, 32, 31, 30, 29, 31, 36, 45, 56, 69, 82, 95,
      106, 115, 121, 126, 127, 127, 124, 121, 117, 113, 108, 103, 98, 92, 87, 82,
      78, 73, 69, 65, 61, 58, 54, 51, 48, 46, 43, 41, 38, 36, 33, 29, 26, 22, 20,
      17, 14, 12, 10, 9, 7, 6, 5, 4, 4, 3, 3, 2, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 43, 41, 39, 37, 36, 35,
      33, 33, 32, 31, 30, 30, 28, 27, 26, 24, 23, 23, 28, 39, 55, 72, 86, 98, 105,
      107, 107, 104, 102, 96, 91, 86, 81, 76, 71, 67, 62, 58, 55, 51, 48, 45, 43,
      40, 38, 36, 34, 32, 30, 29, 28, 26, 24, 23, 20, 18, 16, 14, 12, 10, 9, 8, 6,
      5, 5, 4, 4, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    imm_nat_n = c(
      51, 94, 84, 73, 64, 50, 41, 34, 30, 26, 23, 21, 19, 18, 17, 16, 16, 18, 20,
      25, 35, 50, 68, 88, 103, 121, 128, 138, 147, 155, 155, 156, 155, 154, 148,
      137, 124, 114, 101, 93, 83, 78, 69, 65, 59, 56, 52, 47, 46, 43, 42, 42, 41,
      40, 40, 39, 38, 38, 39, 39, 37, 38, 35, 34, 35, 36, 29, 25, 22, 18, 15, 14,
      13, 12, 11, 10, 9, 9, 8, 8, 7, 7, 6, 5, 5, 4, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 0,
      0, 0, 0, 0, 57, 85, 76, 67, 62, 46, 39, 33, 27, 23, 20, 18, 15, 14, 13, 13,
      15, 20, 33, 51, 72, 96, 115, 138, 157, 182, 186, 186, 184, 181, 169, 160, 152,
      146, 135, 125, 113, 103, 91, 84, 76, 68, 61, 56, 49, 46, 42, 39, 38, 38, 37,
      39, 40, 41, 43, 42, 43, 42, 41, 41, 42, 42, 40, 38, 37, 33, 29, 25, 21, 19,
      17, 16, 15, 14, 12, 12, 11, 11, 10, 10, 9, 8, 8, 7, 6, 6, 5, 5, 4, 4, 3, 3, 2,
      1, 1, 1, 1, 1, 0, 0, 1, 51, 101, 84, 73, 64, 51, 41, 34, 30, 26, 23, 21, 19,
      18, 17, 16, 16, 18, 20, 25, 35, 50, 68, 88, 103, 121, 128, 137, 147, 155, 156,
      157, 155, 154, 148, 137, 124, 114, 101, 93, 83, 77, 70, 65, 60, 57, 52, 47,
      46, 43, 42, 42, 41, 40, 40, 39, 38, 38, 40, 39, 37, 38, 35, 34, 35, 36, 29,
      25, 22, 18, 15, 14, 13, 12, 11, 10, 9, 9, 8, 8, 7, 7, 6, 5, 5, 4, 3, 3, 3, 2,
      2, 2, 2, 1, 1, 1, 0, 0, 0, 0, 0, 63, 93, 76, 67, 62, 47, 39, 33, 27, 23, 20,
      18, 15, 14, 13, 13, 15, 20, 33, 51, 72, 95, 115, 138, 157, 182, 186, 187, 184,
      181, 169, 160, 152, 145, 135, 125, 113, 104, 91, 84, 76, 68, 61, 56, 49, 45,
      41, 39, 38, 38, 37, 39, 40, 41, 43, 42, 43, 42, 41, 41, 42, 42, 40, 38, 37,
      33, 29, 25, 21, 19, 17, 16, 15, 14, 12, 12, 11, 11, 10, 10, 9, 8, 8, 7, 6, 6,
      5, 5, 4, 4, 3, 3, 2, 1, 1, 1, 1, 1, 0, 0, 1, 44, 86, 85, 72, 65, 50, 40, 35,
      30, 26, 23, 21, 19, 18, 17, 16, 16, 18, 20, 25, 35, 50, 68, 88, 103, 122, 129,
      138, 147, 155, 155, 157, 155, 154, 148, 138, 124, 115, 101, 93, 83, 78, 70,
      65, 60, 57, 52, 47, 45, 43, 42, 42, 41, 40, 39, 39, 38, 38, 39, 38, 37, 38,
      35, 34, 35, 35, 29, 25, 22, 18, 16, 14, 13, 11, 10, 10, 9, 9, 8, 8, 7, 7, 6,
      5, 5, 4, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 0, 0, 0, 0, 0, 54, 79, 76, 67, 62, 46,
      39, 32, 27, 23, 20, 18, 15, 14, 13, 13, 15, 20, 33, 51, 72, 95, 115, 138, 157,
      180, 186, 186, 183, 180, 169, 159, 151, 145, 135, 124, 113, 103, 91, 84, 76,
      68, 61, 56, 50, 46, 42, 39, 38, 38, 37, 39, 40, 41, 43, 42, 43, 42, 41, 41,
      42, 42, 40, 38, 37, 33, 29, 25, 21, 19, 17, 16, 15, 14, 12, 12, 11, 11, 10,
      10, 9, 8, 8, 7, 6, 6, 5, 5, 4, 4, 3, 3, 2, 1, 1, 1, 1, 1, 0, 0, 1, 19, 35, 28,
      26, 26, 22, 21, 20, 19, 18, 16, 15, 13, 13, 12, 12, 12, 14, 17, 23, 31, 40,
      49, 61, 74, 92, 104, 114, 124, 130, 133, 135, 138, 139, 137, 135, 128, 127,
      117, 112, 106, 98, 91, 86, 80, 77, 69, 65, 59, 55, 49, 47, 41, 39, 36, 34, 32,
      30, 26, 25, 22, 20, 17, 14, 12, 12, 9, 7, 5, 5, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2,
      1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 42, 33, 29,
      27, 23, 20, 18, 16, 14, 12, 11, 9, 8, 7, 6, 7, 9, 13, 21, 33, 42, 52, 61, 70,
      81, 88, 95, 102, 104, 103, 97, 96, 90, 84, 80, 74, 69, 63, 58, 54, 50, 44, 41,
      39, 36, 33, 32, 31, 30, 28, 27, 26, 25, 24, 23, 21, 19, 17, 15, 14, 13, 11, 9,
      8, 8, 7, 5, 4, 4, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 23, 38, 28, 26, 26, 22, 21, 21, 19, 18, 16,
      15, 13, 13, 12, 12, 12, 14, 17, 23, 32, 41, 50, 62, 75, 94, 107, 117, 127,
      133, 135, 137, 138, 139, 137, 136, 128, 127, 118, 112, 106, 98, 91, 87, 80,
      77, 69, 64, 59, 55, 49, 47, 41, 39, 36, 34, 32, 30, 26, 25, 22, 20, 17, 14,
      12, 11, 9, 7, 5, 5, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 22, 45, 33, 29, 27, 23, 21, 18, 15, 14,
      12, 11, 9, 8, 7, 6, 7, 9, 13, 21, 33, 42, 53, 62, 71, 83, 90, 98, 103, 105,
      104, 98, 97, 93, 84, 80, 75, 69, 63, 58, 53, 49, 44, 41, 38, 37, 34, 33, 31,
      30, 28, 27, 26, 25, 24, 22, 21, 19, 17, 15, 14, 13, 11, 9, 8, 7, 7, 5, 4, 4,
      3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 19, 32, 28, 26, 26, 23, 21, 21, 19, 18, 16, 15, 13, 13, 12, 12,
      12, 14, 17, 23, 31, 40, 49, 60, 72, 90, 102, 111, 122, 127, 130, 134, 136,
      138, 136, 134, 128, 126, 117, 111, 106, 98, 91, 86, 80, 77, 69, 65, 59, 55,
      50, 47, 41, 40, 36, 34, 32, 30, 27, 26, 22, 20, 17, 14, 12, 12, 10, 7, 5, 5,
      4, 3, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 21, 38, 33, 29, 27, 23, 21, 18, 16, 14, 12, 11, 9, 8, 7, 6, 7,
      9, 13, 21, 32, 41, 50, 60, 68, 78, 86, 94, 99, 101, 101, 97, 95, 91, 84, 80,
      74, 69, 63, 59, 53, 50, 45, 41, 39, 36, 33, 33, 31, 30, 28, 27, 26, 25, 24,
      22, 21, 20, 17, 16, 14, 13, 11, 9, 9, 7, 7, 5, 4, 4, 3, 2, 2, 2, 2, 2, 2, 2,
      2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    emi_nat_n = c(
      22, 51, 54, 49, 47, 39, 34, 29, 25, 21, 20, 17, 15, 13, 12, 11, 11, 15, 23,
      36, 50, 67, 84, 103, 120, 148, 157, 165, 165, 167, 145, 134, 132, 123, 109,
      99, 89, 80, 72, 68, 60, 59, 55, 52, 49, 46, 42, 40, 38, 34, 34, 35, 34, 34,
      34, 35, 34, 35, 35, 34, 33, 33, 30, 29, 35, 47, 23, 22, 21, 19, 18, 17, 16,
      15, 13, 13, 12, 12, 11, 11, 10, 9, 8, 7, 6, 4, 4, 4, 3, 2, 2, 2, 1, 1, 1, 1,
      0, 0, 0, 0, 0, 23, 66, 54, 47, 43, 34, 29, 25, 22, 19, 17, 15, 14, 14, 14, 15,
      17, 23, 32, 49, 71, 103, 131, 157, 178, 199, 209, 201, 198, 183, 165, 148,
      128, 120, 103, 91, 77, 70, 62, 56, 50, 48, 45, 44, 42, 39, 37, 34, 35, 36, 34,
      33, 33, 34, 36, 37, 36, 38, 37, 37, 36, 36, 35, 32, 39, 35, 27, 26, 25, 23,
      21, 20, 18, 18, 16, 15, 14, 13, 12, 11, 10, 10, 9, 7, 6, 5, 5, 4, 3, 3, 2, 2,
      1, 1, 1, 1, 0, 0, 0, 0, 0, 24, 55, 54, 49, 47, 39, 34, 29, 25, 21, 20, 17, 15,
      13, 12, 11, 11, 15, 23, 36, 50, 67, 84, 103, 120, 149, 157, 165, 166, 167,
      145, 135, 132, 123, 109, 99, 89, 80, 72, 68, 61, 59, 55, 52, 49, 46, 42, 40,
      38, 35, 34, 35, 34, 34, 35, 35, 34, 35, 35, 34, 33, 33, 30, 29, 35, 47, 23,
      22, 21, 19, 18, 17, 16, 15, 13, 13, 12, 12, 11, 11, 10, 9, 8, 7, 6, 4, 4, 4,
      3, 2, 2, 2, 1, 1, 1, 1, 0, 0, 0, 0, 0, 24, 71, 54, 48, 43, 34, 29, 25, 22, 19,
      17, 15, 14, 14, 14, 16, 17, 23, 32, 49, 71, 103, 131, 158, 178, 199, 210, 202,
      198, 183, 165, 148, 128, 120, 103, 92, 77, 70, 62, 56, 50, 48, 45, 44, 42, 39,
      37, 34, 35, 36, 34, 33, 33, 34, 36, 37, 36, 38, 37, 37, 36, 36, 35, 32, 39,
      35, 27, 26, 25, 23, 21, 20, 18, 18, 16, 15, 14, 13, 12, 12, 10, 10, 9, 7, 6,
      5, 5, 4, 3, 3, 2, 2, 1, 1, 1, 1, 0, 0, 0, 0, 0, 20, 47, 53, 48, 47, 39, 33,
      29, 25, 21, 20, 17, 15, 13, 12, 11, 11, 15, 23, 36, 50, 67, 84, 103, 120, 148,
      157, 165, 165, 167, 145, 134, 132, 122, 109, 99, 89, 80, 72, 68, 60, 59, 54,
      52, 49, 46, 42, 40, 38, 34, 34, 35, 34, 34, 34, 35, 34, 35, 35, 34, 33, 33,
      30, 29, 35, 47, 23, 22, 21, 19, 18, 17, 16, 15, 13, 13, 12, 12, 11, 11, 10, 9,
      8, 7, 6, 4, 4, 4, 3, 2, 2, 2, 1, 1, 1, 1, 0, 0, 0, 0, 0, 21, 61, 54, 47, 43,
      34, 29, 25, 22, 19, 17, 15, 14, 14, 14, 15, 17, 23, 32, 49, 71, 103, 131, 157,
      177, 198, 209, 201, 197, 182, 164, 147, 128, 120, 103, 91, 77, 70, 61, 55, 50,
      48, 45, 44, 42, 39, 37, 34, 34, 36, 34, 33, 33, 34, 36, 37, 36, 38, 37, 37,
      36, 36, 34, 32, 39, 35, 27, 26, 25, 23, 21, 20, 18, 18, 16, 15, 14, 13, 12,
      11, 10, 10, 9, 7, 6, 5, 4, 4, 3, 3, 2, 2, 1, 1, 1, 1, 0, 0, 0, 0, 0, 7, 28,
      22, 22, 20, 18, 16, 15, 13, 12, 10, 9, 8, 7, 6, 5, 5, 7, 10, 18, 28, 35, 43,
      54, 63, 79, 86, 96, 104, 109, 105, 107, 108, 105, 104, 104, 95, 89, 89, 82,
      78, 77, 71, 70, 67, 64, 59, 57, 52, 49, 45, 43, 40, 38, 34, 31, 30, 28, 26,
      23, 22, 19, 16, 13, 11, 10, 8, 6, 5, 4, 4, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1,
      1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 27, 21, 19, 19, 18,
      15, 13, 12, 11, 10, 9, 8, 7, 6, 6, 5, 7, 12, 20, 32, 41, 49, 56, 61, 70, 74,
      78, 81, 79, 79, 74, 71, 69, 63, 61, 56, 52, 48, 45, 43, 40, 38, 37, 34, 33,
      30, 30, 28, 26, 26, 25, 23, 24, 22, 20, 20, 18, 17, 15, 13, 12, 9, 7, 6, 5, 3,
      3, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 8, 30, 22, 22, 21, 18, 17, 15, 13, 12, 10, 9, 8, 7, 6,
      5, 5, 7, 10, 18, 28, 36, 44, 55, 64, 80, 88, 98, 106, 110, 107, 109, 110, 106,
      105, 104, 96, 89, 89, 83, 79, 77, 71, 70, 67, 64, 60, 57, 52, 50, 46, 43, 40,
      38, 34, 32, 30, 28, 26, 23, 22, 19, 16, 13, 11, 10, 8, 6, 5, 4, 4, 3, 2, 2, 2,
      2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      5, 29, 22, 19, 19, 18, 15, 14, 12, 11, 10, 9, 8, 7, 6, 6, 5, 7, 12, 20, 32,
      42, 49, 57, 63, 72, 75, 79, 83, 80, 80, 75, 72, 70, 64, 61, 56, 52, 48, 45,
      43, 40, 38, 37, 34, 33, 30, 31, 28, 26, 27, 25, 23, 24, 22, 20, 20, 18, 17,
      15, 13, 12, 9, 7, 6, 5, 3, 3, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7, 26, 21, 22, 20, 18, 16,
      15, 13, 12, 10, 9, 8, 7, 6, 5, 5, 7, 10, 18, 28, 35, 43, 53, 62, 77, 85, 95,
      103, 107, 104, 106, 107, 104, 103, 103, 95, 88, 88, 82, 78, 77, 71, 70, 67,
      63, 59, 57, 52, 49, 45, 42, 40, 38, 34, 31, 30, 28, 26, 23, 22, 19, 16, 13,
      11, 10, 8, 7, 5, 4, 4, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 25, 21, 19, 19, 18, 15, 13, 12, 11, 10,
      9, 8, 7, 6, 6, 5, 7, 12, 20, 32, 41, 48, 55, 60, 69, 72, 76, 80, 78, 78, 73,
      70, 69, 63, 61, 55, 52, 48, 45, 42, 39, 38, 36, 34, 33, 30, 30, 28, 26, 26,
      25, 23, 24, 22, 20, 20, 18, 17, 15, 13, 12, 9, 7, 6, 5, 3, 3, 2, 2, 2, 2, 2,
      2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0
    ),
    mig_nat_n = c(
      29, 43, 30, 24, 17, 11, 7, 5, 5, 5, 3, 4, 4, 5, 5, 5, 5, 3, -3, -11, -15, -17,
      -16, -15, -17, -27, -29, -27, -18, -12, 10, 22, 23, 31, 39, 38, 35, 34, 29,
      25, 23, 19, 14, 13, 10, 10, 10, 7, 8, 9, 8, 7, 7, 6, 6, 4, 4, 3, 4, 5, 4, 5,
      5, 5, 0, -11, 6, 3, 1, -1, -3, -3, -3, -3, -2, -3, -3, -3, -3, -3, -3, -2, -2,
      -2, -1, 0, -1, -1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 34, 19, 22, 20, 19,
      12, 10, 8, 5, 4, 3, 3, 1, 0, -1, -2, -2, -3, 1, 2, 1, -7, -16, -19, -21, -17,
      -23, -15, -14, -2, 4, 12, 24, 26, 32, 34, 36, 33, 29, 28, 26, 20, 16, 12, 7,
      7, 5, 5, 3, 2, 3, 6, 7, 7, 7, 5, 7, 4, 4, 4, 6, 6, 5, 6, -2, -2, 2, -1, -4,
      -4, -4, -4, -3, -4, -4, -3, -3, -2, -2, -1, -1, -2, -1, 0, 0, 1, 0, 1, 1, 1,
      1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 27, 46, 30, 24, 17, 12, 7, 5, 5, 5, 3, 4, 4,
      5, 5, 5, 5, 3, -3, -11, -15, -17, -16, -15, -17, -28, -29, -28, -19, -12, 11,
      22, 23, 31, 39, 38, 35, 34, 29, 25, 22, 18, 15, 13, 11, 11, 10, 7, 8, 8, 8, 7,
      7, 6, 5, 4, 4, 3, 5, 5, 4, 5, 5, 5, 0, -11, 6, 3, 1, -1, -3, -3, -3, -3, -2,
      -3, -3, -3, -3, -3, -3, -2, -2, -2, -1, 0, -1, -1, 0, 0, 0, 0, 1, 0, 0, 0, 0,
      0, 0, 0, 0, 39, 22, 22, 19, 19, 13, 10, 8, 5, 4, 3, 3, 1, 0, -1, -3, -2, -3,
      1, 2, 1, -8, -16, -20, -21, -17, -24, -15, -14, -2, 4, 12, 24, 25, 32, 33, 36,
      34, 29, 28, 26, 20, 16, 12, 7, 6, 4, 5, 3, 2, 3, 6, 7, 7, 7, 5, 7, 4, 4, 4, 6,
      6, 5, 6, -2, -2, 2, -1, -4, -4, -4, -4, -3, -4, -4, -3, -3, -2, -2, -2, -1,
      -2, -1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 24, 39, 32, 24,
      18, 11, 7, 6, 5, 5, 3, 4, 4, 5, 5, 5, 5, 3, -3, -11, -15, -17, -16, -15, -17,
      -26, -28, -27, -18, -12, 10, 23, 23, 32, 39, 39, 35, 35, 29, 25, 23, 19, 16,
      13, 11, 11, 10, 7, 7, 9, 8, 7, 7, 6, 5, 4, 4, 3, 4, 4, 4, 5, 5, 5, 0, -12, 6,
      3, 1, -1, -2, -3, -3, -4, -3, -3, -3, -3, -3, -3, -3, -2, -2, -2, -1, 0, -1,
      -1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 33, 18, 22, 20, 19, 12, 10, 7, 5,
      4, 3, 3, 1, 0, -1, -2, -2, -3, 1, 2, 1, -8, -16, -19, -20, -18, -23, -15, -14,
      -2, 5, 12, 23, 25, 32, 33, 36, 33, 30, 29, 26, 20, 16, 12, 8, 7, 5, 5, 4, 2,
      3, 6, 7, 7, 7, 5, 7, 4, 4, 4, 6, 6, 6, 6, -2, -2, 2, -1, -4, -4, -4, -4, -3,
      -4, -4, -3, -3, -2, -2, -1, -1, -2, -1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0,
      1, 1, 0, 0, 1, 12, 7, 6, 4, 6, 4, 5, 5, 6, 6, 6, 6, 5, 6, 6, 7, 7, 7, 7, 5, 3,
      5, 6, 7, 11, 13, 18, 18, 20, 21, 28, 28, 30, 34, 33, 31, 33, 38, 28, 30, 28,
      21, 20, 16, 13, 13, 10, 8, 7, 6, 4, 4, 1, 1, 2, 3, 2, 2, 0, 2, 0, 1, 1, 1, 1,
      2, 1, 1, 0, 1, -1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 15, 12, 10, 8, 5, 5, 5, 4, 3, 2, 2, 1, 1, 1,
      0, 2, 2, 1, 1, 1, 1, 3, 5, 9, 11, 14, 17, 21, 25, 24, 23, 25, 21, 21, 19, 18,
      17, 15, 13, 11, 10, 6, 4, 5, 3, 3, 2, 3, 4, 2, 2, 3, 1, 2, 3, 1, 1, 0, 0, 1,
      1, 2, 2, 2, 3, 4, 2, 2, 2, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1,
      1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 8, 6, 4, 5, 4, 4, 6, 6, 6, 6, 6,
      5, 6, 6, 7, 7, 7, 7, 5, 4, 5, 6, 7, 11, 14, 19, 19, 21, 23, 28, 28, 28, 33,
      32, 32, 32, 38, 29, 29, 27, 21, 20, 17, 13, 13, 9, 7, 7, 5, 3, 4, 1, 1, 2, 2,
      2, 2, 0, 2, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, -1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0,
      0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 17, 16, 11, 10, 8, 5,
      6, 4, 3, 3, 2, 2, 1, 1, 1, 0, 2, 2, 1, 1, 1, 0, 4, 5, 8, 11, 15, 19, 20, 25,
      24, 23, 25, 23, 20, 19, 19, 17, 15, 13, 10, 9, 6, 4, 4, 4, 4, 2, 3, 4, 1, 2,
      3, 1, 2, 2, 1, 1, 0, 0, 1, 1, 2, 2, 2, 2, 4, 2, 2, 2, 1, 0, 0, 0, 1, 1, 1, 1,
      1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 6, 7,
      4, 6, 5, 5, 6, 6, 6, 6, 6, 5, 6, 6, 7, 7, 7, 7, 5, 3, 5, 6, 7, 10, 13, 17, 16,
      19, 20, 26, 28, 29, 34, 33, 31, 33, 38, 29, 29, 28, 21, 20, 16, 13, 14, 10, 8,
      7, 6, 5, 5, 1, 2, 2, 3, 2, 2, 1, 3, 0, 1, 1, 1, 1, 2, 2, 0, 0, 1, 0, 0, 0, 0,
      0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 17, 13, 12, 10, 8, 5, 6, 5, 4, 3, 2, 2, 1, 1, 1, 0, 2, 2, 1, 1, 0, 0, 2, 5,
      8, 9, 14, 18, 19, 23, 23, 24, 25, 22, 21, 19, 19, 17, 15, 14, 11, 11, 7, 5, 5,
      3, 3, 3, 3, 4, 2, 2, 3, 1, 2, 2, 1, 2, 0, 1, 1, 1, 2, 2, 3, 2, 4, 2, 2, 2, 1,
      0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0
    ),
    fso_projection_n = c(
      2486, 2545, 2500, 2639, 2972, 2837, 2857, 2843, 2847, 2794, 2903, 2941, 2842,
      2863, 2901, 2923, 2809, 2872, 2736, 2789, 2766, 2758, 2718, 2677, 2630, 2840,
      2771, 2832, 2870, 3038, 2850, 2900, 3145, 3270, 3267, 3306, 3306, 3310, 3276,
      3366, 3237, 3380, 3351, 3386, 3349, 3364, 3203, 3156, 3150, 2989, 3061, 3240,
      3284, 3409, 3582, 3725, 3785, 4026, 4094, 4119, 4206, 4249, 4035, 4001, 3863,
      3642, 3535, 3390, 3354, 3209, 3143, 2977, 2894, 2778, 2553, 2572, 2445, 2459,
      2349, 2256, 2086, 1940, 1811, 1527, 1362, 1032, 921, 867, 728, 577, 519, 431,
      318, 268, 199, 146, 90, 64, 38, 16, 28, 2371, 2416, 2388, 2516, 2766, 2601,
      2637, 2664, 2722, 2717, 2700, 2667, 2648, 2730, 2679, 2857, 2675, 2772, 2635,
      2632, 2588, 2648, 2581, 2549, 2532, 2648, 2738, 2708, 2828, 2873, 2912, 2988,
      3011, 3271, 3279, 3387, 3280, 3396, 3363, 3370, 3310, 3402, 3376, 3469, 3487,
      3350, 3287, 3096, 3185, 3347, 3222, 3228, 3277, 3441, 3747, 3875, 3914, 4204,
      4196, 4292, 4272, 4379, 4273, 4118, 4015, 3899, 3711, 3689, 3667, 3474, 3371,
      3214, 3109, 3096, 2878, 2885, 2775, 2688, 2614, 2565, 2440, 2333, 2234, 1947,
      1714, 1480, 1378, 1242, 1076, 1033, 841, 748, 593, 506, 376, 300, 228, 163,
      108, 74, 105, 2695, 2725, 2516, 2648, 2984, 2848, 2865, 2852, 2858, 2806,
      2913, 2954, 2856, 2875, 2911, 2933, 2819, 2884, 2749, 2799, 2771, 2763, 2723,
      2682, 2634, 2845, 2780, 2838, 2876, 3045, 2860, 2908, 3151, 3279, 3277, 3316,
      3316, 3320, 3287, 3379, 3246, 3391, 3365, 3397, 3362, 3376, 3215, 3166, 3158,
      2998, 3070, 3250, 3294, 3418, 3589, 3733, 3791, 4034, 4103, 4124, 4211, 4256,
      4042, 4003, 3866, 3648, 3536, 3395, 3360, 3216, 3150, 2981, 2903, 2784, 2560,
      2579, 2452, 2464, 2355, 2261, 2091, 1946, 1816, 1536, 1370, 1043, 935, 885,
      747, 597, 540, 451, 336, 284, 210, 154, 94, 67, 38, 16, 27, 2576, 2593, 2401,
      2526, 2775, 2611, 2645, 2670, 2731, 2726, 2708, 2677, 2660, 2742, 2690, 2870,
      2689, 2785, 2647, 2641, 2594, 2652, 2587, 2553, 2538, 2655, 2743, 2716, 2836,
      2882, 2925, 2998, 3021, 3282, 3290, 3400, 3293, 3409, 3375, 3381, 3323, 3413,
      3385, 3479, 3500, 3357, 3293, 3106, 3193, 3354, 3229, 3234, 3282, 3445, 3751,
      3879, 3918, 4207, 4199, 4294, 4274, 4383, 4276, 4120, 4018, 3904, 3716, 3695,
      3673, 3477, 3376, 3220, 3114, 3102, 2885, 2891, 2782, 2695, 2621, 2572, 2451,
      2344, 2245, 1957, 1724, 1489, 1390, 1255, 1089, 1044, 853, 761, 604, 517, 385,
      311, 238, 171, 115, 79, 113, 2258, 2331, 2492, 2626, 2963, 2827, 2846, 2833,
      2838, 2784, 2892, 2930, 2831, 2849, 2886, 2910, 2795, 2855, 2727, 2780, 2761,
      2753, 2712, 2669, 2621, 2835, 2765, 2824, 2862, 3029, 2844, 2893, 3135, 3263,
      3259, 3300, 3297, 3301, 3265, 3357, 3227, 3369, 3339, 3375, 3340, 3354, 3194,
      3148, 3137, 2982, 3051, 3230, 3273, 3401, 3573, 3716, 3778, 4021, 4088, 4109,
      4199, 4248, 4030, 3996, 3857, 3638, 3531, 3384, 3349, 3204, 3140, 2970, 2886,
      2769, 2545, 2564, 2436, 2449, 2338, 2244, 2073, 1930, 1797, 1513, 1347, 1020,
      909, 856, 717, 569, 508, 421, 312, 262, 193, 141, 87, 62, 36, 16, 27, 2164,
      2215, 2378, 2505, 2758, 2594, 2629, 2654, 2715, 2708, 2692, 2656, 2640, 2719,
      2667, 2845, 2662, 2760, 2623, 2622, 2578, 2638, 2573, 2540, 2524, 2640, 2730,
      2703, 2822, 2867, 2905, 2980, 3001, 3260, 3267, 3374, 3267, 3383, 3353, 3356,
      3298, 3387, 3363, 3460, 3478, 3338, 3277, 3086, 3179, 3340, 3216, 3223, 3270,
      3436, 3743, 3869, 3907, 4201, 4193, 4288, 4268, 4375, 4270, 4115, 4012, 3899,
      3708, 3686, 3660, 3466, 3364, 3210, 3102, 3088, 2872, 2879, 2768, 2680, 2604,
      2556, 2430, 2322, 2220, 1934, 1701, 1466, 1366, 1229, 1065, 1019, 828, 735,
      580, 492, 363, 289, 218, 155, 103, 69, 97, 1180, 1175, 1008, 1136, 1177, 1160,
      1183, 1212, 1175, 1249, 1146, 1178, 1124, 1151, 1095, 997, 987, 1053, 959,
      1098, 1124, 1063, 1043, 1113, 1167, 1356, 1448, 1596, 1740, 1853, 1872, 1992,
      2110, 2159, 2262, 2378, 2330, 2298, 2400, 2345, 2334, 2375, 2267, 2287, 2255,
      2191, 2098, 2055, 1934, 1882, 1786, 1729, 1683, 1683, 1582, 1528, 1540, 1489,
      1474, 1443, 1428, 1350, 1214, 1068, 940, 891, 713, 690, 596, 566, 539, 472,
      408, 382, 374, 414, 336, 346, 294, 289, 223, 257, 242, 250, 190, 211, 178,
      142, 98, 99, 70, 41, 26, 11, 10, 5, 7, 3, 1, 0, 0, 1135, 1143, 1007, 1013,
      1125, 1164, 1118, 1102, 1074, 1141, 1074, 1088, 1019, 1019, 912, 976, 910,
      874, 842, 789, 838, 848, 865, 924, 1000, 1145, 1242, 1381, 1532, 1597, 1709,
      1746, 1823, 1922, 1921, 2008, 1991, 2022, 2017, 2023, 2027, 1990, 1974, 1985,
      1912, 1869, 1716, 1770, 1637, 1549, 1566, 1487, 1399, 1477, 1390, 1282, 1287,
      1198, 1186, 1135, 1028, 1040, 931, 831, 773, 780, 672, 620, 529, 501, 503,
      485, 432, 392, 373, 363, 348, 361, 254, 279, 219, 227, 189, 217, 193, 205,
      184, 137, 128, 78, 75, 46, 44, 23, 19, 13, 13, 7, 5, 2, 3, 1274, 1243, 1014,
      1143, 1186, 1170, 1194, 1225, 1185, 1256, 1157, 1185, 1129, 1158, 1101, 1004,
      993, 1058, 965, 1108, 1146, 1088, 1077, 1149, 1215, 1407, 1500, 1650, 1793,
      1908, 1925, 2042, 2155, 2204, 2302, 2415, 2363, 2330, 2425, 2366, 2352, 2392,
      2284, 2302, 2263, 2204, 2110, 2066, 1945, 1893, 1795, 1737, 1694, 1690, 1589,
      1532, 1542, 1486, 1469, 1440, 1422, 1344, 1207, 1060, 931, 873, 700, 682, 596,
      567, 539, 471, 409, 382, 376, 416, 336, 345, 293, 289, 224, 258, 238, 247,
      190, 210, 178, 143, 99, 100, 73, 43, 29, 13, 11, 6, 9, 3, 1, 0, 0, 1227, 1211,
      1016, 1022, 1136, 1171, 1129, 1111, 1082, 1150, 1086, 1096, 1025, 1026, 917,
      976, 911, 872, 843, 794, 850, 865, 894, 963, 1043, 1194, 1294, 1429, 1577,
      1639, 1748, 1785, 1858, 1952, 1947, 2032, 2012, 2041, 2033, 2037, 2038, 2001,
      1986, 1995, 1919, 1878, 1728, 1778, 1643, 1555, 1572, 1492, 1405, 1482, 1395,
      1285, 1291, 1200, 1181, 1131, 1024, 1035, 923, 826, 767, 775, 669, 619, 526,
      499, 503, 485, 432, 393, 373, 366, 351, 364, 255, 282, 221, 229, 188, 218,
      191, 206, 184, 139, 130, 80, 76, 47, 46, 24, 20, 14, 13, 8, 6, 2, 3, 1081,
      1090, 994, 1125, 1168, 1152, 1173, 1205, 1161, 1237, 1137, 1170, 1115, 1145,
      1091, 992, 983, 1052, 951, 1086, 1106, 1036, 1012, 1073, 1123, 1308, 1396,
      1544, 1687, 1800, 1816, 1942, 2060, 2114, 2222, 2343, 2297, 2269, 2373, 2318,
      2311, 2355, 2251, 2272, 2240, 2181, 2086, 2043, 1921, 1868, 1776, 1720, 1676,
      1677, 1576, 1523, 1537, 1488, 1477, 1448, 1434, 1354, 1217, 1072, 949, 904,
      728, 693, 598, 568, 540, 472, 408, 382, 374, 413, 336, 345, 293, 288, 224,
      257, 241, 250, 189, 209, 176, 141, 97, 97, 69, 40, 25, 11, 9, 5, 7, 3, 1, 0,
      0, 1037, 1058, 992, 1001, 1117, 1155, 1110, 1092, 1064, 1133, 1066, 1082,
      1011, 1015, 908, 975, 910, 873, 841, 787, 829, 828, 838, 887, 954, 1098, 1193,
      1331, 1479, 1547, 1666, 1709, 1790, 1893, 1895, 1987, 1973, 2005, 2000, 2010,
      2013, 1980, 1967, 1977, 1904, 1860, 1709, 1766, 1628, 1541, 1559, 1480, 1390,
      1470, 1382, 1274, 1286, 1199, 1186, 1137, 1031, 1047, 936, 834, 778, 784, 675,
      620, 530, 499, 505, 486, 431, 392, 371, 362, 349, 360, 253, 280, 220, 227,
      187, 215, 189, 204, 181, 136, 128, 77, 74, 46, 44, 23, 20, 13, 12, 7, 5, 2, 3
    ),
  )

  # calculation -----
  project_population_default_2 <- project_population(
    project_population_default_1,
    parameters_short_2,
    fert_first,
    fert_last,
    share_born_female,
    subregional,
    binational
  )

  expect_snapshot(constructive::construct(project_population_default_2))

  # expect to be different
  expect_failure(expect_equal(
    project_population_default_1 |>
      filter(year == 2024) |>
      select(-c(year)),
    project_population_default_2 |>
      filter(year == 2025) |>
      select(-c(year))
  ))
})



# Prepare snapshot 1 region ----
test_that("tests propop: 1 region vs. 5 regions", {
  skip_on_ci()

  ## FSO parameters ----
  # fso_parameters |>
  #   dplyr::filter(year == 2024 & scen == "reference") |>
  #   constructive::construct()

  parameters_short_1r <- tibble::tibble(
    nat = rep(c("ch", "int"), each = 202L),
    sex = rep(rep(c("m", "f"), 2), each = 101L),
    age = rep(seq(0, 100, by = 1), 4),
    start_n = c(
      0, 2366, 2542, 2891, 2766, 2794, 2782, 2787, 2726, 2837, 2866, 2760, 2766,
      2799, 2823, 2707, 2768, 2660, 2744, 2760, 2767, 2730, 2686, 2639, 2872, 2812,
      2874, 2899, 3060, 2823, 2844, 3085, 3189, 3162, 3192, 3193, 3197, 3164, 3262,
      3130, 3280, 3263, 3300, 3269, 3288, 3131, 3091, 3087, 2931, 3008, 3194, 3242,
      3371, 3555, 3707, 3773, 4028, 4106, 4133, 4231, 4286, 4070, 4041, 3910, 3716,
      3609, 3443, 3416, 3277, 3219, 3054, 2977, 2865, 2641, 2672, 2552, 2582, 2485,
      2406, 2246, 2115, 2001, 1715, 1556, 1204, 1100, 1064, 915, 746, 688, 587, 446,
      389, 302, 234, 153, 118, 75, 35, 33, 38, 0, 2277, 2434, 2685, 2533, 2577,
      2609, 2671, 2660, 2642, 2599, 2580, 2653, 2600, 2763, 2581, 2683, 2549, 2564,
      2526, 2611, 2569, 2553, 2548, 2661, 2766, 2723, 2845, 2866, 2891, 2946, 2936,
      3186, 3172, 3268, 3149, 3267, 3238, 3240, 3184, 3288, 3272, 3375, 3408, 3272,
      3224, 3034, 3137, 3309, 3184, 3190, 3242, 3410, 3727, 3867, 3905, 4211, 4207,
      4307, 4287, 4399, 4297, 4143, 4054, 3949, 3751, 3732, 3716, 3524, 3425, 3272,
      3168, 3163, 2949, 2963, 2860, 2778, 2712, 2676, 2561, 2468, 2384, 2097, 1870,
      1638, 1556, 1432, 1275, 1259, 1059, 978, 806, 719, 560, 473, 378, 286, 203,
      148, 97, 149, 0, 920, 1120, 1157, 1137, 1159, 1189, 1143, 1228, 1121, 1162,
      1113, 1156, 1106, 1004, 1000, 1075, 954, 1076, 1064, 968, 919, 960, 986, 1162,
      1231, 1378, 1517, 1635, 1638, 1769, 1899, 1956, 2082, 2226, 2179, 2149, 2293,
      2244, 2248, 2321, 2216, 2254, 2236, 2176, 2087, 2051, 1928, 1878, 1784, 1726,
      1690, 1694, 1592, 1542, 1570, 1529, 1532, 1506, 1501, 1415, 1272, 1132, 1021,
      1008, 817, 753, 628, 592, 567, 495, 430, 403, 398, 441, 357, 369, 313, 310,
      242, 281, 264, 275, 208, 234, 202, 167, 119, 124, 95, 58, 41, 19, 18, 11, 16,
      7, 3, 0, 0, 1, 0, 898, 974, 1100, 1145, 1094, 1075, 1049, 1128, 1064, 1089,
      1023, 1039, 933, 1023, 958, 920, 884, 808, 832, 798, 766, 780, 818, 948, 1028,
      1162, 1317, 1382, 1515, 1571, 1668, 1792, 1808, 1919, 1913, 1958, 1966, 1986,
      2002, 1972, 1966, 1986, 1912, 1873, 1714, 1776, 1634, 1542, 1568, 1485, 1392,
      1481, 1390, 1281, 1303, 1220, 1223, 1181, 1079, 1098, 981, 876, 824, 827, 696,
      640, 541, 510, 517, 500, 445, 403, 382, 374, 360, 374, 263, 292, 231, 241,
      199, 234, 207, 226, 204, 156, 152, 94, 93, 60, 60, 34, 30, 21, 21, 13, 10, 4,
      3, 3
    ),
    year = rep(2024, 404L),
    scen = rep("reference", 404L),
    spatial_unit = rep("Aargau", 404L),
    birthrate = rep(
      c(
        0, 0.000786, 0.001525, 0.003106, 0.005874, 0.010611, 0.01731, 0.026459,
        0.037882, 0.051065, 0.066655, 0.082599, 0.099543, 0.11384, 0.123888, 0.127307,
        0.121966, 0.108771, 0.090344, 0.070041, 0.050405, 0.034815, 0.022905,
        0.014548, 0.00941, 0.006123, 0.003948, 0.002777, 0.001967, 0.00127, 0.001205,
        0.000939, 0, 0.001146, 0.005, 0.010856, 0.018645, 0.029318, 0.040665,
        0.053519, 0.067371, 0.082407, 0.097902, 0.110989, 0.126001, 0.135507,
        0.141002, 0.141603, 0.136799, 0.127822, 0.115256, 0.100284, 0.084536,
        0.069715, 0.055096, 0.04232, 0.031369, 0.022854, 0.016109, 0.01098, 0.006943,
        0.004665, 0.002817, 0.001224, 0.000648, 0.000638, 0
      ),
      rep(c(120L, 1L, 169L, 1L, 51L), c(1L, 31L, 1L, 33L, 1L))
    ),
    int_mothers = rep(0.24983410749834106, 404L),
    mor = c(
      0.003628, 0.000415, 0.000389, 0.000343, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.000358, 0.000373, 0.000362, 0.000362, 0.000362, 0.000367, 0.000372,
      0.000379, 0.000349, 0.000357, 0.000349, 0.000346, 0.000328, 0.000354, 0.00035,
      0.000646, 0.000623, 0.000627, 0.000621, 0.000621, 0.00062, 0.000626, 0.000608,
      0.000633, 0.000605, 0.000609, 0.000903, 0.000911, 0.000907, 0.000952,
      0.001286, 0.001288, 0.001357, 0.001653, 0.00187, 0.00215, 0.002068, 0.002523,
      0.00269, 0.003172, 0.003469, 0.003891, 0.004107, 0.004486, 0.005131, 0.005402,
      0.005937, 0.006391, 0.006998, 0.007502, 0.00813, 0.008781, 0.009461, 0.010567,
      0.011466, 0.012435, 0.013969, 0.01553, 0.017222, 0.0196, 0.022468, 0.025765,
      0.029516, 0.034283, 0.039716, 0.0455, 0.053061, 0.061054, 0.070598, 0.08,
      0.092149, 0.103825, 0.116622, 0.129267, 0.141277, 0.152466, 0.164313,
      0.182119, 0.200855, 0.228013, 0.254237, 0.28, 0.314286, 0.333333, 0.394737,
      0.002957, 0.000433, 0.000407, 0.000369, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0.000376, 0.000362, 0.000368, 0.000352, 0.000349,
      0.000346, 0.000339, 0.000339, 0.000312, 0.000313, 0.000303, 0.000314,
      0.000303, 0.000306, 0.000305, 0.000311, 0.000603, 0.000606, 0.000588,
      0.000583, 0.000607, 0.000617, 0.000655, 0.000952, 0.000903, 0.001252,
      0.001249, 0.00123, 0.001462, 0.001606, 0.001807, 0.002045, 0.002135, 0.002376,
      0.002553, 0.002798, 0.003181, 0.003489, 0.00386, 0.004192, 0.004563, 0.005067,
      0.005627, 0.00592, 0.006528, 0.0073, 0.007949, 0.00884, 0.009802, 0.010855,
      0.012154, 0.013641, 0.015482, 0.01733, 0.019806, 0.022647, 0.025932, 0.029788,
      0.034803, 0.040631, 0.046994, 0.055252, 0.064921, 0.076078, 0.089718,
      0.103774, 0.120531, 0.137546, 0.155556, 0.174844, 0.19641, 0.216931, 0.240838,
      0.265356, 0.283784, 0.309278, 0.362416, 0.003417, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0.000935, 0.001049, 0.00093, 0.000929, 0.001011, 0.001056,
      0.001005, 0.000973, 0.000827, 0.000779, 0.000699, 0.000636, 0.000592,
      0.000589, 0.000548, 0.000512, 0.000498, 0.00047, 0.000441, 0.000451, 0.000457,
      0.00043, 0.00044, 0.00044, 0.000428, 0.000896, 0.000883, 0.000892, 0.000917,
      0.000956, 0.000974, 0.001036, 0.001063, 0.00168, 0.001735, 0.001775, 0.001771,
      0.001885, 0.001947, 0.002555, 0.002627, 0.00263, 0.003351, 0.003362, 0.004287,
      0.004752, 0.005352, 0.005961, 0.007085, 0.0076, 0.00953, 0.009646, 0.011895,
      0.012411, 0.014213, 0.016355, 0.017456, 0.020202, 0.020525, 0.022504, 0.02449,
      0.025641, 0.029126, 0.029046, 0.0322, 0.034221, 0.036563, 0.043269, 0.047009,
      0.054455, 0.066066, 0.075949, 0.089069, 0.116402, 0.137931, 0.195122,
      0.210526, 0.277778, 0.272727, 0.3125, 0.285714, 0.333333, 0, 0, 1, 0.002676,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.000822, 0.00073, 0.000696, 0.000639, 0.000618, 0.000585, 0.000547, 0.000544,
      0.000514, 0.000517, 0.000506, 0.000505, 0.000501, 0.000498, 0.000506,
      0.000508, 0.000503, 0.000523, 0.000534, 0.000583, 0.000563, 0.000612,
      0.000647, 0.001276, 0.001345, 0.001434, 0.00135, 0.001437, 0.001559, 0.002304,
      0.002463, 0.002465, 0.002559, 0.002808, 0.002766, 0.003094, 0.003464,
      0.003686, 0.004914, 0.004342, 0.004717, 0.005566, 0.005894, 0.007759,
      0.008032, 0.009019, 0.00995, 0.010471, 0.01071, 0.013908, 0.013387, 0.015209,
      0.017153, 0.021692, 0.024948, 0.025126, 0.029979, 0.033816, 0.044346, 0.0489,
      0.057692, 0.072607, 0.085106, 0.096774, 0.116667, 0.133333, 0.147059,
      0.169492, 0.190476, 0.190476, 0.230769, 0.3, 0.25, 0.333333, 0.333333
    ),
    emi_int = c(
      0.001218, 0.004649, 0.004327, 0.004151, 0.003977, 0.003579, 0.003595,
      0.003229, 0.002935, 0.00282, 0.002442, 0.002174, 0.001808, 0.001786, 0.001417,
      0.001478, 0.001445, 0.00188, 0.002551, 0.003261, 0.003975, 0.004396, 0.00484,
      0.005305, 0.005919, 0.006046, 0.005915, 0.005864, 0.005882, 0.005313,
      0.005274, 0.004862, 0.004704, 0.004428, 0.004386, 0.004385, 0.004066,
      0.003793, 0.003679, 0.003514, 0.003354, 0.003371, 0.00303, 0.003059, 0.003041,
      0.002874, 0.002912, 0.002592, 0.002729, 0.00266, 0.002818, 0.002776, 0.002966,
      0.003094, 0.003237, 0.003446, 0.003972, 0.00414, 0.004355, 0.004727, 0.0049,
      0.004668, 0.004454, 0.003836, 0.003767, 0.005819, 0.004647, 0.003513,
      0.003357, 0.003107, 0.00262, 0.002351, 0.002094, 0.001893, 0.001497, 0.001567,
      0.001162, 0.001207, 0.000831, 0.00089, 0.000946, 0.001, 0.000583, 0.000643,
      0.000831, 0.000909, 0.00094, 0.001093, 0.00134, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0.002559, 0.004831, 0.00493, 0.004469, 0.004343, 0.004269, 0.00345,
      0.00337, 0.003008, 0.00265, 0.002309, 0.002326, 0.001885, 0.001538, 0.001448,
      0.00155, 0.001491, 0.001962, 0.00234, 0.002771, 0.003447, 0.004282, 0.0047,
      0.005102, 0.005637, 0.005423, 0.005509, 0.005624, 0.005234, 0.005189,
      0.004752, 0.004768, 0.004394, 0.004098, 0.003978, 0.003811, 0.003673,
      0.003397, 0.003086, 0.002827, 0.002737, 0.002751, 0.002667, 0.002641,
      0.002445, 0.002481, 0.002637, 0.00255, 0.00272, 0.002827, 0.002821, 0.003085,
      0.003519, 0.003488, 0.00362, 0.003585, 0.003562, 0.003565, 0.003483, 0.003266,
      0.003183, 0.003025, 0.003138, 0.00296, 0.003292, 0.002399, 0.002144, 0.001615,
      0.001135, 0.000876, 0.000917, 0.000631, 0.000632, 0.000678, 0.000675,
      0.000699, 0.00072, 0.000369, 0.000374, 0.00039, 0.000405, 0.000419, 0.000477,
      0.000535, 0.000611, 0.000643, 0.000698, 0.000784, 0.000794, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0.007772, 0.036957, 0.03125, 0.026793, 0.021988, 0.019845,
      0.017662, 0.014873, 0.013029, 0.010705, 0.010327, 0.008985, 0.008651,
      0.007233, 0.006972, 0.006, 0.006512, 0.006289, 0.010223, 0.014098, 0.018595,
      0.025027, 0.029167, 0.034483, 0.037005, 0.03818, 0.039187, 0.036915, 0.037309,
      0.03602, 0.035048, 0.033702, 0.03272, 0.0317, 0.030548, 0.02983, 0.029316,
      0.027911, 0.027629, 0.02669, 0.026282, 0.025271, 0.024845, 0.02415, 0.024357,
      0.023, 0.022428, 0.021784, 0.021299, 0.02074, 0.019699, 0.020118, 0.019481,
      0.019472, 0.020104, 0.021019, 0.022237, 0.024804, 0.02656, 0.025316, 0.028269,
      0.021226, 0.025618, 0.033301, 0.043651, 0.073439, 0.054449, 0.023885,
      0.015203, 0.014109, 0.012121, 0.011628, 0.012407, 0.012563, 0.011338,
      0.011204, 0.01084, 0.009585, 0.009677, 0.008264, 0.007117, 0.003788, 0.007273,
      0.004808, 0.004274, 0.00495, 0.005988, 0.008403, 0.008065, 0.010526, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0.003626, 0.028953, 0.026694, 0.025455, 0.023581,
      0.021024, 0.018605, 0.017159, 0.014184, 0.013158, 0.011938, 0.01173, 0.01155,
      0.010718, 0.010753, 0.011482, 0.01087, 0.011312, 0.013614, 0.014423, 0.015038,
      0.018277, 0.019231, 0.022005, 0.024262, 0.026265, 0.026678, 0.025816,
      0.025326, 0.026403, 0.026098, 0.025779, 0.024554, 0.023783, 0.022408,
      0.021432, 0.019918, 0.01882, 0.01712, 0.016484, 0.015213, 0.014751, 0.013595,
      0.013075, 0.01228, 0.012252, 0.011824, 0.011628, 0.011025, 0.010842, 0.010774,
      0.010057, 0.010128, 0.010072, 0.010929, 0.013047, 0.015574, 0.018806,
      0.022862, 0.026877, 0.030965, 0.029562, 0.02968, 0.03034, 0.038694, 0.022989,
      0.021875, 0.016636, 0.013725, 0.01354, 0.012, 0.011236, 0.012407, 0.010471,
      0.010695, 0.011111, 0.010695, 0.011407, 0.013699, 0.012987, 0.012448, 0.01005,
      0.012821, 0.009662, 0.013274, 0.009804, 0.012821, 0.013158, 0.010638,
      0.010753, 0.016667, 0.016667, 0.029412, 0.033333, 0, 0, 0, 0, 0, 0, 0
    ),
    emi_nat = c(
      0.008526, 0.02071, 0.02203, 0.018679, 0.015907, 0.013601, 0.011862, 0.010405,
      0.008804, 0.007755, 0.006978, 0.006159, 0.005423, 0.004645, 0.004251,
      0.004064, 0.003974, 0.005263, 0.008382, 0.013043, 0.01807, 0.024176, 0.030901,
      0.038272, 0.045613, 0.05192, 0.056019, 0.057951, 0.057516, 0.054906, 0.051336,
      0.047002, 0.042333, 0.037951, 0.033835, 0.030379, 0.027213, 0.024652,
      0.022379, 0.020447, 0.018902, 0.017775, 0.016364, 0.015601, 0.014599,
      0.014053, 0.013264, 0.012634, 0.012282, 0.011636, 0.011271, 0.010796,
      0.010383, 0.010127, 0.009711, 0.009276, 0.008937, 0.008768, 0.008468,
      0.008036, 0.007933, 0.007617, 0.007424, 0.007161, 0.00915, 0.012746, 0.00639,
      0.00644, 0.006103, 0.005902, 0.005894, 0.00571, 0.005585, 0.005301, 0.00524,
      0.005094, 0.005035, 0.004829, 0.004572, 0.004452, 0.004255, 0.004498,
      0.004082, 0.003856, 0.004153, 0.003636, 0.003759, 0.003279, 0.004021,
      0.002907, 0.003407, 0.004484, 0.002571, 0.003311, 0.004274, 0, 0, 0, 0, 0, 0,
      0.009382, 0.028107, 0.023007, 0.018994, 0.015792, 0.013194, 0.011115, 0.00936,
      0.008271, 0.007192, 0.006541, 0.005814, 0.005654, 0.005385, 0.005429,
      0.005424, 0.006336, 0.008239, 0.01209, 0.018606, 0.027959, 0.038926, 0.05092,
      0.061617, 0.069899, 0.074837, 0.076019, 0.074165, 0.069784, 0.063646,
      0.057026, 0.049728, 0.043315, 0.037201, 0.031824, 0.027628, 0.023875,
      0.021001, 0.018519, 0.016646, 0.015511, 0.014364, 0.013333, 0.012617,
      0.012225, 0.011787, 0.011536, 0.011157, 0.010879, 0.010678, 0.010345,
      0.010179, 0.009971, 0.009928, 0.009827, 0.009475, 0.009261, 0.009033,
      0.008823, 0.008631, 0.008411, 0.008378, 0.007965, 0.007893, 0.009876,
      0.009064, 0.007235, 0.006997, 0.00681, 0.006423, 0.006418, 0.005997, 0.005691,
      0.005765, 0.0054, 0.005245, 0.00504, 0.004794, 0.004484, 0.004295, 0.004052,
      0.004195, 0.003815, 0.003743, 0.003663, 0.003213, 0.002793, 0.003137,
      0.002383, 0.002833, 0.002045, 0.002481, 0.001391, 0.001786, 0.002114,
      0.002646, 0, 0, 0, 0, 0, 0.005181, 0.023913, 0.021429, 0.019879, 0.01759,
      0.015531, 0.014298, 0.012248, 0.011401, 0.009813, 0.008606, 0.008086, 0.00692,
      0.006329, 0.00498, 0.005, 0.004651, 0.006289, 0.010223, 0.016917, 0.025826,
      0.03482, 0.044792, 0.052738, 0.05852, 0.062551, 0.064586, 0.06526, 0.06422,
      0.062271, 0.059921, 0.056872, 0.054192, 0.050913, 0.048068, 0.044975,
      0.042345, 0.039686, 0.037879, 0.035587, 0.034037, 0.032942, 0.0315, 0.030859,
      0.029871, 0.029229, 0.028279, 0.02749, 0.027157, 0.026345, 0.025492, 0.024852,
      0.023613, 0.022613, 0.021401, 0.020382, 0.019621, 0.018277, 0.017264,
      0.015989, 0.014841, 0.013365, 0.012367, 0.011753, 0.010913, 0.011016,
      0.010624, 0.009554, 0.008446, 0.007055, 0.006061, 0.006977, 0.004963,
      0.005025, 0.004535, 0.002801, 0.00271, 0.003195, 0.003226, 0.004132, 0.003559,
      0.003788, 0.003636, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.003626, 0.024499, 0.021561, 0.019091, 0.017467, 0.015539, 0.013953,
      0.012393, 0.011525, 0.010338, 0.009183, 0.00782, 0.0077, 0.006431, 0.005865,
      0.005219, 0.005435, 0.007919, 0.013614, 0.02524, 0.038847, 0.050914, 0.060256,
      0.066015, 0.068565, 0.067121, 0.065404, 0.061503, 0.057164, 0.052805,
      0.048377, 0.044365, 0.040737, 0.037058, 0.033872, 0.030842, 0.028601,
      0.025941, 0.024169, 0.022478, 0.021298, 0.019837, 0.019134, 0.018305,
      0.018153, 0.017503, 0.017455, 0.017136, 0.016861, 0.017219, 0.016835,
      0.016523, 0.01688, 0.016547, 0.015613, 0.015349, 0.014754, 0.014718, 0.013548,
      0.012975, 0.01184, 0.011213, 0.010274, 0.008495, 0.007255, 0.005747, 0.004688,
      0.003697, 0.003922, 0.003868, 0.004, 0.004494, 0.002481, 0.002618, 0.002674,
      0.002778, 0.002674, 0.003802, 0.003425, 0.004329, 0.004149, 0.005025,
      0.004274, 0.004831, 0.004425, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    acq = rep(
      c(
        0, 0.011957, 0.014286, 0.014693, 0.014952, 0.015531, 0.016821, 0.016623,
        0.019544, 0.022302, 0.024957, 0.028751, 0.033737, 0.037975, 0.041833, 0.045,
        0.046512, 0.045073, 0.040892, 0.020677, 0.017562, 0.016322, 0.014583,
        0.013185, 0.011188, 0.009748, 0.008708, 0.00791, 0.007339, 0.007326, 0.006783,
        0.007372, 0.007669, 0.008165, 0.008985, 0.010096, 0.010703, 0.011339,
        0.012032, 0.013345, 0.013356, 0.013538, 0.014197, 0.014311, 0.014706,
        0.014375, 0.014139, 0.014523, 0.013312, 0.013453, 0.012746, 0.012426,
        0.011806, 0.011307, 0.011025, 0.010191, 0.00981, 0.009138, 0.009296, 0.008661,
        0.007774, 0.007075, 0.007067, 0.006856, 0.005952, 0.00612, 0.005312, 0.004777,
        0.005068, 0.003527, 0.00404, 0.004651, 0.002481, 0.002513, 0.002268, 0.002801,
        0.00271, 0.003195, 0.003226, 0.004132, 0.003559, 0.003788, 0.003636, 0,
        0.020045, 0.019507, 0.017273, 0.015721, 0.015539, 0.015814, 0.017159,
        0.018617, 0.021617, 0.024793, 0.029326, 0.033686, 0.038585, 0.044966,
        0.049061, 0.051087, 0.050905, 0.045792, 0.038462, 0.033835, 0.028721,
        0.024359, 0.020782, 0.017932, 0.015564, 0.012048, 0.01063, 0.008683, 0.008581,
        0.008912, 0.009592, 0.010603, 0.012721, 0.013549, 0.015159, 0.015322,
        0.016277, 0.01712, 0.017483, 0.018256, 0.018311, 0.018127, 0.017782, 0.017619,
        0.017503, 0.016892, 0.016524, 0.015564, 0.015306, 0.014141, 0.013649,
        0.012829, 0.01223, 0.01171, 0.010744, 0.009016, 0.008177, 0.007621, 0.007414,
        0.006375, 0.006116, 0.005708, 0.004854, 0.003628, 0.00431, 0.003125, 0.003697,
        0.001961, 0.001934, 0.002, 0.002247, 0.002481, 0
      ),
      rep(c(203L, 1L, 19L, 1L, 28L), c(1L, 82L, 1L, 72L, 1L))
    ),
    imm_int_n = c(
      4, 48, 17, 15, 14, 14, 14, 13, 12, 11, 10, 9, 8, 7, 6, 6, 5, 5, 5, 6, 8, 9,
      11, 12, 13, 14, 14, 14, 14, 13, 13, 13, 13, 13, 13, 13, 13, 12, 12, 12, 11,
      11, 10, 10, 9, 9, 8, 8, 8, 8, 9, 9, 10, 11, 11, 12, 12, 11, 11, 11, 10, 9, 9,
      9, 8, 7, 7, 7, 6, 6, 6, 5, 5, 5, 4, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1,
      1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 44, 14, 13, 13, 12, 11, 10, 9, 8, 8, 7,
      6, 6, 6, 6, 6, 7, 6, 6, 7, 8, 9, 9, 10, 11, 12, 13, 13, 13, 13, 13, 14, 14,
      13, 13, 12, 12, 12, 11, 11, 10, 9, 8, 8, 7, 7, 7, 6, 6, 6, 7, 7, 7, 7, 7, 6,
      6, 6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 4, 4, 4, 4, 3, 3, 3, 3, 3, 2, 2, 2, 2,
      2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 14, 113, 53, 50, 49, 47,
      46, 46, 45, 44, 44, 44, 43, 42, 40, 38, 38, 40, 47, 58, 72, 89, 107, 123, 138,
      149, 157, 162, 164, 163, 162, 158, 153, 147, 140, 134, 127, 120, 114, 107,
      101, 95, 90, 85, 80, 75, 71, 67, 64, 60, 57, 53, 50, 46, 43, 38, 34, 29, 25,
      22, 19, 16, 13, 11, 9, 8, 7, 6, 5, 4, 3, 3, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 122, 53, 50, 48, 46,
      45, 44, 42, 41, 40, 40, 38, 37, 35, 33, 31, 30, 30, 37, 51, 71, 93, 112, 125,
      134, 138, 138, 135, 130, 124, 118, 111, 105, 98, 92, 86, 81, 76, 71, 66, 63,
      59, 55, 52, 49, 47, 44, 42, 40, 38, 36, 34, 32, 29, 27, 23, 21, 18, 15, 13,
      12, 10, 8, 7, 6, 5, 5, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
      1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    imm_nat_n = c(
      47, 88, 88, 79, 62, 49, 41, 35, 30, 26, 23, 21, 19, 17, 17, 16, 16, 17, 19,
      25, 34, 49, 69, 89, 110, 119, 130, 141, 151, 153, 158, 159, 160, 156, 147,
      135, 123, 110, 101, 91, 84, 75, 69, 64, 59, 55, 50, 47, 44, 43, 44, 42, 43,
      41, 40, 40, 41, 40, 41, 38, 37, 37, 34, 31, 33, 35, 29, 25, 21, 18, 15, 14,
      13, 11, 11, 10, 10, 9, 8, 8, 7, 6, 5, 5, 4, 4, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1,
      0, 0, 0, 0, 0, 57, 81, 79, 75, 57, 47, 38, 32, 27, 23, 20, 17, 16, 14, 13, 12,
      14, 20, 32, 51, 73, 94, 115, 137, 168, 182, 189, 190, 190, 179, 171, 163, 157,
      145, 135, 122, 112, 99, 92, 83, 75, 67, 62, 55, 51, 45, 41, 39, 38, 37, 38,
      39, 41, 43, 43, 44, 44, 42, 42, 42, 43, 41, 39, 37, 35, 33, 28, 25, 21, 18,
      17, 15, 14, 13, 13, 12, 12, 11, 10, 10, 9, 8, 8, 7, 6, 5, 5, 4, 4, 4, 3, 3, 2,
      1, 1, 1, 1, 1, 0, 0, 0, 20, 28, 29, 29, 25, 23, 22, 21, 19, 18, 17, 15, 13,
      12, 12, 12, 12, 14, 18, 23, 31, 37, 48, 60, 79, 91, 103, 116, 122, 127, 132,
      136, 137, 135, 135, 132, 130, 121, 116, 111, 103, 96, 91, 84, 81, 73, 68, 62,
      58, 52, 49, 44, 42, 38, 36, 34, 32, 29, 27, 25, 22, 18, 16, 13, 12, 11, 9, 6,
      5, 4, 3, 3, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 19, 33, 33, 31, 27, 23, 21, 18, 16, 14, 12, 11, 9, 8, 7,
      6, 7, 9, 13, 22, 32, 41, 51, 60, 73, 82, 91, 97, 101, 103, 100, 98, 97, 90,
      86, 81, 75, 67, 62, 56, 52, 48, 44, 41, 38, 35, 34, 32, 30, 28, 27, 26, 25,
      25, 23, 22, 21, 18, 17, 15, 14, 11, 10, 8, 8, 7, 6, 4, 4, 3, 2, 2, 2, 2, 2, 2,
      2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    emi_nat_n = c(
      21, 49, 56, 54, 44, 38, 33, 29, 24, 22, 20, 17, 15, 13, 12, 11, 11, 14, 23,
      36, 50, 66, 83, 101, 131, 146, 161, 168, 176, 155, 146, 145, 135, 120, 108,
      97, 87, 78, 73, 64, 62, 58, 54, 51, 48, 44, 41, 39, 36, 35, 36, 35, 35, 36,
      36, 35, 36, 36, 35, 34, 34, 31, 30, 28, 34, 46, 22, 22, 20, 19, 18, 17, 16,
      14, 14, 13, 13, 12, 11, 10, 9, 9, 7, 6, 5, 4, 4, 3, 3, 2, 2, 2, 1, 1, 1, 0, 0,
      0, 0, 0, 0, 22, 64, 56, 51, 40, 34, 29, 25, 22, 19, 17, 15, 15, 14, 15, 14,
      17, 21, 31, 47, 73, 100, 130, 157, 186, 207, 207, 211, 200, 184, 168, 146,
      138, 118, 104, 87, 78, 68, 60, 53, 51, 47, 45, 43, 40, 38, 35, 35, 36, 34, 33,
      33, 34, 37, 38, 37, 39, 38, 38, 37, 37, 36, 33, 32, 39, 34, 27, 26, 24, 22,
      21, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 10, 8, 7, 6, 5, 4, 4, 3, 3, 2, 2,
      1, 1, 1, 1, 0, 0, 0, 0, 0, 6, 22, 24, 23, 20, 18, 17, 14, 14, 11, 10, 9, 8, 7,
      5, 5, 5, 6, 11, 18, 25, 32, 43, 52, 68, 77, 89, 99, 105, 102, 106, 108, 106,
      106, 107, 98, 91, 91, 85, 80, 79, 73, 71, 69, 65, 61, 58, 53, 51, 47, 44, 42,
      40, 36, 33, 32, 30, 28, 26, 24, 21, 17, 14, 12, 11, 9, 8, 6, 5, 4, 3, 3, 2, 2,
      2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 4, 22, 21, 21, 20, 17, 15, 13, 13, 11, 10, 8, 8, 6, 6, 5, 5, 7, 11, 21, 31,
      39, 47, 54, 65, 69, 76, 81, 79, 80, 76, 74, 73, 67, 65, 59, 56, 51, 48, 45,
      42, 39, 38, 35, 34, 30, 31, 28, 26, 27, 25, 23, 25, 23, 20, 20, 18, 18, 16,
      14, 13, 11, 9, 7, 6, 4, 3, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    mig_nat_n = c(
      26, 39, 32, 25, 18, 11, 8, 6, 6, 4, 3, 4, 4, 4, 5, 5, 5, 3, -4, -11, -16, -17,
      -14, -12, -21, -27, -31, -27, -25, -2, 12, 14, 25, 36, 39, 38, 36, 32, 28, 27,
      22, 17, 15, 13, 11, 11, 9, 8, 8, 8, 8, 7, 8, 5, 4, 5, 5, 4, 6, 4, 3, 6, 4, 3,
      -1, -11, 7, 3, 1, -1, -3, -3, -3, -3, -3, -3, -3, -3, -3, -2, -2, -3, -2, -1,
      -1, 0, -1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 35, 17, 23, 24, 17, 13,
      9, 7, 5, 4, 3, 2, 1, 0, -2, -2, -3, -1, 1, 4, 0, -6, -15, -20, -18, -25, -18,
      -21, -10, -5, 3, 17, 19, 27, 31, 35, 34, 31, 32, 30, 24, 20, 17, 12, 11, 7, 6,
      4, 2, 3, 5, 6, 7, 6, 5, 7, 5, 4, 4, 5, 6, 5, 6, 5, -4, -1, 1, -1, -3, -4, -4,
      -4, -4, -4, -3, -3, -2, -2, -2, -1, -1, -2, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1,
      0, 0, 0, 1, 1, 0, 0, 0, 14, 6, 5, 6, 5, 5, 5, 7, 5, 7, 7, 6, 5, 5, 7, 7, 7, 8,
      7, 5, 6, 5, 5, 8, 11, 14, 14, 17, 17, 25, 26, 28, 31, 29, 28, 34, 39, 30, 31,
      31, 24, 23, 20, 15, 16, 12, 10, 9, 7, 5, 5, 2, 2, 2, 3, 2, 2, 1, 1, 1, 1, 1,
      2, 1, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 11, 12, 10, 7, 6, 6, 5, 3, 3, 2, 3,
      1, 2, 1, 1, 2, 2, 2, 1, 1, 2, 4, 6, 8, 13, 15, 16, 22, 23, 24, 24, 24, 23, 21,
      22, 19, 16, 14, 11, 10, 9, 6, 6, 4, 5, 3, 4, 4, 1, 2, 3, 0, 2, 3, 2, 3, 0, 1,
      1, 1, 0, 1, 1, 2, 3, 3, 2, 2, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0,
      1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    fso_projection_n = c(
      2481, 2452, 2595, 2935, 2804, 2827, 2814, 2816, 2760, 2869, 2901, 2799, 2812,
      2847, 2872, 2759, 2823, 2705, 2781, 2767, 2764, 2724, 2683, 2637, 2859, 2793,
      2851, 2880, 3042, 2830, 2865, 3109, 3225, 3212, 3248, 3250, 3254, 3220, 3315,
      3186, 3331, 3308, 3344, 3311, 3327, 3169, 3124, 3119, 2960, 3035, 3218, 3263,
      3392, 3569, 3717, 3781, 4030, 4102, 4129, 4220, 4267, 4053, 4020, 3889, 3689,
      3562, 3417, 3387, 3245, 3182, 3016, 2937, 2822, 2598, 2624, 2500, 2523, 2419,
      2334, 2169, 2031, 1908, 1624, 1461, 1119, 1012, 965, 820, 659, 600, 505, 378,
      326, 247, 187, 119, 88, 54, 24, 22, 23, 2371, 2344, 2477, 2728, 2570, 2608,
      2637, 2697, 2687, 2670, 2631, 2613, 2690, 2638, 2809, 2628, 2729, 2595, 2602,
      2561, 2636, 2582, 2554, 2541, 2654, 2752, 2715, 2834, 2865, 2896, 2961, 2967,
      3223, 3222, 3324, 3213, 3330, 3301, 3307, 3250, 3348, 3327, 3426, 3451, 3314,
      3258, 3067, 3164, 3329, 3204, 3209, 3260, 3426, 3738, 3873, 3911, 4209, 4202,
      4300, 4280, 4390, 4286, 4131, 4040, 3922, 3730, 3711, 3694, 3500, 3399, 3244,
      3139, 3131, 2915, 2925, 2819, 2734, 2665, 2623, 2503, 2404, 2312, 2025, 1795,
      1562, 1471, 1340, 1178, 1147, 951, 862, 697, 609, 463, 381, 296, 218, 150,
      106, 67, 95, 1173, 994, 1127, 1165, 1149, 1170, 1199, 1160, 1238, 1135, 1172,
      1121, 1155, 1103, 1002, 994, 1062, 952, 1074, 1089, 1010, 974, 1029, 1069,
      1254, 1334, 1482, 1627, 1742, 1754, 1882, 2006, 2060, 2174, 2305, 2259, 2228,
      2352, 2299, 2295, 2353, 2246, 2274, 2248, 2185, 2094, 2055, 1932, 1882, 1785,
      1729, 1687, 1690, 1588, 1537, 1557, 1512, 1506, 1473, 1468, 1378, 1247, 1104,
      986, 961, 756, 709, 610, 578, 554, 483, 419, 392, 386, 427, 346, 357, 303,
      299, 233, 269, 253, 262, 199, 223, 191, 155, 109, 112, 83, 50, 33, 15, 13, 8,
      11, 5, 2, 0, 0, 0, 1127, 987, 994, 1113, 1155, 1106, 1089, 1062, 1136, 1071,
      1091, 1024, 1031, 926, 1002, 934, 896, 861, 792, 826, 811, 803, 843, 901,
      1041, 1132, 1269, 1422, 1491, 1614, 1663, 1750, 1863, 1869, 1968, 1956, 1993,
      1993, 2007, 2015, 1981, 1972, 1987, 1913, 1872, 1716, 1774, 1635, 1546, 1566,
      1486, 1396, 1479, 1391, 1282, 1298, 1213, 1208, 1161, 1055, 1068, 955, 853,
      801, 797, 683, 629, 534, 505, 510, 492, 438, 397, 378, 369, 354, 368, 259,
      286, 225, 234, 194, 226, 200, 215, 195, 147, 140, 86, 84, 53, 52, 29, 24, 17,
      17, 10, 7, 3, 2, 2
    ),
  )

  ## FSO population ----
  # fso_population |>
  #   constructive::construct()
  population_short_1r <- tibble::tibble(
    year = rep(2023, 404L),
    spatial_unit = rep("Aargau", 404L),
    nat = rep(c("ch", "int"), each = 202L),
    sex = rep(rep(c("m", "f"), 2), each = 101L),
    age = rep(seq(0, 100, by = 1), 4),
    n_dec = c(
      2371, 2542, 2891, 2766, 2794, 2782, 2787, 2726, 2837, 2866, 2760, 2766, 2799,
      2823, 2707, 2768, 2660, 2744, 2759, 2767, 2730, 2686, 2639, 2872, 2812, 2874,
      2899, 3060, 2823, 2844, 3085, 3189, 3162, 3192, 3193, 3197, 3164, 3262, 3130,
      3280, 3263, 3300, 3269, 3288, 3131, 3091, 3087, 2931, 3008, 3194, 3242, 3371,
      3555, 3707, 3773, 4028, 4106, 4133, 4231, 4286, 4070, 4041, 3910, 3716, 3609,
      3443, 3416, 3277, 3219, 3054, 2977, 2865, 2641, 2672, 2552, 2582, 2485, 2406,
      2246, 2114, 2001, 1715, 1556, 1204, 1100, 1064, 915, 746, 688, 587, 446, 389,
      302, 234, 153, 118, 75, 35, 33, 15, 23, 2286, 2434, 2685, 2533, 2577, 2609,
      2671, 2660, 2642, 2599, 2580, 2653, 2600, 2763, 2581, 2683, 2549, 2564, 2527,
      2611, 2569, 2553, 2548, 2662, 2766, 2723, 2845, 2866, 2891, 2946, 2936, 3186,
      3172, 3268, 3149, 3267, 3238, 3240, 3184, 3288, 3272, 3375, 3408, 3272, 3224,
      3034, 3137, 3309, 3184, 3190, 3242, 3410, 3727, 3867, 3905, 4211, 4207, 4307,
      4287, 4399, 4297, 4143, 4054, 3949, 3751, 3732, 3716, 3524, 3425, 3272, 3168,
      3163, 2949, 2963, 2860, 2778, 2712, 2676, 2561, 2468, 2384, 2097, 1870, 1638,
      1556, 1432, 1275, 1259, 1059, 978, 806, 719, 560, 473, 378, 286, 203, 148, 97,
      67, 82, 945, 1123, 1157, 1137, 1159, 1189, 1143, 1228, 1121, 1162, 1113, 1156,
      1106, 1004, 1000, 1075, 954, 1076, 1064, 968, 919, 960, 986, 1162, 1231, 1378,
      1517, 1635, 1638, 1769, 1899, 1956, 2082, 2226, 2179, 2149, 2293, 2244, 2248,
      2321, 2216, 2253, 2236, 2176, 2086, 2051, 1928, 1879, 1784, 1726, 1690, 1694,
      1592, 1542, 1570, 1529, 1532, 1506, 1501, 1415, 1272, 1132, 1021, 1007, 817,
      753, 628, 592, 567, 495, 430, 403, 398, 440, 357, 369, 313, 310, 242, 281,
      263, 275, 208, 234, 202, 166, 118, 124, 95, 58, 41, 19, 18, 11, 16, 7, 3, 0,
      0, 0, 1, 928, 974, 1100, 1145, 1094, 1075, 1049, 1128, 1064, 1089, 1023, 1039,
      933, 1023, 958, 920, 884, 808, 832, 798, 766, 780, 818, 948, 1028, 1162, 1317,
      1382, 1515, 1571, 1668, 1792, 1808, 1919, 1913, 1958, 1966, 1986, 2002, 1973,
      1966, 1986, 1912, 1873, 1714, 1776, 1634, 1542, 1568, 1485, 1392, 1481, 1390,
      1281, 1303, 1220, 1223, 1181, 1079, 1098, 980, 876, 824, 827, 696, 640, 541,
      509, 517, 500, 445, 403, 382, 374, 360, 374, 263, 292, 230, 241, 199, 234,
      207, 226, 204, 156, 152, 93, 93, 60, 59, 34, 30, 21, 21, 13, 10, 4, 3, 1, 1
    ),
  )

  ## Run propop with 1 region ----
  output_propop_1r <- project_population(
    parameters = parameters_short_1r,
    fert_first = 16,
    fert_last = 50,
    share_born_female = 100 / 205,
    population = population_short_1r,
    binational = TRUE,
    subregional = FALSE
  ) |>
    filter(year == 2024)

  # Check if components add up
  balance_check <- check_balance(output_propop_1r)

  expect_equal(balance_check$nonzeros, 0,
    info =
      "The components don't add up in at least one row"
  )
  expect_equal(balance_check$missings, 0,
    info =
      "There are missings in at least one row"
  )

  # Run snapshot 1 region ----
  expect_snapshot(constructive::construct(output_propop_1r))



  # Prepare snapshot for 5 subregions -----

  ## FSO parameters with fictitious subregions ----
  # fso_parameters |>
  #   dplyr::filter(year == 2024 & scen == "reference") |>
  #   # Create fictitious intra-cantonal migration parameter
  #   dplyr::rowwise() |>
  #   dplyr::mutate(
  #     mig_sub_1 = {set.seed(1); round(rnorm(1, mean = 0, sd = 0.2), digits = 4)},
  #     mig_sub_2 = {set.seed(2);round(rnorm(1, mean = 0, sd = 0.2), digits = 4)},
  #     mig_sub_3 = {set.seed(3);round(rnorm(1, mean = 0, sd = 0.2), digits = 4)},
  #     mig_sub_4 = {set.seed(4);round(rnorm(1, mean = 0, sd = 0.2), digits = 4)},
  #     mig_sub_5 = 0 - sum(mig_sub_1, mig_sub_2,mig_sub_3,mig_sub_4)
  #     # check = sum(mig_sub_1, mig_sub_2,mig_sub_3,mig_sub_4,mig_sub_5)
  #   ) |>
  #   tidyr::pivot_longer(mig_sub_1:mig_sub_5,
  #                names_to = "subregion",
  #                values_to = "mig_sub") |>
  #   dplyr::mutate(spatial_unit = as.character(stringr::str_extract(subregion, "(?<=mig_sub_).*"))) |>
  #   # divide the size of parameters with numbers by the number of regions (=5),
  #   # otherwise the multiplication of lines inflates the size of the population
  #   dplyr::mutate_at(dplyr::vars(imm_int_n, imm_nat_n, emi_nat_n, mig_nat_n), ~ ./5) |>
  #   dplyr::select(-subregion) |>
  # constructive::construct()

  parameters_short_5r <- tibble::tibble(
    nat = rep(c("ch", "int"), each = 1010L),
    sex = rep(rep(c("m", "f"), 2), each = 505L),
    age = rep(rep(seq(0, 100, by = 1), 4), each = 5L),
    start_n = rep(
      c(
        0, 2366, 2542, 2891, 2766, 2794, 2782, 2787, 2726, 2837, 2866, 2760, 2766,
        2799, 2823, 2707, 2768, 2660, 2744, 2760, 2767, 2730, 2686, 2639, 2872, 2812,
        2874, 2899, 3060, 2823, 2844, 3085, 3189, 3162, 3192, 3193, 3197, 3164, 3262,
        3130, 3280, 3263, 3300, 3269, 3288, 3131, 3091, 3087, 2931, 3008, 3194, 3242,
        3371, 3555, 3707, 3773, 4028, 4106, 4133, 4231, 4286, 4070, 4041, 3910, 3716,
        3609, 3443, 3416, 3277, 3219, 3054, 2977, 2865, 2641, 2672, 2552, 2582, 2485,
        2406, 2246, 2115, 2001, 1715, 1556, 1204, 1100, 1064, 915, 746, 688, 587, 446,
        389, 302, 234, 153, 118, 75, 35, 33, 38, 0, 2277, 2434, 2685, 2533, 2577,
        2609, 2671, 2660, 2642, 2599, 2580, 2653, 2600, 2763, 2581, 2683, 2549, 2564,
        2526, 2611, 2569, 2553, 2548, 2661, 2766, 2723, 2845, 2866, 2891, 2946, 2936,
        3186, 3172, 3268, 3149, 3267, 3238, 3240, 3184, 3288, 3272, 3375, 3408, 3272,
        3224, 3034, 3137, 3309, 3184, 3190, 3242, 3410, 3727, 3867, 3905, 4211, 4207,
        4307, 4287, 4399, 4297, 4143, 4054, 3949, 3751, 3732, 3716, 3524, 3425, 3272,
        3168, 3163, 2949, 2963, 2860, 2778, 2712, 2676, 2561, 2468, 2384, 2097, 1870,
        1638, 1556, 1432, 1275, 1259, 1059, 978, 806, 719, 560, 473, 378, 286, 203,
        148, 97, 149, 0, 920, 1120, 1157, 1137, 1159, 1189, 1143, 1228, 1121, 1162,
        1113, 1156, 1106, 1004, 1000, 1075, 954, 1076, 1064, 968, 919, 960, 986, 1162,
        1231, 1378, 1517, 1635, 1638, 1769, 1899, 1956, 2082, 2226, 2179, 2149, 2293,
        2244, 2248, 2321, 2216, 2254, 2236, 2176, 2087, 2051, 1928, 1878, 1784, 1726,
        1690, 1694, 1592, 1542, 1570, 1529, 1532, 1506, 1501, 1415, 1272, 1132, 1021,
        1008, 817, 753, 628, 592, 567, 495, 430, 403, 398, 441, 357, 369, 313, 310,
        242, 281, 264, 275, 208, 234, 202, 167, 119, 124, 95, 58, 41, 19, 18, 11, 16,
        7, 3, 0, 1, 0, 898, 974, 1100, 1145, 1094, 1075, 1049, 1128, 1064, 1089, 1023,
        1039, 933, 1023, 958, 920, 884, 808, 832, 798, 766, 780, 818, 948, 1028, 1162,
        1317, 1382, 1515, 1571, 1668, 1792, 1808, 1919, 1913, 1958, 1966, 1986, 2002,
        1972, 1966, 1986, 1912, 1873, 1714, 1776, 1634, 1542, 1568, 1485, 1392, 1481,
        1390, 1281, 1303, 1220, 1223, 1181, 1079, 1098, 981, 876, 824, 827, 696, 640,
        541, 510, 517, 500, 445, 403, 382, 374, 360, 374, 263, 292, 231, 241, 199,
        234, 207, 226, 204, 156, 152, 94, 93, 60, 34, 30, 21, 13, 10, 4, 3
      ),
      rep(rep(c(5L, 10L), 4), c(300L, 1L, 91L, 1L, 2L, 1L, 3L, 1L))
    ),
    year = rep(2024, 2020L),
    scen = rep("reference", 2020L),
    spatial_unit = rep(c("1", "2", "3", "4", "5"), 404),
    birthrate = rep(
      c(
        0, 0.000786, 0.001525, 0.003106, 0.005874, 0.010611, 0.01731, 0.026459,
        0.037882, 0.051065, 0.066655, 0.082599, 0.099543, 0.11384, 0.123888, 0.127307,
        0.121966, 0.108771, 0.090344, 0.070041, 0.050405, 0.034815, 0.022905,
        0.014548, 0.00941, 0.006123, 0.003948, 0.002777, 0.001967, 0.00127, 0.001205,
        0.000939, 0, 0.001146, 0.005, 0.010856, 0.018645, 0.029318, 0.040665,
        0.053519, 0.067371, 0.082407, 0.097902, 0.110989, 0.126001, 0.135507,
        0.141002, 0.141603, 0.136799, 0.127822, 0.115256, 0.100284, 0.084536,
        0.069715, 0.055096, 0.04232, 0.031369, 0.022854, 0.016109, 0.01098, 0.006943,
        0.004665, 0.002817, 0.001224, 0.000648, 0.000638, 0
      ),
      rep(c(600L, 5L, 845L, 5L, 255L), c(1L, 31L, 1L, 33L, 1L))
    ),
    int_mothers = rep(0.24983410749834106, 2020L),
    mor = rep(
      c(
        0.003628, 0.000415, 0.000389, 0.000343, 0, 0.000358, 0.000373, 0.000362,
        0.000367, 0.000372, 0.000379, 0.000349, 0.000357, 0.000349, 0.000346,
        0.000328, 0.000354, 0.00035, 0.000646, 0.000623, 0.000627, 0.000621, 0.00062,
        0.000626, 0.000608, 0.000633, 0.000605, 0.000609, 0.000903, 0.000911,
        0.000907, 0.000952, 0.001286, 0.001288, 0.001357, 0.001653, 0.00187, 0.00215,
        0.002068, 0.002523, 0.00269, 0.003172, 0.003469, 0.003891, 0.004107, 0.004486,
        0.005131, 0.005402, 0.005937, 0.006391, 0.006998, 0.007502, 0.00813, 0.008781,
        0.009461, 0.010567, 0.011466, 0.012435, 0.013969, 0.01553, 0.017222, 0.0196,
        0.022468, 0.025765, 0.029516, 0.034283, 0.039716, 0.0455, 0.053061, 0.061054,
        0.070598, 0.08, 0.092149, 0.103825, 0.116622, 0.129267, 0.141277, 0.152466,
        0.164313, 0.182119, 0.200855, 0.228013, 0.254237, 0.28, 0.314286, 0.333333,
        0.394737, 0.002957, 0.000433, 0.000407, 0.000369, 0, 0.000376, 0.000362,
        0.000368, 0.000352, 0.000349, 0.000346, 0.000339, 0.000312, 0.000313,
        0.000303, 0.000314, 0.000303, 0.000306, 0.000305, 0.000311, 0.000603,
        0.000606, 0.000588, 0.000583, 0.000607, 0.000617, 0.000655, 0.000952,
        0.000903, 0.001252, 0.001249, 0.00123, 0.001462, 0.001606, 0.001807, 0.002045,
        0.002135, 0.002376, 0.002553, 0.002798, 0.003181, 0.003489, 0.00386, 0.004192,
        0.004563, 0.005067, 0.005627, 0.00592, 0.006528, 0.0073, 0.007949, 0.00884,
        0.009802, 0.010855, 0.012154, 0.013641, 0.015482, 0.01733, 0.019806, 0.022647,
        0.025932, 0.029788, 0.034803, 0.040631, 0.046994, 0.055252, 0.064921,
        0.076078, 0.089718, 0.103774, 0.120531, 0.137546, 0.155556, 0.174844, 0.19641,
        0.216931, 0.240838, 0.265356, 0.283784, 0.309278, 0.362416, 0.003417, 0,
        0.000935, 0.001049, 0.00093, 0.000929, 0.001011, 0.001056, 0.001005, 0.000973,
        0.000827, 0.000779, 0.000699, 0.000636, 0.000592, 0.000589, 0.000548,
        0.000512, 0.000498, 0.00047, 0.000441, 0.000451, 0.000457, 0.00043, 0.00044,
        0.000428, 0.000896, 0.000883, 0.000892, 0.000917, 0.000956, 0.000974,
        0.001036, 0.001063, 0.00168, 0.001735, 0.001775, 0.001771, 0.001885, 0.001947,
        0.002555, 0.002627, 0.00263, 0.003351, 0.003362, 0.004287, 0.004752, 0.005352,
        0.005961, 0.007085, 0.0076, 0.00953, 0.009646, 0.011895, 0.012411, 0.014213,
        0.016355, 0.017456, 0.020202, 0.020525, 0.022504, 0.02449, 0.025641, 0.029126,
        0.029046, 0.0322, 0.034221, 0.036563, 0.043269, 0.047009, 0.054455, 0.066066,
        0.075949, 0.089069, 0.116402, 0.137931, 0.195122, 0.210526, 0.277778,
        0.272727, 0.3125, 0.285714, 0.333333, 0, 1, 0.002676, 0, 0.000822, 0.00073,
        0.000696, 0.000639, 0.000618, 0.000585, 0.000547, 0.000544, 0.000514,
        0.000517, 0.000506, 0.000505, 0.000501, 0.000498, 0.000506, 0.000508,
        0.000503, 0.000523, 0.000534, 0.000583, 0.000563, 0.000612, 0.000647,
        0.001276, 0.001345, 0.001434, 0.00135, 0.001437, 0.001559, 0.002304, 0.002463,
        0.002465, 0.002559, 0.002808, 0.002766, 0.003094, 0.003464, 0.003686,
        0.004914, 0.004342, 0.004717, 0.005566, 0.005894, 0.007759, 0.008032,
        0.009019, 0.00995, 0.010471, 0.01071, 0.013908, 0.013387, 0.015209, 0.017153,
        0.021692, 0.024948, 0.025126, 0.029979, 0.033816, 0.044346, 0.0489, 0.057692,
        0.072607, 0.085106, 0.096774, 0.116667, 0.133333, 0.147059, 0.169492,
        0.190476, 0.230769, 0.3, 0.25, 0.333333
      ),
      rep(
        c(5L, 60L, 5L, 15L, 5L, 10L, 5L, 100L, 5L, 10L, 5L, 75L, 5L, 10L, 5L, 10L, 5L, 125L, 5L, 10L, 5L, 10L),
        c(4L, 1L, 2L, 1L, 13L, 1L, 69L, 1L, 6L, 1L, 70L, 1L, 22L, 1L, 58L, 1L, 2L, 1L, 68L, 1L, 3L, 1L)
      )
    ),
    emi_int = rep(
      c(
        0.001218, 0.004649, 0.004327, 0.004151, 0.003977, 0.003579, 0.003595,
        0.003229, 0.002935, 0.00282, 0.002442, 0.002174, 0.001808, 0.001786, 0.001417,
        0.001478, 0.001445, 0.00188, 0.002551, 0.003261, 0.003975, 0.004396, 0.00484,
        0.005305, 0.005919, 0.006046, 0.005915, 0.005864, 0.005882, 0.005313,
        0.005274, 0.004862, 0.004704, 0.004428, 0.004386, 0.004385, 0.004066,
        0.003793, 0.003679, 0.003514, 0.003354, 0.003371, 0.00303, 0.003059, 0.003041,
        0.002874, 0.002912, 0.002592, 0.002729, 0.00266, 0.002818, 0.002776, 0.002966,
        0.003094, 0.003237, 0.003446, 0.003972, 0.00414, 0.004355, 0.004727, 0.0049,
        0.004668, 0.004454, 0.003836, 0.003767, 0.005819, 0.004647, 0.003513,
        0.003357, 0.003107, 0.00262, 0.002351, 0.002094, 0.001893, 0.001497, 0.001567,
        0.001162, 0.001207, 0.000831, 0.00089, 0.000946, 0.001, 0.000583, 0.000643,
        0.000831, 0.000909, 0.00094, 0.001093, 0.00134, 0, 0.002559, 0.004831,
        0.00493, 0.004469, 0.004343, 0.004269, 0.00345, 0.00337, 0.003008, 0.00265,
        0.002309, 0.002326, 0.001885, 0.001538, 0.001448, 0.00155, 0.001491, 0.001962,
        0.00234, 0.002771, 0.003447, 0.004282, 0.0047, 0.005102, 0.005637, 0.005423,
        0.005509, 0.005624, 0.005234, 0.005189, 0.004752, 0.004768, 0.004394,
        0.004098, 0.003978, 0.003811, 0.003673, 0.003397, 0.003086, 0.002827,
        0.002737, 0.002751, 0.002667, 0.002641, 0.002445, 0.002481, 0.002637, 0.00255,
        0.00272, 0.002827, 0.002821, 0.003085, 0.003519, 0.003488, 0.00362, 0.003585,
        0.003562, 0.003565, 0.003483, 0.003266, 0.003183, 0.003025, 0.003138, 0.00296,
        0.003292, 0.002399, 0.002144, 0.001615, 0.001135, 0.000876, 0.000917,
        0.000631, 0.000632, 0.000678, 0.000675, 0.000699, 0.00072, 0.000369, 0.000374,
        0.00039, 0.000405, 0.000419, 0.000477, 0.000535, 0.000611, 0.000643, 0.000698,
        0.000784, 0.000794, 0, 0.007772, 0.036957, 0.03125, 0.026793, 0.021988,
        0.019845, 0.017662, 0.014873, 0.013029, 0.010705, 0.010327, 0.008985,
        0.008651, 0.007233, 0.006972, 0.006, 0.006512, 0.006289, 0.010223, 0.014098,
        0.018595, 0.025027, 0.029167, 0.034483, 0.037005, 0.03818, 0.039187, 0.036915,
        0.037309, 0.03602, 0.035048, 0.033702, 0.03272, 0.0317, 0.030548, 0.02983,
        0.029316, 0.027911, 0.027629, 0.02669, 0.026282, 0.025271, 0.024845, 0.02415,
        0.024357, 0.023, 0.022428, 0.021784, 0.021299, 0.02074, 0.019699, 0.020118,
        0.019481, 0.019472, 0.020104, 0.021019, 0.022237, 0.024804, 0.02656, 0.025316,
        0.028269, 0.021226, 0.025618, 0.033301, 0.043651, 0.073439, 0.054449,
        0.023885, 0.015203, 0.014109, 0.012121, 0.011628, 0.012407, 0.012563,
        0.011338, 0.011204, 0.01084, 0.009585, 0.009677, 0.008264, 0.007117, 0.003788,
        0.007273, 0.004808, 0.004274, 0.00495, 0.005988, 0.008403, 0.008065, 0.010526,
        0, 0.003626, 0.028953, 0.026694, 0.025455, 0.023581, 0.021024, 0.018605,
        0.017159, 0.014184, 0.013158, 0.011938, 0.01173, 0.01155, 0.010718, 0.010753,
        0.011482, 0.01087, 0.011312, 0.013614, 0.014423, 0.015038, 0.018277, 0.019231,
        0.022005, 0.024262, 0.026265, 0.026678, 0.025816, 0.025326, 0.026403,
        0.026098, 0.025779, 0.024554, 0.023783, 0.022408, 0.021432, 0.019918, 0.01882,
        0.01712, 0.016484, 0.015213, 0.014751, 0.013595, 0.013075, 0.01228, 0.012252,
        0.011824, 0.011628, 0.011025, 0.010842, 0.010774, 0.010057, 0.010128,
        0.010072, 0.010929, 0.013047, 0.015574, 0.018806, 0.022862, 0.026877,
        0.030965, 0.029562, 0.02968, 0.03034, 0.038694, 0.022989, 0.021875, 0.016636,
        0.013725, 0.01354, 0.012, 0.011236, 0.012407, 0.010471, 0.010695, 0.011111,
        0.010695, 0.011407, 0.013699, 0.012987, 0.012448, 0.01005, 0.012821, 0.009662,
        0.013274, 0.009804, 0.012821, 0.013158, 0.010638, 0.010753, 0.016667,
        0.029412, 0.033333, 0
      ),
      rep(
        c(5L, 60L, 5L, 60L, 5L, 55L, 5L, 10L, 5L, 35L),
        c(89L, 1L, 89L, 1L, 90L, 1L, 90L, 1L, 2L, 1L)
      )
    ),
    emi_nat = rep(
      c(
        0.008526, 0.02071, 0.02203, 0.018679, 0.015907, 0.013601, 0.011862, 0.010405,
        0.008804, 0.007755, 0.006978, 0.006159, 0.005423, 0.004645, 0.004251,
        0.004064, 0.003974, 0.005263, 0.008382, 0.013043, 0.01807, 0.024176, 0.030901,
        0.038272, 0.045613, 0.05192, 0.056019, 0.057951, 0.057516, 0.054906, 0.051336,
        0.047002, 0.042333, 0.037951, 0.033835, 0.030379, 0.027213, 0.024652,
        0.022379, 0.020447, 0.018902, 0.017775, 0.016364, 0.015601, 0.014599,
        0.014053, 0.013264, 0.012634, 0.012282, 0.011636, 0.011271, 0.010796,
        0.010383, 0.010127, 0.009711, 0.009276, 0.008937, 0.008768, 0.008468,
        0.008036, 0.007933, 0.007617, 0.007424, 0.007161, 0.00915, 0.012746, 0.00639,
        0.00644, 0.006103, 0.005902, 0.005894, 0.00571, 0.005585, 0.005301, 0.00524,
        0.005094, 0.005035, 0.004829, 0.004572, 0.004452, 0.004255, 0.004498,
        0.004082, 0.003856, 0.004153, 0.003636, 0.003759, 0.003279, 0.004021,
        0.002907, 0.003407, 0.004484, 0.002571, 0.003311, 0.004274, 0, 0.009382,
        0.028107, 0.023007, 0.018994, 0.015792, 0.013194, 0.011115, 0.00936, 0.008271,
        0.007192, 0.006541, 0.005814, 0.005654, 0.005385, 0.005429, 0.005424,
        0.006336, 0.008239, 0.01209, 0.018606, 0.027959, 0.038926, 0.05092, 0.061617,
        0.069899, 0.074837, 0.076019, 0.074165, 0.069784, 0.063646, 0.057026,
        0.049728, 0.043315, 0.037201, 0.031824, 0.027628, 0.023875, 0.021001,
        0.018519, 0.016646, 0.015511, 0.014364, 0.013333, 0.012617, 0.012225,
        0.011787, 0.011536, 0.011157, 0.010879, 0.010678, 0.010345, 0.010179,
        0.009971, 0.009928, 0.009827, 0.009475, 0.009261, 0.009033, 0.008823,
        0.008631, 0.008411, 0.008378, 0.007965, 0.007893, 0.009876, 0.009064,
        0.007235, 0.006997, 0.00681, 0.006423, 0.006418, 0.005997, 0.005691, 0.005765,
        0.0054, 0.005245, 0.00504, 0.004794, 0.004484, 0.004295, 0.004052, 0.004195,
        0.003815, 0.003743, 0.003663, 0.003213, 0.002793, 0.003137, 0.002383,
        0.002833, 0.002045, 0.002481, 0.001391, 0.001786, 0.002114, 0.002646, 0,
        0.005181, 0.023913, 0.021429, 0.019879, 0.01759, 0.015531, 0.014298, 0.012248,
        0.011401, 0.009813, 0.008606, 0.008086, 0.00692, 0.006329, 0.00498, 0.005,
        0.004651, 0.006289, 0.010223, 0.016917, 0.025826, 0.03482, 0.044792, 0.052738,
        0.05852, 0.062551, 0.064586, 0.06526, 0.06422, 0.062271, 0.059921, 0.056872,
        0.054192, 0.050913, 0.048068, 0.044975, 0.042345, 0.039686, 0.037879,
        0.035587, 0.034037, 0.032942, 0.0315, 0.030859, 0.029871, 0.029229, 0.028279,
        0.02749, 0.027157, 0.026345, 0.025492, 0.024852, 0.023613, 0.022613, 0.021401,
        0.020382, 0.019621, 0.018277, 0.017264, 0.015989, 0.014841, 0.013365,
        0.012367, 0.011753, 0.010913, 0.011016, 0.010624, 0.009554, 0.008446,
        0.007055, 0.006061, 0.006977, 0.004963, 0.005025, 0.004535, 0.002801, 0.00271,
        0.003195, 0.003226, 0.004132, 0.003559, 0.003788, 0.003636, 0, 0.003626,
        0.024499, 0.021561, 0.019091, 0.017467, 0.015539, 0.013953, 0.012393,
        0.011525, 0.010338, 0.009183, 0.00782, 0.0077, 0.006431, 0.005865, 0.005219,
        0.005435, 0.007919, 0.013614, 0.02524, 0.038847, 0.050914, 0.060256, 0.066015,
        0.068565, 0.067121, 0.065404, 0.061503, 0.057164, 0.052805, 0.048377,
        0.044365, 0.040737, 0.037058, 0.033872, 0.030842, 0.028601, 0.025941,
        0.024169, 0.022478, 0.021298, 0.019837, 0.019134, 0.018305, 0.018153,
        0.017503, 0.017455, 0.017136, 0.016861, 0.017219, 0.016835, 0.016523, 0.01688,
        0.016547, 0.015613, 0.015349, 0.014754, 0.014718, 0.013548, 0.012975, 0.01184,
        0.011213, 0.010274, 0.008495, 0.007255, 0.005747, 0.004688, 0.003697,
        0.003922, 0.003868, 0.004, 0.004494, 0.002481, 0.002618, 0.002674, 0.002778,
        0.002674, 0.003802, 0.003425, 0.004329, 0.004149, 0.005025, 0.004274,
        0.004831, 0.004425, 0
      ),
      rep(c(5L, 30L, 5L, 25L, 5L, 90L, 5L, 80L), c(95L, 1L, 96L, 1L, 83L, 1L, 85L, 1L))
    ),
    acq = rep(
      c(
        0, 0.011957, 0.014286, 0.014693, 0.014952, 0.015531, 0.016821, 0.016623,
        0.019544, 0.022302, 0.024957, 0.028751, 0.033737, 0.037975, 0.041833, 0.045,
        0.046512, 0.045073, 0.040892, 0.020677, 0.017562, 0.016322, 0.014583,
        0.013185, 0.011188, 0.009748, 0.008708, 0.00791, 0.007339, 0.007326, 0.006783,
        0.007372, 0.007669, 0.008165, 0.008985, 0.010096, 0.010703, 0.011339,
        0.012032, 0.013345, 0.013356, 0.013538, 0.014197, 0.014311, 0.014706,
        0.014375, 0.014139, 0.014523, 0.013312, 0.013453, 0.012746, 0.012426,
        0.011806, 0.011307, 0.011025, 0.010191, 0.00981, 0.009138, 0.009296, 0.008661,
        0.007774, 0.007075, 0.007067, 0.006856, 0.005952, 0.00612, 0.005312, 0.004777,
        0.005068, 0.003527, 0.00404, 0.004651, 0.002481, 0.002513, 0.002268, 0.002801,
        0.00271, 0.003195, 0.003226, 0.004132, 0.003559, 0.003788, 0.003636, 0,
        0.020045, 0.019507, 0.017273, 0.015721, 0.015539, 0.015814, 0.017159,
        0.018617, 0.021617, 0.024793, 0.029326, 0.033686, 0.038585, 0.044966,
        0.049061, 0.051087, 0.050905, 0.045792, 0.038462, 0.033835, 0.028721,
        0.024359, 0.020782, 0.017932, 0.015564, 0.012048, 0.01063, 0.008683, 0.008581,
        0.008912, 0.009592, 0.010603, 0.012721, 0.013549, 0.015159, 0.015322,
        0.016277, 0.01712, 0.017483, 0.018256, 0.018311, 0.018127, 0.017782, 0.017619,
        0.017503, 0.016892, 0.016524, 0.015564, 0.015306, 0.014141, 0.013649,
        0.012829, 0.01223, 0.01171, 0.010744, 0.009016, 0.008177, 0.007621, 0.007414,
        0.006375, 0.006116, 0.005708, 0.004854, 0.003628, 0.00431, 0.003125, 0.003697,
        0.001961, 0.001934, 0.002, 0.002247, 0.002481, 0
      ),
      rep(c(1015L, 5L, 95L, 5L, 140L), c(1L, 82L, 1L, 72L, 1L))
    ),
    imm_int_n = rep(
      c(
        0.8, 9.6, 3.4, 3, 2.8, 2.6, 2.4, 2.2, 2, 1.8, 1.6, 1.4, 1.2, 1, 1.2, 1.6, 1.8,
        2.2, 2.4, 2.6, 2.8, 2.6, 2.4, 2.2, 2, 1.8, 1.6, 1.8, 2, 2.2, 2.4, 2.2, 2, 1.8,
        1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 0.8, 8.8, 2.8, 2.6, 2.4, 2.2, 2, 1.8,
        1.6, 1.4, 1.2, 1.4, 1.2, 1.4, 1.6, 1.8, 2, 2.2, 2.4, 2.6, 2.8, 2.6, 2.4, 2.2,
        2, 1.8, 1.6, 1.4, 1.2, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 2.8, 22.6, 10.6,
        10, 9.8, 9.4, 9.2, 9, 8.8, 8.6, 8.4, 8, 7.6, 8, 9.4, 11.6, 14.4, 17.8, 21.4,
        24.6, 27.6, 29.8, 31.4, 32.4, 32.8, 32.6, 32.4, 31.6, 30.6, 29.4, 28, 26.8,
        25.4, 24, 22.8, 21.4, 20.2, 19, 18, 17, 16, 15, 14.2, 13.4, 12.8, 12, 11.4,
        10.6, 10, 9.2, 8.6, 7.6, 6.8, 5.8, 5, 4.4, 3.8, 3.2, 2.6, 2.2, 1.8, 1.6, 1.4,
        1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 3.2, 24.4, 10.6, 10, 9.6, 9.2, 9, 8.8, 8.4,
        8.2, 8, 7.6, 7.4, 7, 6.6, 6.2, 6, 7.4, 10.2, 14.2, 18.6, 22.4, 25, 26.8, 27.6,
        27, 26, 24.8, 23.6, 22.2, 21, 19.6, 18.4, 17.2, 16.2, 15.2, 14.2, 13.2, 12.6,
        11.8, 11, 10.4, 9.8, 9.4, 8.8, 8.4, 8, 7.6, 7.2, 6.8, 6.4, 5.8, 5.4, 4.6, 4.2,
        3.6, 3, 2.6, 2.4, 2, 1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0
      ),
      rep(
        c(
          5L, 15L, 5L, 10L, 15L, 5L, 20L, 40L, 15L, 10L, 20L, 10L, 5L, 10L, 15L, 5L,
          15L, 5L, 15L, 20L, 30L, 50L, 5L, 10L, 5L, 10L, 5L, 25L, 5L, 10L, 5L, 10L, 5L,
          25L, 10L, 15L, 10L, 5L, 10L, 15L, 25L, 40L, 30L, 20L, 25L, 35L, 45L, 30L, 5L,
          10L, 5L, 15L, 5L, 10L, 5L, 10L, 30L, 105L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L,
          20L, 60L, 35L, 40L
        ),
        c(
          4L, 1L, 7L, 1L, 1L, 6L, 1L, 1L, 1L, 3L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 4L,
          2L, 1L, 1L, 3L, 1L, 4L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 3L, 1L, 2L, 1L, 1L, 2L,
          1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 6L, 1L, 1L, 1L, 3L, 1L, 53L, 2L, 1L,
          1L, 10L, 1L, 5L, 1L, 7L, 1L, 38L, 2L, 1L, 1L, 1L, 1L
        )
      )
    ),
    imm_nat_n = rep(
      c(
        9.4, 17.6, 15.8, 12.4, 9.8, 8.2, 7, 6, 5.2, 4.6, 4.2, 3.8, 3.4, 3.2, 3.4, 3.8,
        5, 6.8, 9.8, 13.8, 17.8, 22, 23.8, 26, 28.2, 30.2, 30.6, 31.6, 31.8, 32, 31.2,
        29.4, 27, 24.6, 22, 20.2, 18.2, 16.8, 15, 13.8, 12.8, 11.8, 11, 10, 9.4, 8.8,
        8.6, 8.8, 8.4, 8.6, 8.2, 8, 8.2, 8, 8.2, 7.6, 7.4, 6.8, 6.2, 6.6, 7, 5.8, 5,
        4.2, 3.6, 3, 2.8, 2.6, 2.2, 2, 1.8, 1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0,
        11.4, 16.2, 15.8, 15, 11.4, 9.4, 7.6, 6.4, 5.4, 4.6, 4, 3.4, 3.2, 2.8, 2.6,
        2.4, 2.8, 4, 6.4, 10.2, 14.6, 18.8, 23, 27.4, 33.6, 36.4, 37.8, 38, 35.8,
        34.2, 32.6, 31.4, 29, 27, 24.4, 22.4, 19.8, 18.4, 16.6, 15, 13.4, 12.4, 11,
        10.2, 9, 8.2, 7.8, 7.6, 7.4, 7.6, 7.8, 8.2, 8.6, 8.8, 8.4, 8.6, 8.2, 7.8, 7.4,
        7, 6.6, 5.6, 5, 4.2, 3.6, 3.4, 3, 2.8, 2.6, 2.4, 2.2, 2, 1.8, 1.6, 1.4, 1.2,
        1, 0.8, 0.6, 0.4, 0.2, 0, 4, 5.6, 5.8, 5, 4.6, 4.4, 4.2, 3.8, 3.6, 3.4, 3,
        2.6, 2.4, 2.8, 3.6, 4.6, 6.2, 7.4, 9.6, 12, 15.8, 18.2, 20.6, 23.2, 24.4,
        25.4, 26.4, 27.2, 27.4, 27, 26.4, 26, 24.2, 23.2, 22.2, 20.6, 19.2, 18.2,
        16.8, 16.2, 14.6, 13.6, 12.4, 11.6, 10.4, 9.8, 8.8, 8.4, 7.6, 7.2, 6.8, 6.4,
        5.8, 5.4, 5, 4.4, 3.6, 3.2, 2.6, 2.4, 2.2, 1.8, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0,
        3.8, 6.6, 6.2, 5.4, 4.6, 4.2, 3.6, 3.2, 2.8, 2.4, 2.2, 1.8, 1.6, 1.4, 1.2,
        1.4, 1.8, 2.6, 4.4, 6.4, 8.2, 10.2, 12, 14.6, 16.4, 18.2, 19.4, 20.2, 20.6,
        20, 19.6, 19.4, 18, 17.2, 16.2, 15, 13.4, 12.4, 11.2, 10.4, 9.6, 8.8, 8.2,
        7.6, 7, 6.8, 6.4, 6, 5.6, 5.4, 5.2, 5, 4.6, 4.4, 4.2, 3.6, 3.4, 3, 2.8, 2.2,
        2, 1.6, 1.4, 1.2, 0.8, 0.6, 0.4, 0.2, 0
      ),
      rep(
        c(
          5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 15L, 20L, 15L,
          25L, 5L, 10L, 5L, 10L, 15L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 15L, 10L, 5L,
          25L, 15L, 5L, 10L, 5L, 20L, 5L, 10L, 5L, 10L, 35L, 75L, 5L, 10L, 5L, 10L, 5L,
          10L, 5L, 10L, 5L, 45L, 40L, 70L
        ),
        c(
          1L, 1L, 10L, 2L, 37L, 1L, 4L, 1L, 11L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L,
          27L, 1L, 24L, 2L, 1L, 13L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L,
          1L, 9L, 1L, 16L, 1L, 35L, 1L, 2L, 1L, 1L, 1L, 49L, 1L, 9L, 1L, 2L, 1L, 1L, 1L,
          1L, 1L
        )
      )
    ),
    emi_nat_n = rep(
      c(
        4.2, 9.8, 11.2, 10.8, 8.8, 7.6, 6.6, 5.8, 4.8, 4.4, 4, 3.4, 3, 2.6, 2.4, 2.2,
        2.8, 4.6, 7.2, 10, 13.2, 16.6, 20.2, 26.2, 29.2, 32.2, 33.6, 35.2, 31, 29.2,
        29, 27, 24, 21.6, 19.4, 17.4, 15.6, 14.6, 12.8, 12.4, 11.6, 10.8, 10.2, 9.6,
        8.8, 8.2, 7.8, 7.2, 7, 7.2, 7, 7.2, 7, 7.2, 7, 6.8, 6.2, 6, 5.6, 6.8, 9.2,
        4.4, 4, 3.8, 3.6, 3.4, 3.2, 2.8, 2.6, 2.4, 2.2, 2, 1.8, 1.4, 1.2, 1, 0.8, 0.6,
        0.4, 0.2, 0, 4.4, 12.8, 11.2, 10.2, 8, 6.8, 5.8, 5, 4.4, 3.8, 3.4, 3, 2.8, 3,
        2.8, 3.4, 4.2, 6.2, 9.4, 14.6, 20, 26, 31.4, 37.2, 41.4, 42.2, 40, 36.8, 33.6,
        29.2, 27.6, 23.6, 20.8, 17.4, 15.6, 13.6, 12, 10.6, 10.2, 9.4, 9, 8.6, 8, 7.6,
        7, 7.2, 6.8, 6.6, 6.8, 7.4, 7.6, 7.4, 7.8, 7.6, 7.4, 7.2, 6.6, 6.4, 7.8, 6.8,
        5.4, 5.2, 4.8, 4.4, 4.2, 3.8, 3.6, 3.4, 3.2, 3, 2.8, 2.6, 2.4, 2.2, 2, 1.6,
        1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 1.2, 4.4, 4.8, 4.6, 4, 3.6, 3.4, 2.8, 2.2,
        2, 1.8, 1.6, 1.4, 1, 1.2, 2.2, 3.6, 5, 6.4, 8.6, 10.4, 13.6, 15.4, 17.8, 19.8,
        21, 20.4, 21.2, 21.6, 21.2, 21.4, 19.6, 18.2, 17, 16, 15.8, 14.6, 14.2, 13.8,
        13, 12.2, 11.6, 10.6, 10.2, 9.4, 8.8, 8.4, 8, 7.2, 6.6, 6.4, 6, 5.6, 5.2, 4.8,
        4.2, 3.4, 2.8, 2.4, 2.2, 1.8, 1.6, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 0.8, 4.4,
        4.2, 4, 3.4, 3, 2.6, 2.2, 2, 1.6, 1.2, 1, 1.4, 2.2, 4.2, 6.2, 7.8, 9.4, 10.8,
        13, 13.8, 15.2, 16.2, 15.8, 16, 15.2, 14.8, 14.6, 13.4, 13, 11.8, 11.2, 10.2,
        9.6, 9, 8.4, 7.8, 7.6, 7, 6.8, 6, 6.2, 5.6, 5.2, 5.4, 5, 4.6, 5, 4.6, 4, 3.6,
        3.2, 2.8, 2.6, 2.2, 1.8, 1.4, 1.2, 0.8, 0.6, 0.4, 0.2, 0
      ),
      rep(
        c(
          5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 15L,
          30L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 20L, 25L,
          5L, 10L, 5L, 15L, 5L, 10L, 5L, 10L, 5L, 10L, 15L, 40L, 90L, 5L, 10L, 5L, 10L,
          5L, 10L, 5L, 10L, 5L, 25L, 65L, 80L
        ),
        c(
          15L, 1L, 34L, 2L, 1L, 1L, 1L, 1L, 5L, 1L, 5L, 2L, 3L, 1L, 3L, 2L, 2L, 1L, 11L,
          1L, 12L, 1L, 19L, 1L, 2L, 1L, 5L, 2L, 19L, 1L, 4L, 3L, 1L, 1L, 7L, 1L, 5L, 1L,
          15L, 1L, 2L, 1L, 32L, 1L, 1L, 1L, 1L, 2L, 1L, 3L, 1L, 2L, 3L, 37L, 2L, 9L, 1L,
          1L, 1L
        )
      )
    ),
    mig_nat_n = rep(
      c(
        5.2, 7.8, 6.4, 5, 3.6, 2.2, 1.6, 1.2, 0.8, 0.6, 0.8, 1, 0.6, -0.8, -2.2, -3.2,
        -3.4, -2.8, -2.4, -4.2, -5.4, -6.2, -5.4, -5, -0.4, 2.4, 2.8, 5, 7.2, 7.8,
        7.6, 7.2, 6.4, 5.6, 5.4, 4.4, 3.4, 3, 2.6, 2.2, 1.8, 1.6, 1.4, 1.6, 1, 0.8, 1,
        0.8, 1.2, 0.8, 0.6, 1.2, 0.8, 0.6, -0.2, -2.2, 1.4, 0.6, 0.2, -0.2, -0.6,
        -0.4, -0.6, -0.4, -0.2, 0, -0.2, 0, 0.2, 0, 0.2, 0, 7, 3.4, 4.6, 4.8, 3.4,
        2.6, 1.8, 1.4, 1, 0.8, 0.6, 0.4, 0.2, 0, -0.4, -0.6, -0.2, 0.2, 0.8, 0, -1.2,
        -3, -4, -3.6, -5, -3.6, -4.2, -2, -1, 0.6, 3.4, 3.8, 5.4, 6.2, 7, 6.8, 6.2,
        6.4, 6, 4.8, 4, 3.4, 2.4, 2.2, 1.4, 1.2, 0.8, 0.4, 0.6, 1, 1.2, 1.4, 1.2, 1,
        1.4, 1, 0.8, 1, 1.2, 1, 1.2, 1, -0.8, -0.2, 0.2, -0.2, -0.6, -0.8, -0.6, -0.4,
        -0.2, -0.4, 0, 0.2, 0, 0.2, 0, 0.2, 0, 2.8, 1.2, 1, 1.2, 1, 1.4, 1, 1.4, 1.2,
        1, 1.4, 1.6, 1.4, 1, 1.2, 1, 1.6, 2.2, 2.8, 3.4, 5, 5.2, 5.6, 6.2, 5.8, 5.6,
        6.8, 7.8, 6, 6.2, 4.8, 4.6, 4, 3, 3.2, 2.4, 2, 1.8, 1.4, 1, 0.4, 0.6, 0.4,
        0.2, 0.4, 0.2, 0.4, 0.2, 0, 0.2, 0, 0.2, 0, 3, 2.2, 2.4, 2, 1.4, 1.2, 1, 0.6,
        0.4, 0.6, 0.2, 0.4, 0.2, 0.4, 0.2, 0.4, 0.8, 1.2, 1.6, 2.6, 3, 3.2, 4.4, 4.6,
        4.8, 4.6, 4.2, 4.4, 3.8, 3.2, 2.8, 2.2, 2, 1.8, 1.2, 0.8, 1, 0.6, 0.8, 0.2,
        0.4, 0.6, 0, 0.4, 0.6, 0.4, 0.6, 0, 0.2, 0, 0.2, 0.4, 0.6, 0.4, 0.2, 0, 0.2,
        0, 0.2, 0
      ),
      rep(
        c(
          5L, 10L, 5L, 15L, 5L, 10L, 5L, 20L, 5L, 10L, 5L, 45L, 10L, 5L, 10L, 5L, 25L,
          5L, 10L, 5L, 25L, 5L, 10L, 5L, 10L, 5L, 25L, 10L, 15L, 10L, 5L, 20L, 5L, 25L,
          15L, 10L, 15L, 5L, 15L, 5L, 10L, 5L, 10L, 15L, 5L, 10L, 5L, 10L, 5L, 10L, 5L,
          10L, 15L, 5L, 10L, 25L, 5L, 10L, 5L, 40L, 20L, 15L, 75L, 5L, 10L, 5L, 10L, 5L,
          10L, 15L, 10L, 5L, 15L, 5L, 10L, 5L, 10L, 5L, 15L, 5L, 10L, 5L, 10L, 5L, 10L,
          35L, 30L, 10L, 70L
        ),
        c(
          7L, 1L, 2L, 2L, 27L, 1L, 1L, 1L, 4L, 1L, 13L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L,
          1L, 1L, 14L, 1L, 41L, 1L, 10L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 4L,
          1L, 2L, 1L, 1L, 1L, 1L, 4L, 1L, 2L, 2L, 9L, 1L, 9L, 1L, 1L, 1L, 1L, 1L, 1L,
          1L, 2L, 1L, 2L, 1L, 1L, 5L, 1L, 1L, 1L, 4L, 1L, 1L, 1L, 9L, 1L, 9L, 1L, 3L,
          1L, 9L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L
        )
      )
    ),
    fso_projection_n = rep(
      c(
        2481, 2452, 2595, 2935, 2804, 2827, 2814, 2816, 2760, 2869, 2901, 2799, 2812,
        2847, 2872, 2759, 2823, 2705, 2781, 2767, 2764, 2724, 2683, 2637, 2859, 2793,
        2851, 2880, 3042, 2830, 2865, 3109, 3225, 3212, 3248, 3250, 3254, 3220, 3315,
        3186, 3331, 3308, 3344, 3311, 3327, 3169, 3124, 3119, 2960, 3035, 3218, 3263,
        3392, 3569, 3717, 3781, 4030, 4102, 4129, 4220, 4267, 4053, 4020, 3889, 3689,
        3562, 3417, 3387, 3245, 3182, 3016, 2937, 2822, 2598, 2624, 2500, 2523, 2419,
        2334, 2169, 2031, 1908, 1624, 1461, 1119, 1012, 965, 820, 659, 600, 505, 378,
        326, 247, 187, 119, 88, 54, 24, 22, 23, 2371, 2344, 2477, 2728, 2570, 2608,
        2637, 2697, 2687, 2670, 2631, 2613, 2690, 2638, 2809, 2628, 2729, 2595, 2602,
        2561, 2636, 2582, 2554, 2541, 2654, 2752, 2715, 2834, 2865, 2896, 2961, 2967,
        3223, 3222, 3324, 3213, 3330, 3301, 3307, 3250, 3348, 3327, 3426, 3451, 3314,
        3258, 3067, 3164, 3329, 3204, 3209, 3260, 3426, 3738, 3873, 3911, 4209, 4202,
        4300, 4280, 4390, 4286, 4131, 4040, 3922, 3730, 3711, 3694, 3500, 3399, 3244,
        3139, 3131, 2915, 2925, 2819, 2734, 2665, 2623, 2503, 2404, 2312, 2025, 1795,
        1562, 1471, 1340, 1178, 1147, 951, 862, 697, 609, 463, 381, 296, 218, 150,
        106, 67, 95, 1173, 994, 1127, 1165, 1149, 1170, 1199, 1160, 1238, 1135, 1172,
        1121, 1155, 1103, 1002, 994, 1062, 952, 1074, 1089, 1010, 974, 1029, 1069,
        1254, 1334, 1482, 1627, 1742, 1754, 1882, 2006, 2060, 2174, 2305, 2259, 2228,
        2352, 2299, 2295, 2353, 2246, 2274, 2248, 2185, 2094, 2055, 1932, 1882, 1785,
        1729, 1687, 1690, 1588, 1537, 1557, 1512, 1506, 1473, 1468, 1378, 1247, 1104,
        986, 961, 756, 709, 610, 578, 554, 483, 419, 392, 386, 427, 346, 357, 303,
        299, 233, 269, 253, 262, 199, 223, 191, 155, 109, 112, 83, 50, 33, 15, 13, 8,
        11, 5, 2, 0, 1127, 987, 994, 1113, 1155, 1106, 1089, 1062, 1136, 1071, 1091,
        1024, 1031, 926, 1002, 934, 896, 861, 792, 826, 811, 803, 843, 901, 1041,
        1132, 1269, 1422, 1491, 1614, 1663, 1750, 1863, 1869, 1968, 1956, 1993, 2007,
        2015, 1981, 1972, 1987, 1913, 1872, 1716, 1774, 1635, 1546, 1566, 1486, 1396,
        1479, 1391, 1282, 1298, 1213, 1208, 1161, 1055, 1068, 955, 853, 801, 797, 683,
        629, 534, 505, 510, 492, 438, 397, 378, 369, 354, 368, 259, 286, 225, 234,
        194, 226, 200, 215, 195, 147, 140, 86, 84, 53, 52, 29, 24, 17, 10, 7, 3, 2
      ),
      rep(c(5L, 15L, 5L, 10L, 5L, 10L, 5L, 10L), c(300L, 1L, 36L, 1L, 56L, 1L, 3L, 1L))
    ),
    mig_sub = rep(c(-0.1253, -0.1794, -0.1924, 0.0434, 0.4537), 404),
  )


  ## FSO population with fictitious subregions ----
  # fso_population |>
  #   dplyr::rename(n_tot = n) |>
  #   # duplicating rows 5 times
  #   tidyr::uncount(5) |>
  #   # create 5 subregions
  #   dplyr::mutate(spatial_unit = rep(1:5, times = nrow(fso_population))) |>
  #   dplyr::mutate(
  #     # Create fictitious n
  #     n = dplyr::case_match(
  #       spatial_unit,
  #       1 ~ round(n_tot * 0.3),
  #       2 ~ round(n_tot * 0.25),
  #       3 ~ round(n_tot * 0.2),
  #       4 ~ round(n_tot * 0.15),
  #       # 5 ~ round(n_tot * 0.1),
  #       .default = NA
  #     ),
  #     .keep = "all"
  #   ) |>
  #   # create region 5 by subtracting sum of 1:4 from original n to get exact same n
  #   # (avoid rounding errors)
  #   ## get sum of regions 1-4
  #   dplyr::mutate(sum = sum(n, na.rm = TRUE), .by=c(year,nat,sex,age)) |>
  #   ## compute region 5
  #   dplyr::mutate(
  #     n = dplyr::case_match(
  #       spatial_unit,
  #       5 ~ (n_tot - sum),
  #       .default = n
  #     )) |>
  #   dplyr::mutate(spatial_unit = as.character(spatial_unit)) |>
  #   dplyr::select(-n_tot, -sum) |>
  #   # dplyr::filter(age < 51) |>
  #   constructive::construct()

  population_short_5r <- tibble::tibble(
    year = rep(2023, 2020L),
    spatial_unit = rep(c("1", "2", "3", "4", "5"), 404),
    nat = rep(c("ch", "int"), each = 1010L),
    sex = rep(rep(c("m", "f"), 2), each = 505L),
    age = rep(rep(seq(0, 100, by = 1), 4), each = 5L),
    n_dec = c(
      711, 593, 474, 356, 237, 763, 636, 508, 381, 254, 867, 723, 578, 434, 289,
      830, 692, 553, 415, 276, 838, 698, 559, 419, 280, 835, 696, 556, 417, 278,
      836, 697, 557, 418, 279, 818, 682, 545, 409, 272, 851, 709, 567, 426, 284,
      860, 716, 573, 430, 287, 828, 690, 552, 414, 276, 830, 692, 553, 415, 276,
      840, 700, 560, 420, 279, 847, 706, 565, 423, 282, 812, 677, 541, 406, 271,
      830, 692, 554, 415, 277, 798, 665, 532, 399, 266, 823, 686, 549, 412, 274,
      828, 690, 552, 414, 275, 830, 692, 553, 415, 277, 819, 682, 546, 410, 273,
      806, 672, 537, 403, 268, 792, 660, 528, 396, 263, 862, 718, 574, 431, 287,
      844, 703, 562, 422, 281, 862, 718, 575, 431, 288, 870, 725, 580, 435, 289,
      918, 765, 612, 459, 306, 847, 706, 565, 423, 282, 853, 711, 569, 427, 284,
      926, 771, 617, 463, 308, 957, 797, 638, 478, 319, 949, 790, 632, 474, 317,
      958, 798, 638, 479, 319, 958, 798, 639, 479, 319, 959, 799, 639, 480, 320,
      949, 791, 633, 475, 316, 979, 816, 652, 489, 326, 939, 782, 626, 470, 313,
      984, 820, 656, 492, 328, 979, 816, 653, 489, 326, 990, 825, 660, 495, 330,
      981, 817, 654, 490, 327, 986, 822, 658, 493, 329, 939, 783, 626, 470, 313,
      927, 773, 618, 464, 309, 926, 772, 617, 463, 309, 879, 733, 586, 440, 293,
      902, 752, 602, 451, 301, 958, 798, 639, 479, 320, 973, 810, 648, 486, 325,
      1011, 843, 674, 506, 337, 1066, 889, 711, 533, 356, 1112, 927, 741, 556, 371,
      1132, 943, 755, 566, 377, 1208, 1007, 806, 604, 403, 1232, 1026, 821, 616,
      411, 1240, 1033, 827, 620, 413, 1269, 1058, 846, 635, 423, 1286, 1072, 857,
      643, 428, 1221, 1018, 814, 610, 407, 1212, 1010, 808, 606, 405, 1173, 978,
      782, 586, 391, 1115, 929, 743, 557, 372, 1083, 902, 722, 541, 361, 1033, 861,
      689, 516, 344, 1025, 854, 683, 512, 342, 983, 819, 655, 492, 328, 966, 805,
      644, 483, 321, 916, 764, 611, 458, 305, 893, 744, 595, 447, 298, 860, 716,
      573, 430, 286, 792, 660, 528, 396, 265, 802, 668, 534, 401, 267, 766, 638,
      510, 383, 255, 775, 646, 516, 387, 258, 746, 621, 497, 373, 248, 722, 602,
      481, 361, 240, 674, 562, 449, 337, 224, 634, 528, 423, 317, 212, 600, 500,
      400, 300, 201, 514, 429, 343, 257, 172, 467, 389, 311, 233, 156, 361, 301,
      241, 181, 120, 330, 275, 220, 165, 110, 319, 266, 213, 160, 106, 274, 229,
      183, 137, 92, 224, 186, 149, 112, 75, 206, 172, 138, 103, 69, 176, 147, 117,
      88, 59, 134, 112, 89, 67, 44, 117, 97, 78, 58, 39, 91, 76, 60, 45, 30, 70, 58,
      47, 35, 24, 46, 38, 31, 23, 15, 35, 30, 24, 18, 11, 22, 19, 15, 11, 8, 10, 9,
      7, 5, 4, 10, 8, 7, 5, 3, 4, 4, 3, 2, 2, 7, 6, 5, 3, 2, 686, 572, 457, 343,
      228, 730, 608, 487, 365, 244, 806, 671, 537, 403, 268, 760, 633, 507, 380,
      253, 773, 644, 515, 387, 258, 783, 652, 522, 391, 261, 801, 668, 534, 401,
      267, 798, 665, 532, 399, 266, 793, 660, 528, 396, 265, 780, 650, 520, 390,
      259, 774, 645, 516, 387, 258, 796, 663, 531, 398, 265, 780, 650, 520, 390,
      260, 829, 691, 553, 414, 276, 774, 645, 516, 387, 259, 805, 671, 537, 402,
      268, 765, 637, 510, 382, 255, 769, 641, 513, 385, 256, 758, 632, 505, 379,
      253, 783, 653, 522, 392, 261, 771, 642, 514, 385, 257, 766, 638, 511, 383,
      255, 764, 637, 510, 382, 255, 799, 666, 532, 399, 266, 830, 692, 553, 415,
      276, 817, 681, 545, 408, 272, 854, 711, 569, 427, 284, 860, 716, 573, 430,
      287, 867, 723, 578, 434, 289, 884, 736, 589, 442, 295, 881, 734, 587, 440,
      294, 956, 796, 637, 478, 319, 952, 793, 634, 476, 317, 980, 817, 654, 490,
      327, 945, 787, 630, 472, 315, 980, 817, 653, 490, 327, 971, 810, 648, 486,
      323, 972, 810, 648, 486, 324, 955, 796, 637, 478, 318, 986, 822, 658, 493,
      329, 982, 818, 654, 491, 327, 1012, 844, 675, 506, 338, 1022, 852, 682, 511,
      341, 982, 818, 654, 491, 327, 967, 806, 645, 484, 322, 910, 758, 607, 455,
      304, 941, 784, 627, 471, 314, 993, 827, 662, 496, 331, 955, 796, 637, 478,
      318, 957, 798, 638, 478, 319, 973, 810, 648, 486, 325, 1023, 852, 682, 512,
      341, 1118, 932, 745, 559, 373, 1160, 967, 773, 580, 387, 1172, 976, 781, 586,
      390, 1263, 1053, 842, 632, 421, 1262, 1052, 841, 631, 421, 1292, 1077, 861,
      646, 431, 1286, 1072, 857, 643, 429, 1320, 1100, 880, 660, 439, 1289, 1074,
      859, 645, 430, 1243, 1036, 829, 621, 414, 1216, 1014, 811, 608, 405, 1185,
      987, 790, 592, 395, 1125, 938, 750, 563, 375, 1120, 933, 746, 560, 373, 1115,
      929, 743, 557, 372, 1057, 881, 705, 529, 352, 1028, 856, 685, 514, 342, 982,
      818, 654, 491, 327, 950, 792, 634, 475, 317, 949, 791, 633, 474, 316, 885,
      737, 590, 442, 295, 889, 741, 593, 444, 296, 858, 715, 572, 429, 286, 833,
      694, 556, 417, 278, 814, 678, 542, 407, 271, 803, 669, 535, 401, 268, 768,
      640, 512, 384, 257, 740, 617, 494, 370, 247, 715, 596, 477, 358, 238, 629,
      524, 419, 315, 210, 561, 468, 374, 280, 187, 491, 410, 328, 246, 163, 467,
      389, 311, 233, 156, 430, 358, 286, 215, 143, 382, 319, 255, 191, 128, 378,
      315, 252, 189, 125, 318, 265, 212, 159, 105, 293, 244, 196, 147, 98, 242, 202,
      161, 121, 80, 216, 180, 144, 108, 71, 168, 140, 112, 84, 56, 142, 118, 95, 71,
      47, 113, 94, 76, 57, 38, 86, 72, 57, 43, 28, 61, 51, 41, 30, 20, 44, 37, 30,
      22, 15, 29, 24, 19, 15, 10, 20, 17, 13, 10, 7, 25, 20, 16, 12, 9, 284, 236,
      189, 142, 94, 337, 281, 225, 168, 112, 347, 289, 231, 174, 116, 341, 284, 227,
      171, 114, 348, 290, 232, 174, 115, 357, 297, 238, 178, 119, 343, 286, 229,
      171, 114, 368, 307, 246, 184, 123, 336, 280, 224, 168, 113, 349, 290, 232,
      174, 117, 334, 278, 223, 167, 111, 347, 289, 231, 173, 116, 332, 276, 221,
      166, 111, 301, 251, 201, 151, 100, 300, 250, 200, 150, 100, 322, 269, 215,
      161, 108, 286, 238, 191, 143, 96, 323, 269, 215, 161, 108, 319, 266, 213, 160,
      106, 290, 242, 194, 145, 97, 276, 230, 184, 138, 91, 288, 240, 192, 144, 96,
      296, 246, 197, 148, 99, 349, 290, 232, 174, 117, 369, 308, 246, 185, 123, 413,
      344, 276, 207, 138, 455, 379, 303, 228, 152, 490, 409, 327, 245, 164, 491,
      410, 328, 246, 163, 531, 442, 354, 265, 177, 570, 475, 380, 285, 189, 587,
      489, 391, 293, 196, 625, 520, 416, 312, 209, 668, 556, 445, 334, 223, 654,
      545, 436, 327, 217, 645, 537, 430, 322, 215, 688, 573, 459, 344, 229, 673,
      561, 449, 337, 224, 674, 562, 450, 337, 225, 696, 580, 464, 348, 233, 665,
      554, 443, 332, 222, 676, 563, 451, 338, 225, 671, 559, 447, 335, 224, 653,
      544, 435, 326, 218, 626, 522, 417, 313, 208, 615, 513, 410, 308, 205, 578,
      482, 386, 289, 193, 564, 470, 376, 282, 187, 535, 446, 357, 268, 178, 518,
      432, 345, 259, 172, 507, 422, 338, 254, 169, 508, 424, 339, 254, 169, 478,
      398, 318, 239, 159, 463, 386, 308, 231, 154, 471, 392, 314, 236, 157, 459,
      382, 306, 229, 153, 460, 383, 306, 230, 153, 452, 376, 301, 226, 151, 450,
      375, 300, 225, 151, 424, 354, 283, 212, 142, 382, 318, 254, 191, 127, 340,
      283, 226, 170, 113, 306, 255, 204, 153, 103, 302, 252, 201, 151, 101, 245,
      204, 163, 123, 82, 226, 188, 151, 113, 75, 188, 157, 126, 94, 63, 178, 148,
      118, 89, 59, 170, 142, 113, 85, 57, 148, 124, 99, 74, 50, 129, 108, 86, 64,
      43, 121, 101, 81, 60, 40, 119, 100, 80, 60, 39, 132, 110, 88, 66, 44, 107, 89,
      71, 54, 36, 111, 92, 74, 55, 37, 94, 78, 63, 47, 31, 93, 78, 62, 46, 31, 73,
      60, 48, 36, 25, 84, 70, 56, 42, 29, 79, 66, 53, 39, 26, 82, 69, 55, 41, 28,
      62, 52, 42, 31, 21, 70, 58, 47, 35, 24, 61, 50, 40, 30, 21, 50, 42, 33, 25,
      16, 35, 30, 24, 18, 11, 37, 31, 25, 19, 12, 28, 24, 19, 14, 10, 17, 14, 12, 9,
      6, 12, 10, 8, 6, 5, 6, 5, 4, 3, 1, 5, 4, 4, 3, 2, 3, 3, 2, 2, 1, 5, 4, 3, 2,
      2, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 1, 278, 232, 186, 139, 93, 292, 244, 195, 146, 97, 330, 275, 220,
      165, 110, 344, 286, 229, 172, 114, 328, 274, 219, 164, 109, 322, 269, 215,
      161, 108, 315, 262, 210, 157, 105, 338, 282, 226, 169, 113, 319, 266, 213,
      160, 106, 327, 272, 218, 163, 109, 307, 256, 205, 153, 102, 312, 260, 208,
      156, 103, 280, 233, 187, 140, 93, 307, 256, 205, 153, 102, 287, 240, 192, 144,
      95, 276, 230, 184, 138, 92, 265, 221, 177, 133, 88, 242, 202, 162, 121, 81,
      250, 208, 166, 125, 83, 239, 200, 160, 120, 79, 230, 192, 153, 115, 76, 234,
      195, 156, 117, 78, 245, 204, 164, 123, 82, 284, 237, 190, 142, 95, 308, 257,
      206, 154, 103, 349, 290, 232, 174, 117, 395, 329, 263, 198, 132, 415, 346,
      276, 207, 138, 454, 379, 303, 227, 152, 471, 393, 314, 236, 157, 500, 417,
      334, 250, 167, 538, 448, 358, 269, 179, 542, 452, 362, 271, 181, 576, 480,
      384, 288, 191, 574, 478, 383, 287, 191, 587, 490, 392, 294, 195, 590, 492,
      393, 295, 196, 596, 496, 397, 298, 199, 601, 500, 400, 300, 201, 592, 493,
      395, 296, 197, 590, 492, 393, 295, 196, 596, 496, 397, 298, 199, 574, 478,
      382, 287, 191, 562, 468, 375, 281, 187, 514, 428, 343, 257, 172, 533, 444,
      355, 266, 178, 490, 408, 327, 245, 164, 463, 386, 308, 231, 154, 470, 392,
      314, 235, 157, 446, 371, 297, 223, 148, 418, 348, 278, 209, 139, 444, 370,
      296, 222, 149, 417, 348, 278, 208, 139, 384, 320, 256, 192, 129, 391, 326,
      261, 195, 130, 366, 305, 244, 183, 122, 367, 306, 245, 183, 122, 354, 295,
      236, 177, 119, 324, 270, 216, 162, 107, 329, 274, 220, 165, 110, 294, 245,
      196, 147, 98, 263, 219, 175, 131, 88, 247, 206, 165, 124, 82, 248, 207, 165,
      124, 83, 209, 174, 139, 104, 70, 192, 160, 128, 96, 64, 162, 135, 108, 81, 55,
      153, 127, 102, 76, 51, 155, 129, 103, 78, 52, 150, 125, 100, 75, 50, 134, 111,
      89, 67, 44, 121, 101, 81, 60, 40, 115, 96, 76, 57, 38, 112, 94, 75, 56, 37,
      108, 90, 72, 54, 36, 112, 94, 75, 56, 37, 79, 66, 53, 39, 26, 88, 73, 58, 44,
      29, 69, 58, 46, 34, 23, 72, 60, 48, 36, 25, 60, 50, 40, 30, 19, 70, 58, 47,
      35, 24, 62, 52, 41, 31, 21, 68, 56, 45, 34, 23, 61, 51, 41, 31, 20, 47, 39,
      31, 23, 16, 46, 38, 30, 23, 15, 28, 23, 19, 14, 9, 28, 23, 19, 14, 9, 18, 15,
      12, 9, 6, 18, 15, 12, 9, 5, 10, 8, 7, 5, 4, 9, 8, 6, 4, 3, 6, 5, 4, 3, 3, 6,
      5, 4, 3, 3, 4, 3, 3, 2, 1, 3, 2, 2, 2, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0,
      0, 0, 1, 0, 0, 0, 0, 1
    ),
  )

  # run propop 5 regions with subregional migration ----
  output_propop_5r <- project_population(
    parameters = parameters_short_5r,
    fert_first = 16,
    fert_last = 50,
    share_born_female = 100 / 205,
    population = population_short_5r,
    binational = TRUE,
    subregional = "net"
  ) |>
    filter(year == 2024)

  # Check if components add up
  balance_check <- check_balance(output_propop_5r)

  expect_equal(balance_check$nonzeros, 0,
    info =
      "The components don't add up in at least one row"
  )
  expect_equal(balance_check$missings, 0,
    info =
      "There are missings in at least one row"
  )

  # run snapshot 5 subregions ----
  expect_snapshot(constructive::construct(output_propop_5r))


  # run propop 5 regions without subregional migration ----
  output_propop_5r_F <- project_population(
    parameters = parameters_short_5r,
    fert_first = 16,
    fert_last = 50,
    share_born_female = 100 / 205,
    population = population_short_5r,
    binational = TRUE,
    subregional = NULL
  ) |>
    filter(year == 2024)

  # Check if components add up
  balance_check <- check_balance(output_propop_5r_F)

  expect_equal(balance_check$nonzeros, 0,
    info =
      "The components don't add up in at least one row"
  )
  expect_equal(balance_check$missings, 0,
    info =
      "There are missings in at least one row"
  )

  # Remove additional column to enable fair comparison
  output_propop_5r_T <- output_propop_5r |>
    dplyr::select(-mig_sub)

  # Ensure that results with / without subregional are different ----
  expect_failure(expect_equal(output_propop_5r_T, output_propop_5r_F))

  # prepare comparison 1 vs 5 regions ----

  ## prepare data for comparison ----
  ### n in starting populations should be identical in both versions
  ### simplify to make comparable
  compare_pop1r <- population_short_1r |>
    select(-spatial_unit) |>
    arrange(year, nat, sex, age)
  ### simplify to make comparable
  compare_pop5r <- population_short_5r |>
    summarise(n_dec = sum(n_dec), .by = c(year, nat, sex, age)) |>
    arrange(year, nat, sex, age)

  # run equal starting populations ----
  expect_equal(compare_pop1r, compare_pop5r)

  ### parameters should be identical in both versions
  compare_params_1r <- parameters_short_1r |>
    dplyr::select(-spatial_unit) |>
    arrange(year, nat, sex, age)

  compare_params_5r <- parameters_short_5r |>
    # remove column that includes redundancy
    dplyr::select(-mig_sub, -spatial_unit) |>
    # remove redundant columns
    dplyr::distinct(year, nat, sex, age, .keep_all = TRUE) |>
    # multiply columns with number-of-people parameters
    # by number of regions to get the n right again
    dplyr::mutate_at(vars(imm_int_n, imm_nat_n, emi_nat_n, mig_nat_n), ~ . * 5) |>
    arrange(year, nat, sex, age)

  # run equal parameters ----
  expect_equal(compare_params_1r, compare_params_5r)


  ## equal projection results
  # simplify data for comparison
  output_super <- output_propop_1r |>
    select(year, age, sex, nat, n_dec) |>
    arrange(year, nat, sex, age)

  output_subregions <- output_propop_5r |>
    dplyr::mutate(
      n_check = sum(n_dec, na.rm = TRUE),
      .by = c(year, nat, sex, age)
    ) |>
    # remove column that includes redundancy
    dplyr::select(-n_dec, -spatial_unit) |>
    # rename n_check
    rename(n_dec = n_check) |>
    # remove redundant columns
    dplyr::distinct(year, nat, sex, age, .keep_all = TRUE) |>
    select(year, age, sex, nat, n_dec) |>
    arrange(year, nat, sex, age)

  # run equal output ----
  expect_equal(output_super, output_subregions, ignore_attr = TRUE)
})

options(cli.default_handler = NULL)



# Unexpected input regarding nationalities ----

test_that("Error when binational is FALSE but column `nat` is present", {
  expect_error(
    project_population(
      parameters = fso_parameters,
      fert_first = 16,
      fert_last = 50,
      share_born_female = 100 / 205,
      population = fso_population,
      binational = FALSE,
      subregional = FALSE
    )
  )
})


test_that("Error when only 1 nationality in parameters", {
  expect_error(
    project_population(
      # remove non-Swiss nationals
      parameters = fso_parameters |>
        # remove non-Swiss nationals
        dplyr::filter(nat != "int"),
      fert_first = 16,
      fert_last = 50,
      share_born_female = 100 / 205,
      population = fso_population,
      binational = TRUE,
      subregional = FALSE
    )
  )
})

test_that("Error when only 1 nationality in population", {
  expect_error(
    project_population(
      # remove non-Swiss nationals
      parameters = fso_parameters,
      fert_first = 16,
      fert_last = 50,
      share_born_female = 100 / 205,
      population = fso_population |>
        # remove Swiss nationals
        dplyr::filter(nat == "int"),
      binational = TRUE,
      subregional = FALSE
    )
  )
})

test_that("Error if there are unexpected factor levels in pop `nat`", {
  expect_error(
    project_population(
      # remove non-Swiss nationals
      parameters = fso_parameters,
      fert_first = 16,
      fert_last = 50,
      share_born_female = 100 / 205,
      population = fso_population |>
        # replace factor level
        dplyr::mutate(nat = case_match(
          nat,
          "ch" ~ "swiss",
          .default = nat
        )),
      binational = TRUE,
      subregional = FALSE
    )
  )
})

#  comparison of  `subregional = "net" and the other one?
