# run and compare projection for 1 and 5 region(s)

test_that("project_raw 0-50 year olds 1 vs. 5 regions", {
  skip_on_ci()


  options(cli.default_handler = function(...) { })

  # Snapshot 1 region ----

  # Create short version of fso parameters
  # nolint start
  fso_parameters |>
    dplyr::filter(year < 2026 & scen == "reference") |>
    constructive::construct()
  # nolint end
  parameters_short <- tibble::tibble(
    nat = rep(c("ch", "int"), each = 202L),
    sex = rep(rep(c("m", "f"), 2), each = 101L),
    age = rep(seq(0, 100, by = 1), 4),
    start_n = c(
      0, 2481, 2452, 2595, 2935, 2804, 2827, 2814, 2816, 2760, 2869, 2901, 2799,
      2812, 2847, 2872, 2759, 2823, 2705, 2781, 2767, 2764, 2724, 2683, 2637, 2859,
      2793, 2851, 2880, 3042, 2830, 2865, 3109, 3225, 3212, 3248, 3250, 3254, 3220,
      3315, 3186, 3331, 3308, 3344, 3311, 3327, 3169, 3124, 3119, 2960, 3035, 3218,
      3263, 3392, 3569, 3717, 3781, 4030, 4102, 4129, 4220, 4267, 4053, 4020, 3889,
      3689, 3562, 3417, 3387, 3245, 3182, 3016, 2937, 2822, 2598, 2624, 2500, 2523,
      2419, 2334, 2169, 2031, 1908, 1624, 1461, 1119, 1012, 965, 820, 659, 600, 505,
      378, 326, 247, 187, 119, 88, 54, 24, 45, 0, 2371, 2344, 2477, 2728, 2570,
      2608, 2637, 2697, 2687, 2670, 2631, 2613, 2690, 2638, 2809, 2628, 2729, 2595,
      2602, 2561, 2636, 2582, 2554, 2541, 2654, 2752, 2715, 2834, 2865, 2896, 2961,
      2967, 3223, 3222, 3324, 3213, 3330, 3301, 3307, 3250, 3348, 3327, 3426, 3451,
      3314, 3258, 3067, 3164, 3329, 3204, 3209, 3260, 3426, 3738, 3873, 3911, 4209,
      4202, 4300, 4280, 4390, 4286, 4131, 4040, 3922, 3730, 3711, 3694, 3500, 3399,
      3244, 3139, 3131, 2915, 2925, 2819, 2734, 2665, 2623, 2503, 2404, 2312, 2025,
      1795, 1562, 1471, 1340, 1178, 1147, 951, 862, 697, 609, 463, 381, 296, 218,
      150, 106, 162, 0, 1173, 994, 1127, 1165, 1149, 1170, 1199, 1160, 1238, 1135,
      1172, 1121, 1155, 1103, 1002, 994, 1062, 952, 1074, 1089, 1010, 974, 1029,
      1069, 1254, 1334, 1482, 1627, 1742, 1754, 1882, 2006, 2060, 2174, 2305, 2259,
      2228, 2352, 2299, 2295, 2353, 2246, 2274, 2248, 2185, 2094, 2055, 1932, 1882,
      1785, 1729, 1687, 1690, 1588, 1537, 1557, 1512, 1506, 1473, 1468, 1378, 1247,
      1104, 986, 961, 756, 709, 610, 578, 554, 483, 419, 392, 386, 427, 346, 357,
      303, 299, 233, 269, 253, 262, 199, 223, 191, 155, 109, 112, 83, 50, 33, 15,
      13, 8, 11, 5, 2, 0, 0, 0, 1127, 987, 994, 1113, 1155, 1106, 1089, 1062, 1136,
      1071, 1091, 1024, 1031, 926, 1002, 934, 896, 861, 792, 826, 811, 803, 843,
      901, 1041, 1132, 1269, 1422, 1491, 1614, 1663, 1750, 1863, 1869, 1968, 1956,
      1993, 1993, 2007, 2015, 1981, 1972, 1987, 1913, 1872, 1716, 1774, 1635, 1546,
      1566, 1486, 1396, 1479, 1391, 1282, 1298, 1213, 1208, 1161, 1055, 1068, 955,
      853, 801, 797, 683, 629, 534, 505, 510, 492, 438, 397, 378, 369, 354, 368,
      259, 286, 225, 234, 194, 226, 200, 215, 195, 147, 140, 86, 84, 53, 52, 29, 24,
      17, 17, 10, 7, 3, 4
    ),
    year = rep(2025, 404L),
    scen = rep("reference", 404L),
    spatial_unit = rep("Aargau", 404L),
    birthrate = rep(
      c(
        0, 0.000764, 0.001165, 0.00265, 0.005423, 0.009798, 0.016558, 0.025273,
        0.03643, 0.049419, 0.064995, 0.081562, 0.098485, 0.113969, 0.124791, 0.128426,
        0.123673, 0.110565, 0.092099, 0.071365, 0.051621, 0.035345, 0.023476,
        0.015111, 0.009548, 0.006091, 0.004036, 0.002701, 0.001833, 0.001298, 0.00126,
        0.000899, 0, 0.00113, 0.004698, 0.01012, 0.018029, 0.027728, 0.038369,
        0.050934, 0.065229, 0.080512, 0.09604, 0.110943, 0.124577, 0.135363, 0.140837,
        0.142564, 0.137699, 0.12893, 0.116623, 0.102113, 0.086141, 0.070237, 0.056359,
        0.043176, 0.032162, 0.023168, 0.016219, 0.011078, 0.00732, 0.004812, 0.002914,
        0.001693, 0.000611, 0.000646, 0
      ),
      rep(c(120L, 1L, 169L, 1L, 51L), c(1L, 31L, 1L, 33L, 1L))
    ),
    int_mothers = rep(0.25, 404L),
    mor = c(
      0.003221, 0.000398, 0.000404, 0.000382, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.000359, 0.000351, 0.000368, 0.000359, 0.000361, 0.000362, 0.000367,
      0.000373, 0.00038, 0.000351, 0.000359, 0.000352, 0.000348, 0.000329, 0.000352,
      0.000347, 0.00032, 0.000616, 0.000617, 0.00061, 0.00061, 0.000609, 0.000616,
      0.000599, 0.000623, 0.000596, 0.000901, 0.000891, 9e-04, 0.000896, 0.001255,
      0.001273, 0.001275, 0.00168, 0.001639, 0.001856, 0.002136, 0.00235, 0.002514,
      0.002952, 0.003431, 0.003717, 0.00414, 0.004355, 0.004972, 0.005387, 0.005671,
      0.006214, 0.006686, 0.007339, 0.00786, 0.008484, 0.009449, 0.010174, 0.011006,
      0.011942, 0.013626, 0.014888, 0.016939, 0.019062, 0.021604, 0.024584, 0.02853,
      0.032998, 0.037814, 0.044324, 0.050839, 0.059132, 0.067762, 0.077748,
      0.088977, 0.10057, 0.112195, 0.125853, 0.136553, 0.146535, 0.161162, 0.177914,
      0.194332, 0.219251, 0.243697, 0.272727, 0.296296, 0.333333, 0.377778,
      0.002957, 0.000418, 0.000423, 4e-04, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0.000377, 0.000364, 0.000369, 0.000353, 0.000348,
      0.000344, 0.000336, 0.000335, 0.000308, 0.000308, 0.000298, 0.000308,
      0.000297, 3e-04, 0.000299, 0.00061, 0.000592, 0.000597, 0.00058, 0.000576,
      6e-04, 0.000916, 0.000973, 0.000945, 0.001198, 0.001244, 0.001242, 0.001529,
      0.001455, 0.001869, 0.002063, 0.002043, 0.002374, 0.002616, 0.002789,
      0.003036, 0.003415, 0.003732, 0.004113, 0.004459, 0.004847, 0.005361,
      0.005928, 0.0065, 0.007144, 0.007652, 0.008634, 0.009557, 0.010543, 0.01167,
      0.012996, 0.014904, 0.016825, 0.019137, 0.022112, 0.02517, 0.029124, 0.033737,
      0.039003, 0.04567, 0.053743, 0.063222, 0.074571, 0.087399, 0.101045, 0.117647,
      0.134415, 0.151862, 0.170632, 0.18986, 0.212598, 0.232715, 0.256293, 0.28,
      0.301887, 0.356923, 0.003397, 0.000851, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0.001009, 0.000945, 0.001046, 0.00092, 0.000903, 0.000964, 0.000991,
      0.000933, 0.000894, 0.000766, 0.000719, 0.00065, 0.000594, 0.000556, 0.000551,
      0.000516, 0.000486, 0.000474, 0.000451, 0.000427, 0.000436, 0.000442,
      0.000421, 0.000431, 0.000432, 0.000846, 0.000886, 0.000877, 0.000888,
      0.000914, 0.000954, 0.000973, 0.001034, 0.001593, 0.001679, 0.001734,
      0.001779, 0.001777, 0.001891, 0.001956, 0.00258, 0.002662, 0.00335, 0.003423,
      0.004135, 0.004389, 0.004864, 0.00551, 0.007243, 0.007531, 0.008136, 0.009957,
      0.011542, 0.012163, 0.014532, 0.014553, 0.016787, 0.017926, 0.020833,
      0.021176, 0.023188, 0.025281, 0.026446, 0.030151, 0.030238, 0.033645,
      0.035714, 0.042065, 0.045226, 0.053812, 0.062992, 0.07767, 0.092166, 0.107623,
      0.145455, 0.18, 0.212121, 0.266667, 0.230769, 0.375, 0.363636, 0.4, 0.5, 0, 0,
      0.002659, 0.000881, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0.000842, 0.000754, 0.000677, 0.000647, 0.000602, 0.000587,
      0.00056, 0.000528, 0.000528, 0.000503, 0.000507, 0.000498, 0.000499, 0.000496,
      0.000495, 0.000504, 0.000507, 0.000503, 0.000523, 0.000534, 0.000583,
      0.000564, 0.000611, 0.001292, 0.001276, 0.001345, 0.00143, 0.001352, 0.001437,
      0.001559, 0.002318, 0.002486, 0.002503, 0.00261, 0.002876, 0.003788, 0.003176,
      0.003557, 0.00507, 0.00506, 0.005887, 0.006385, 0.005629, 0.005946, 0.007866,
      0.008155, 0.009153, 0.010088, 0.010596, 0.013569, 0.014144, 0.016327,
      0.019305, 0.021016, 0.022272, 0.025696, 0.030848, 0.035477, 0.0399, 0.051044,
      0.05641, 0.068027, 0.078853, 0.093023, 0.107143, 0.132075, 0.153846, 0.175439,
      0.170213, 0.235294, 0.235294, 0.3, 0.285714, 0.333333, 0.25
    ),
    emi_int = c(
      0.001624, 0.004434, 0.004486, 0.004239, 0.004089, 0.003566, 0.003537,
      0.003198, 0.002841, 0.002899, 0.00244, 0.002068, 0.001786, 0.001778, 0.001405,
      0.001393, 0.00145, 0.002125, 0.002588, 0.003236, 0.003975, 0.004703, 0.00514,
      0.005218, 0.005309, 0.005946, 0.006087, 0.005963, 0.005903, 0.005588, 0.0053,
      0.004887, 0.004825, 0.004651, 0.004359, 0.00431, 0.004, 0.003995, 0.003727,
      0.00362, 0.003453, 0.003302, 0.003023, 0.00299, 0.00302, 0.003006, 0.00284,
      0.002561, 0.002565, 0.002703, 0.002636, 0.002797, 0.002758, 0.003243,
      0.003362, 0.003497, 0.003703, 0.004218, 0.004632, 0.004844, 0.004502,
      0.004453, 0.004441, 0.003731, 0.0036, 0.005693, 0.004492, 0.003219, 0.003248,
      0.003082, 0.002828, 0.002321, 0.002043, 0.001772, 0.00154, 0.001524, 0.0012,
      0.001189, 0.000827, 0.000857, 0.000922, 0.000985, 0.000524, 0.000616,
      0.000684, 0.000894, 0.000988, 0.001036, 0.00122, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0.002559, 0.004639, 0.004693, 0.004441, 0.004399, 0.00428, 0.003451,
      0.003413, 0.002966, 0.002605, 0.002622, 0.002281, 0.001914, 0.001859,
      0.001516, 0.001424, 0.001522, 0.001832, 0.002312, 0.003075, 0.003514,
      0.004552, 0.005035, 0.00509, 0.00551, 0.005652, 0.005451, 0.005525, 0.005293,
      0.005236, 0.004834, 0.004728, 0.004382, 0.004034, 0.004035, 0.003911,
      0.003424, 0.003003, 0.003029, 0.003024, 0.002769, 0.002688, 0.002705,
      0.002627, 0.002608, 0.002414, 0.002762, 0.002608, 0.002845, 0.002704,
      0.002809, 0.003116, 0.003067, 0.003503, 0.003478, 0.003615, 0.00358, 0.003564,
      0.003332, 0.003256, 0.003271, 0.003189, 0.003033, 0.002905, 0.003218, 0.00255,
      0.002145, 0.001617, 0.001354, 0.000857, 0.000883, 0.000925, 0.000637,
      0.000639, 0.000686, 0.000684, 0.000709, 0.000366, 0.000375, 0.000381, 4e-04,
      0.000416, 0.000433, 0.000494, 0.000557, 0.00064, 0.00068, 0, 0.000849, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00515, 0.036658, 0.031187, 0.026619, 0.022318,
      0.019147, 0.017094, 0.015013, 0.012069, 0.011309, 0.009692, 0.009386,
      0.008029, 0.006926, 0.006346, 0.005988, 0.006036, 0.006591, 0.009454,
      0.013966, 0.019284, 0.023762, 0.029774, 0.033042, 0.035547, 0.03748, 0.037481,
      0.036437, 0.036263, 0.035591, 0.034208, 0.032944, 0.031904, 0.031068,
      0.029899, 0.029501, 0.028331, 0.027828, 0.027211, 0.026533, 0.025708,
      0.025499, 0.024488, 0.023747, 0.023132, 0.022426, 0.021968, 0.021411,
      0.020704, 0.020191, 0.019608, 0.019086, 0.018969, 0.018935, 0.019521,
      0.020169, 0.021837, 0.02381, 0.025896, 0.025119, 0.027929, 0.021045, 0.025662,
      0.031703, 0.043611, 0.07076, 0.054233, 0.022567, 0.014754, 0.013841, 0.012635,
      0.010352, 0.011933, 0.010204, 0.010363, 0.009368, 0.008671, 0.008403,
      0.006601, 0.006689, 0.008584, 0.007435, 0.003953, 0.003817, 0.005025,
      0.004484, 0.005236, 0.006452, 0.009174, 0.008929, 0.012048, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0.002705, 0.028394, 0.026342, 0.024145, 0.02336, 0.020779,
      0.018987, 0.016529, 0.014124, 0.012324, 0.012138, 0.011916, 0.010742,
      0.010669, 0.010799, 0.010978, 0.010707, 0.011161, 0.012776, 0.013889,
      0.014528, 0.01603, 0.01868, 0.022539, 0.023307, 0.025937, 0.026502, 0.025217,
      0.025316, 0.025486, 0.025403, 0.025256, 0.024571, 0.023618, 0.021937,
      0.020833, 0.019427, 0.018565, 0.01706, 0.015944, 0.014888, 0.014134, 0.013692,
      0.013085, 0.012546, 0.011752, 0.011655, 0.011274, 0.011009, 0.010349,
      0.010217, 0.010094, 0.010029, 0.010142, 0.010784, 0.01248, 0.015408, 0.019786,
      0.023179, 0.02584, 0.029384, 0.029026, 0.029319, 0.029308, 0.037453, 0.023839,
      0.020498, 0.015898, 0.013109, 0.011881, 0.011765, 0.010163, 0.009132,
      0.010076, 0.010582, 0.01084, 0.011299, 0.01087, 0.011583, 0.013986, 0.013333,
      0.012821, 0.010309, 0.013274, 0.01, 0.009302, 0.010256, 0.013605, 0.014286,
      0.011628, 0.011905, 0.018868, 0.019231, 0.034483, 0.041667, 0, 0, 0, 0, 0, 0
    ),
    emi_nat = c(
      0.008932, 0.020556, 0.022023, 0.018882, 0.016014, 0.013909, 0.012027,
      0.010306, 0.008878, 0.007609, 0.006971, 0.00586, 0.005359, 0.004623, 0.004215,
      0.00383, 0.003987, 0.005313, 0.008503, 0.012945, 0.01807, 0.02424, 0.030837,
      0.03839, 0.045506, 0.051766, 0.056212, 0.057874, 0.057292, 0.054898, 0.051237,
      0.046771, 0.042457, 0.03814, 0.033935, 0.03048, 0.027385, 0.024585, 0.02236,
      0.020513, 0.018832, 0.017712, 0.016626, 0.01555, 0.014799, 0.013826, 0.013253,
      0.012804, 0.012183, 0.011486, 0.011203, 0.010876, 0.01042, 0.010024, 0.009526,
      0.009416, 0.008992, 0.008685, 0.008532, 0.008234, 0.00782, 0.007734, 0.007402,
      0.007214, 0.009, 0.012741, 0.006457, 0.006438, 0.0062, 0.005855, 0.005657,
      0.005637, 0.005448, 0.005315, 0.005004, 0.004954, 0.0048, 0.004756, 0.004547,
      0.004713, 0.00461, 0.004431, 0.004193, 0.00431, 0.004107, 0.003575, 0.003953,
      0.004145, 0.003659, 0.003035, 0.003333, 0.00396, 0.002646, 0.003067, 0.004049,
      0.005348, 0, 0, 0, 0, 0, 0.009808, 0.027836, 0.023038, 0.018975, 0.015762,
      0.01323, 0.01112, 0.00948, 0.008157, 0.007071, 0.006367, 0.005701, 0.005358,
      0.005204, 0.005307, 0.00534, 0.006469, 0.008428, 0.012331, 0.018832, 0.027724,
      0.039074, 0.050736, 0.061472, 0.070051, 0.074981, 0.075945, 0.074033,
      0.069866, 0.063874, 0.056975, 0.049983, 0.043141, 0.037232, 0.031968,
      0.027377, 0.023965, 0.021021, 0.018782, 0.016934, 0.015385, 0.014337,
      0.013526, 0.012843, 0.01217, 0.011768, 0.011357, 0.011086, 0.011062, 0.010814,
      0.010612, 0.010284, 0.010123, 0.009924, 0.009631, 0.009553, 0.009205,
      0.009028, 0.008805, 0.008605, 0.008411, 0.0082, 0.008166, 0.007746, 0.009653,
      0.008924, 0.007239, 0.007006, 0.006768, 0.006571, 0.006178, 0.006165,
      0.005734, 0.005749, 0.005489, 0.005128, 0.004966, 0.004755, 0.004503,
      0.004194, 0.003995, 0.00416, 0.003893, 0.003457, 0.003343, 0.003201, 0.003399,
      0.002985, 0.002547, 0.002616, 0.002103, 0.00232, 0.001435, 0.001642, 0.00216,
      0.002625, 0, 0, 0, 0, 0, 0.006009, 0.02387, 0.022133, 0.019521, 0.017167,
      0.015666, 0.013675, 0.01251, 0.011207, 0.009693, 0.008811, 0.007679, 0.007136,
      0.006061, 0.00544, 0.00499, 0.00503, 0.006591, 0.010504, 0.01676, 0.025712,
      0.034653, 0.044148, 0.052478, 0.058934, 0.062998, 0.064468, 0.064777,
      0.063921, 0.062572, 0.059863, 0.056854, 0.053838, 0.050971, 0.047838,
      0.045119, 0.042054, 0.039946, 0.03784, 0.035668, 0.033987, 0.032724, 0.031612,
      0.030783, 0.029804, 0.029291, 0.028176, 0.027737, 0.026915, 0.026036, 0.02521,
      0.02487, 0.023711, 0.022485, 0.021411, 0.020169, 0.019268, 0.018519, 0.017264,
      0.015614, 0.014986, 0.013788, 0.012831, 0.011775, 0.011156, 0.010406,
      0.010582, 0.008463, 0.008197, 0.00692, 0.00722, 0.006211, 0.004773, 0.005102,
      0.005181, 0.004684, 0.00289, 0.002801, 0.0033, 0.003344, 0.004292, 0.003717,
      0.003953, 0.003817, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.004509, 0.023957, 0.021277, 0.019115, 0.017071, 0.015584, 0.013562,
      0.011938, 0.011299, 0.009683, 0.009337, 0.008249, 0.007813, 0.00679, 0.006479,
      0.005988, 0.005353, 0.007813, 0.013937, 0.025253, 0.038741, 0.050555,
      0.061021, 0.066429, 0.067703, 0.067243, 0.065371, 0.061466, 0.056962,
      0.052985, 0.048947, 0.044498, 0.040571, 0.037037, 0.033708, 0.030996, 0.02863,
      0.026091, 0.024084, 0.022422, 0.02134, 0.020192, 0.01927, 0.018621, 0.017773,
      0.017628, 0.017483, 0.016911, 0.017125, 0.016818, 0.016603, 0.016824,
      0.016476, 0.016227, 0.015816, 0.015601, 0.015408, 0.014839, 0.014073, 0.01292,
      0.012322, 0.011236, 0.009424, 0.008206, 0.007491, 0.006274, 0.004392,
      0.004769, 0.003745, 0.00396, 0.003922, 0.004065, 0.004566, 0.005038, 0.002646,
      0.00271, 0.002825, 0.002717, 0.003861, 0.003497, 0.004444, 0.004274, 0,
      0.004425, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    acq = rep(
      c(
        0, 0.000858, 0.01364, 0.014085, 0.014197, 0.014592, 0.015666, 0.016239,
        0.016681, 0.018966, 0.021002, 0.02467, 0.028157, 0.032114, 0.038095, 0.042611,
        0.043912, 0.045272, 0.045198, 0.038866, 0.021415, 0.016529, 0.015842,
        0.014374, 0.011662, 0.011225, 0.009569, 0.008246, 0.008097, 0.007376,
        0.006889, 0.006842, 0.007439, 0.007478, 0.008252, 0.00874, 0.009978, 0.010624,
        0.011221, 0.01233, 0.012614, 0.013072, 0.0136, 0.014248, 0.014072, 0.014235,
        0.014188, 0.013849, 0.014112, 0.013975, 0.013284, 0.012325, 0.012146,
        0.011855, 0.011243, 0.010705, 0.01041, 0.009634, 0.009259, 0.008632, 0.008147,
        0.008174, 0.007257, 0.007217, 0.006341, 0.006085, 0.005203, 0.005291,
        0.004231, 0.004918, 0.00346, 0.00361, 0.004141, 0.002387, 0.002551, 0.002591,
        0.002342, 0.00289, 0.002801, 0.0033, 0.003344, 0.004292, 0.003717, 0.003953,
        0, 0.000902, 0.020408, 0.01925, 0.017103, 0.016173, 0.015584, 0.015371,
        0.016529, 0.017891, 0.022007, 0.024276, 0.029331, 0.032227, 0.037827,
        0.043197, 0.047904, 0.050321, 0.049107, 0.045296, 0.037879, 0.033898, 0.02836,
        0.023661, 0.021352, 0.017758, 0.01537, 0.011484, 0.009456, 0.007736, 0.008048,
        0.008055, 0.009621, 0.011429, 0.011809, 0.013376, 0.014736, 0.015337,
        0.015554, 0.016056, 0.017439, 0.01737, 0.017668, 0.017748, 0.017111, 0.01725,
        0.017094, 0.0169, 0.016347, 0.014679, 0.014877, 0.014049, 0.013459, 0.012894,
        0.01217, 0.010784, 0.00936, 0.009245, 0.008244, 0.00745, 0.006891, 0.006635,
        0.005618, 0.005236, 0.004689, 0.003745, 0.003764, 0.002928, 0.00318, 0.001873,
        0.00198, 0.001961, 0.002033, 0.002283, 0
      ),
      rep(c(202L, 1L, 18L, 1L, 28L), c(1L, 83L, 1L, 73L, 1L))
    ),
    imm_int_n = c(
      5, 17, 16, 16, 15, 14, 14, 13, 12, 11, 10, 9, 8, 7, 6, 6, 5, 5, 5, 6, 8, 9,
      11, 12, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 13, 13, 12, 12, 12, 11, 11,
      11, 10, 10, 9, 9, 8, 8, 8, 8, 9, 9, 10, 11, 11, 12, 12, 11, 11, 11, 10, 9, 9,
      9, 8, 7, 7, 7, 6, 6, 6, 5, 5, 5, 4, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1,
      1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 15, 15, 14, 13, 12, 11, 10, 9, 8, 8, 7,
      6, 6, 6, 6, 6, 7, 6, 6, 7, 8, 9, 9, 10, 11, 12, 12, 13, 14, 14, 14, 14, 14,
      14, 14, 13, 13, 12, 11, 10, 10, 9, 8, 7, 7, 7, 6, 6, 6, 6, 7, 7, 7, 7, 7, 6,
      6, 6, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 4, 4, 4, 4, 3, 3, 3, 3, 3, 2, 2, 2, 2,
      2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 14, 55, 53, 51, 49, 47,
      47, 46, 45, 45, 44, 44, 43, 42, 40, 38, 38, 40, 47, 58, 72, 89, 107, 124, 138,
      149, 158, 163, 165, 165, 163, 159, 154, 147, 140, 134, 127, 120, 114, 107,
      101, 95, 90, 85, 80, 75, 71, 67, 64, 60, 57, 53, 50, 46, 43, 38, 34, 29, 25,
      22, 19, 16, 13, 11, 9, 8, 7, 6, 5, 4, 3, 3, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18, 57, 53, 50, 48, 46,
      45, 44, 42, 41, 40, 40, 38, 37, 35, 33, 31, 30, 30, 37, 51, 72, 93, 113, 127,
      136, 140, 140, 137, 132, 126, 119, 112, 105, 98, 92, 86, 81, 76, 71, 67, 63,
      59, 55, 52, 49, 47, 44, 42, 40, 38, 36, 34, 32, 29, 27, 23, 21, 18, 15, 13,
      12, 10, 8, 7, 6, 5, 5, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
      1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    imm_nat_n = c(
      51, 94, 84, 73, 64, 50, 41, 34, 30, 26, 23, 21, 19, 18, 17, 16, 16, 18, 20,
      25, 35, 50, 68, 88, 103, 121, 128, 138, 147, 155, 155, 156, 155, 154, 148,
      137, 124, 114, 101, 93, 83, 78, 69, 65, 59, 56, 52, 47, 46, 43, 42, 42, 41,
      40, 40, 39, 38, 38, 39, 39, 37, 38, 35, 34, 35, 36, 29, 25, 22, 18, 15, 14,
      13, 12, 11, 10, 9, 9, 8, 8, 7, 7, 6, 5, 5, 4, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 0,
      0, 0, 0, 0, 57, 85, 76, 67, 62, 46, 39, 33, 27, 23, 20, 18, 15, 14, 13, 13,
      15, 20, 33, 51, 72, 96, 115, 138, 157, 182, 186, 186, 184, 181, 169, 160, 152,
      146, 135, 125, 113, 103, 91, 84, 76, 68, 61, 56, 49, 46, 42, 39, 38, 38, 37,
      39, 40, 41, 43, 42, 43, 42, 41, 41, 42, 42, 40, 38, 37, 33, 29, 25, 21, 19,
      17, 16, 15, 14, 12, 12, 11, 11, 10, 10, 9, 8, 8, 7, 6, 6, 5, 5, 4, 4, 3, 3, 2,
      1, 1, 1, 1, 1, 0, 0, 1, 19, 35, 28, 26, 26, 22, 21, 20, 19, 18, 16, 15, 13,
      13, 12, 12, 12, 14, 17, 23, 31, 40, 49, 61, 74, 92, 104, 114, 124, 130, 133,
      135, 138, 139, 137, 135, 128, 127, 117, 112, 106, 98, 91, 86, 80, 77, 69, 65,
      59, 55, 49, 47, 41, 39, 36, 34, 32, 30, 26, 25, 22, 20, 17, 14, 12, 12, 9, 7,
      5, 5, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 20, 42, 33, 29, 27, 23, 20, 18, 16, 14, 12, 11, 9, 8, 7,
      6, 7, 9, 13, 21, 33, 42, 52, 61, 70, 81, 88, 95, 102, 104, 103, 97, 96, 90,
      84, 80, 74, 69, 63, 58, 54, 50, 44, 41, 39, 36, 33, 32, 31, 30, 28, 27, 26,
      25, 24, 23, 21, 19, 17, 15, 14, 13, 11, 9, 8, 8, 7, 5, 4, 4, 3, 2, 2, 2, 2, 2,
      2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    emi_nat_n = c(
      22, 51, 54, 49, 47, 39, 34, 29, 25, 21, 20, 17, 15, 13, 12, 11, 11, 15, 23,
      36, 50, 67, 84, 103, 120, 148, 157, 165, 165, 167, 145, 134, 132, 123, 109,
      99, 89, 80, 72, 68, 60, 59, 55, 52, 49, 46, 42, 40, 38, 34, 34, 35, 34, 34,
      34, 35, 34, 35, 35, 34, 33, 33, 30, 29, 35, 47, 23, 22, 21, 19, 18, 17, 16,
      15, 13, 13, 12, 12, 11, 11, 10, 9, 8, 7, 6, 4, 4, 4, 3, 2, 2, 2, 1, 1, 1, 1,
      0, 0, 0, 0, 0, 23, 66, 54, 47, 43, 34, 29, 25, 22, 19, 17, 15, 14, 14, 14, 15,
      17, 23, 32, 49, 71, 103, 131, 157, 178, 199, 209, 201, 198, 183, 165, 148,
      128, 120, 103, 91, 77, 70, 62, 56, 50, 48, 45, 44, 42, 39, 37, 34, 35, 36, 34,
      33, 33, 34, 36, 37, 36, 38, 37, 37, 36, 36, 35, 32, 39, 35, 27, 26, 25, 23,
      21, 20, 18, 18, 16, 15, 14, 13, 12, 11, 10, 10, 9, 7, 6, 5, 5, 4, 3, 3, 2, 2,
      1, 1, 1, 1, 0, 0, 0, 0, 0, 7, 28, 22, 22, 20, 18, 16, 15, 13, 12, 10, 9, 8, 7,
      6, 5, 5, 7, 10, 18, 28, 35, 43, 54, 63, 79, 86, 96, 104, 109, 105, 107, 108,
      105, 104, 104, 95, 89, 89, 82, 78, 77, 71, 70, 67, 64, 59, 57, 52, 49, 45, 43,
      40, 38, 34, 31, 30, 28, 26, 23, 22, 19, 16, 13, 11, 10, 8, 6, 5, 4, 4, 3, 2,
      2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 5, 27, 21, 19, 19, 18, 15, 13, 12, 11, 10, 9, 8, 7, 6, 6, 5, 7, 12, 20,
      32, 41, 49, 56, 61, 70, 74, 78, 81, 79, 79, 74, 71, 69, 63, 61, 56, 52, 48,
      45, 43, 40, 38, 37, 34, 33, 30, 30, 28, 26, 26, 25, 23, 24, 22, 20, 20, 18,
      17, 15, 13, 12, 9, 7, 6, 5, 3, 3, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 0,
      1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    mig_nat_n = c(
      29, 43, 30, 24, 17, 11, 7, 5, 5, 5, 3, 4, 4, 5, 5, 5, 5, 3, -3, -11, -15, -17,
      -16, -15, -17, -27, -29, -27, -18, -12, 10, 22, 23, 31, 39, 38, 35, 34, 29,
      25, 23, 19, 14, 13, 10, 10, 10, 7, 8, 9, 8, 7, 7, 6, 6, 4, 4, 3, 4, 5, 4, 5,
      5, 5, 0, -11, 6, 3, 1, -1, -3, -3, -3, -3, -2, -3, -3, -3, -3, -3, -3, -2, -2,
      -2, -1, 0, -1, -1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 34, 19, 22, 20, 19,
      12, 10, 8, 5, 4, 3, 3, 1, 0, -1, -2, -2, -3, 1, 2, 1, -7, -16, -19, -21, -17,
      -23, -15, -14, -2, 4, 12, 24, 26, 32, 34, 36, 33, 29, 28, 26, 20, 16, 12, 7,
      7, 5, 5, 3, 2, 3, 6, 7, 7, 7, 5, 7, 4, 4, 4, 6, 6, 5, 6, -2, -2, 2, -1, -4,
      -4, -4, -4, -3, -4, -4, -3, -3, -2, -2, -1, -1, -2, -1, 0, 0, 1, 0, 1, 1, 1,
      1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 12, 7, 6, 4, 6, 4, 5, 5, 6, 6, 6, 6, 5, 6, 6,
      7, 7, 7, 7, 5, 3, 5, 6, 7, 11, 13, 18, 18, 20, 21, 28, 28, 30, 34, 33, 31, 33,
      38, 28, 30, 28, 21, 20, 16, 13, 13, 10, 8, 7, 6, 4, 4, 1, 1, 2, 3, 2, 2, 0, 2,
      0, 1, 1, 1, 1, 2, 1, 1, 0, 1, -1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 15, 12, 10, 8, 5, 5, 5, 4, 3,
      2, 2, 1, 1, 1, 0, 2, 2, 1, 1, 1, 1, 3, 5, 9, 11, 14, 17, 21, 25, 24, 23, 25,
      21, 21, 19, 18, 17, 15, 13, 11, 10, 6, 4, 5, 3, 3, 2, 3, 4, 2, 2, 3, 1, 2, 3,
      1, 1, 0, 0, 1, 1, 2, 2, 2, 3, 4, 2, 2, 2, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0,
      1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    fso_projection_n = c(
      2486, 2545, 2500, 2639, 2972, 2837, 2857, 2843, 2847, 2794, 2903, 2941, 2842,
      2863, 2901, 2923, 2809, 2872, 2736, 2789, 2766, 2758, 2718, 2677, 2630, 2840,
      2771, 2832, 2870, 3038, 2850, 2900, 3145, 3270, 3267, 3306, 3306, 3310, 3276,
      3366, 3237, 3380, 3351, 3386, 3349, 3364, 3203, 3156, 3150, 2989, 3061, 3240,
      3284, 3409, 3582, 3725, 3785, 4026, 4094, 4119, 4206, 4249, 4035, 4001, 3863,
      3642, 3535, 3390, 3354, 3209, 3143, 2977, 2894, 2778, 2553, 2572, 2445, 2459,
      2349, 2256, 2086, 1940, 1811, 1527, 1362, 1032, 921, 867, 728, 577, 519, 431,
      318, 268, 199, 146, 90, 64, 38, 16, 28, 2371, 2416, 2388, 2516, 2766, 2601,
      2637, 2664, 2722, 2717, 2700, 2667, 2648, 2730, 2679, 2857, 2675, 2772, 2635,
      2632, 2588, 2648, 2581, 2549, 2532, 2648, 2738, 2708, 2828, 2873, 2912, 2988,
      3011, 3271, 3279, 3387, 3280, 3396, 3363, 3370, 3310, 3402, 3376, 3469, 3487,
      3350, 3287, 3096, 3185, 3347, 3222, 3228, 3277, 3441, 3747, 3875, 3914, 4204,
      4196, 4292, 4272, 4379, 4273, 4118, 4015, 3899, 3711, 3689, 3667, 3474, 3371,
      3214, 3109, 3096, 2878, 2885, 2775, 2688, 2614, 2565, 2440, 2333, 2234, 1947,
      1714, 1480, 1378, 1242, 1076, 1033, 841, 748, 593, 506, 376, 300, 228, 163,
      108, 74, 105, 1180, 1175, 1008, 1136, 1177, 1160, 1183, 1212, 1175, 1249,
      1146, 1178, 1124, 1151, 1095, 997, 987, 1053, 959, 1098, 1124, 1063, 1043,
      1113, 1167, 1356, 1448, 1596, 1740, 1853, 1872, 1992, 2110, 2159, 2262, 2378,
      2330, 2298, 2400, 2345, 2334, 2375, 2267, 2287, 2255, 2191, 2098, 2055, 1934,
      1882, 1786, 1729, 1683, 1683, 1582, 1528, 1540, 1489, 1474, 1443, 1428, 1350,
      1214, 1068, 940, 891, 713, 690, 596, 566, 539, 472, 408, 382, 374, 414, 336,
      346, 294, 289, 223, 257, 242, 250, 190, 211, 178, 142, 98, 99, 70, 41, 26, 11,
      10, 5, 7, 3, 1, 0, 0, 1135, 1143, 1007, 1013, 1125, 1164, 1118, 1102, 1074,
      1141, 1074, 1088, 1019, 1019, 912, 976, 910, 874, 842, 789, 838, 848, 865,
      924, 1000, 1145, 1242, 1381, 1532, 1597, 1709, 1746, 1823, 1922, 1921, 2008,
      1991, 2022, 2017, 2023, 2027, 1990, 1974, 1985, 1912, 1869, 1716, 1770, 1637,
      1549, 1566, 1487, 1399, 1477, 1390, 1282, 1287, 1198, 1186, 1135, 1028, 1040,
      931, 831, 773, 780, 672, 620, 529, 501, 503, 485, 432, 392, 373, 363, 348,
      361, 254, 279, 219, 227, 189, 217, 193, 205, 184, 137, 128, 78, 75, 46, 44,
      23, 19, 13, 13, 7, 5, 2, 3
    ),
  )

  # Create short version of fso population
  # nolint start
  # fso_population |>
  #   constructive::construct()
  # nolint end
  population_short <- tibble::tibble(
    year = rep(2024, 404L),
    spatial_unit = rep("Aargau", 404L),
    nat = rep(c("ch", "int"), each = 202L),
    sex = rep(rep(c("m", "f"), 2), each = 101L),
    age = rep(seq(0, 100, by = 1), 4),
    n = c(
      2461, 2481, 2452, 2595, 2935, 2804, 2827, 2814, 2816, 2760, 2869, 2901, 2799,
      2812, 2847, 2872, 2759, 2823, 2705, 2781, 2767, 2764, 2724, 2683, 2637, 2859,
      2793, 2851, 2880, 3042, 2830, 2865, 3109, 3225, 3212, 3248, 3250, 3254, 3220,
      3315, 3186, 3331, 3308, 3344, 3311, 3327, 3169, 3124, 3119, 2960, 3035, 3218,
      3263, 3392, 3569, 3717, 3781, 4030, 4102, 4129, 4220, 4267, 4053, 4020, 3889,
      3689, 3562, 3417, 3387, 3245, 3182, 3016, 2937, 2822, 2598, 2624, 2500, 2523,
      2419, 2334, 2169, 2031, 1908, 1624, 1461, 1119, 1012, 965, 820, 659, 600, 505,
      378, 326, 247, 187, 119, 88, 54, 24, 45, 2356, 2371, 2344, 2477, 2728, 2570,
      2608, 2637, 2697, 2687, 2670, 2631, 2613, 2690, 2638, 2809, 2628, 2729, 2595,
      2602, 2561, 2636, 2582, 2554, 2541, 2654, 2752, 2715, 2834, 2865, 2896, 2961,
      2967, 3223, 3222, 3324, 3213, 3330, 3301, 3307, 3250, 3348, 3327, 3426, 3451,
      3314, 3258, 3067, 3164, 3329, 3204, 3209, 3260, 3426, 3738, 3873, 3911, 4209,
      4202, 4300, 4280, 4390, 4286, 4131, 4040, 3922, 3730, 3711, 3694, 3500, 3399,
      3244, 3139, 3131, 2915, 2925, 2819, 2734, 2665, 2623, 2503, 2404, 2312, 2025,
      1795, 1562, 1471, 1340, 1178, 1147, 951, 862, 697, 609, 463, 381, 296, 218,
      150, 106, 162, 1197, 1173, 994, 1127, 1165, 1149, 1170, 1199, 1160, 1238,
      1135, 1172, 1121, 1155, 1103, 1002, 994, 1062, 952, 1074, 1089, 1010, 974,
      1029, 1069, 1254, 1334, 1482, 1627, 1742, 1754, 1882, 2006, 2060, 2174, 2305,
      2259, 2228, 2352, 2299, 2295, 2353, 2246, 2274, 2248, 2185, 2094, 2055, 1932,
      1882, 1785, 1729, 1687, 1690, 1588, 1537, 1557, 1512, 1506, 1473, 1468, 1378,
      1247, 1104, 986, 961, 756, 709, 610, 578, 554, 483, 419, 392, 386, 427, 346,
      357, 303, 299, 233, 269, 253, 262, 199, 223, 191, 155, 109, 112, 83, 50, 33,
      15, 13, 8, 11, 5, 2, 0, 0, 1152, 1127, 987, 994, 1113, 1155, 1106, 1089, 1062,
      1136, 1071, 1091, 1024, 1031, 926, 1002, 934, 896, 861, 792, 826, 811, 803,
      843, 901, 1041, 1132, 1269, 1422, 1491, 1614, 1663, 1750, 1863, 1869, 1968,
      1956, 1993, 1993, 2007, 2015, 1981, 1972, 1987, 1913, 1872, 1716, 1774, 1635,
      1546, 1566, 1486, 1396, 1479, 1391, 1282, 1298, 1213, 1208, 1161, 1055, 1068,
      955, 853, 801, 797, 683, 629, 534, 505, 510, 492, 438, 397, 378, 369, 354,
      368, 259, 286, 225, 234, 194, 226, 200, 215, 195, 147, 140, 86, 84, 53, 52,
      29, 24, 17, 17, 10, 7, 3, 4
    ),
  )

  # Run project_raw
  output_table <- project_raw(
    parameters = parameters_short |>
      dplyr::filter(scen == "reference"),
    year_first = 2025,
    year_last = 2025,
    age_groups = 101,
    fert_first = 16,
    fert_last = 50,
    share_born_female = 100 / 205,
    n = population_short |> dplyr::pull(n),
    subregional = FALSE
  )

  ## Run test for 1 region ----

  ## Compare results against those from previous run (saved in snapshot)
  expect_snapshot(constructive::construct(output_table))


  # Snapshot subregions ----

  # Create version with fictitious subregions
  # nolint start
  # fso_parameters |>
  #   dplyr::filter(year < 2026 & scen == "reference") |>
  #   # Create fictitious intra-cantonal migration parameter
  #   dplyr::rowwise() |>
  #   dplyr::mutate(
  #     mig_sub_1 = {set.seed(1); round(rnorm(1, mean = 0, sd = 0.2), digits = 4)},
  #     mig_sub_2 = {set.seed(2); round(rnorm(1, mean = 0, sd = 0.2), digits = 4)},
  #     mig_sub_3 = {set.seed(3); round(rnorm(1, mean = 0, sd = 0.2), digits = 4)},
  #     mig_sub_4 = {set.seed(4); round(rnorm(1, mean = 0, sd = 0.2), digits = 4)},
  #     mig_sub_5 = 0 - sum(mig_sub_1, mig_sub_2,mig_sub_3,mig_sub_4)
  #   ) |>
  #   pivot_longer(mig_sub_1:mig_sub_5,
  #                names_to = "subregion",
  #                values_to = "mig_sub") |>
  #   dplyr::mutate(spatial_unit = stringr::str_extract(subregion, "(?<=mig_sub_).*")) |>
  #   # divide the size of parameters with numbers by the number of regions (=5),
  #   # otherwise the multiplication of lines inflates the size of the population
  #   dplyr::mutate_at(vars(imm_int_n, imm_nat_n, emi_nat_n, mig_nat_n), ~ ./5) |>
  #   dplyr::select(-subregion) |>
  #   constructive::construct()
  # nolint end

  parameters_short_subregions <- tibble::tibble(
    nat = rep(c("ch", "int"), each = 1010L),
    sex = rep(rep(c("m", "f"), 2), each = 505L),
    age = rep(rep(seq(0, 100, by = 1), 4), each = 5L),
    start_n = rep(
      c(
        0, 2481, 2452, 2595, 2935, 2804, 2827, 2814, 2816, 2760, 2869, 2901, 2799,
        2812, 2847, 2872, 2759, 2823, 2705, 2781, 2767, 2764, 2724, 2683, 2637, 2859,
        2793, 2851, 2880, 3042, 2830, 2865, 3109, 3225, 3212, 3248, 3250, 3254, 3220,
        3315, 3186, 3331, 3308, 3344, 3311, 3327, 3169, 3124, 3119, 2960, 3035, 3218,
        3263, 3392, 3569, 3717, 3781, 4030, 4102, 4129, 4220, 4267, 4053, 4020, 3889,
        3689, 3562, 3417, 3387, 3245, 3182, 3016, 2937, 2822, 2598, 2624, 2500, 2523,
        2419, 2334, 2169, 2031, 1908, 1624, 1461, 1119, 1012, 965, 820, 659, 600, 505,
        378, 326, 247, 187, 119, 88, 54, 24, 45, 0, 2371, 2344, 2477, 2728, 2570,
        2608, 2637, 2697, 2687, 2670, 2631, 2613, 2690, 2638, 2809, 2628, 2729, 2595,
        2602, 2561, 2636, 2582, 2554, 2541, 2654, 2752, 2715, 2834, 2865, 2896, 2961,
        2967, 3223, 3222, 3324, 3213, 3330, 3301, 3307, 3250, 3348, 3327, 3426, 3451,
        3314, 3258, 3067, 3164, 3329, 3204, 3209, 3260, 3426, 3738, 3873, 3911, 4209,
        4202, 4300, 4280, 4390, 4286, 4131, 4040, 3922, 3730, 3711, 3694, 3500, 3399,
        3244, 3139, 3131, 2915, 2925, 2819, 2734, 2665, 2623, 2503, 2404, 2312, 2025,
        1795, 1562, 1471, 1340, 1178, 1147, 951, 862, 697, 609, 463, 381, 296, 218,
        150, 106, 162, 0, 1173, 994, 1127, 1165, 1149, 1170, 1199, 1160, 1238, 1135,
        1172, 1121, 1155, 1103, 1002, 994, 1062, 952, 1074, 1089, 1010, 974, 1029,
        1069, 1254, 1334, 1482, 1627, 1742, 1754, 1882, 2006, 2060, 2174, 2305, 2259,
        2228, 2352, 2299, 2295, 2353, 2246, 2274, 2248, 2185, 2094, 2055, 1932, 1882,
        1785, 1729, 1687, 1690, 1588, 1537, 1557, 1512, 1506, 1473, 1468, 1378, 1247,
        1104, 986, 961, 756, 709, 610, 578, 554, 483, 419, 392, 386, 427, 346, 357,
        303, 299, 233, 269, 253, 262, 199, 223, 191, 155, 109, 112, 83, 50, 33, 15,
        13, 8, 11, 5, 2, 0, 1127, 987, 994, 1113, 1155, 1106, 1089, 1062, 1136, 1071,
        1091, 1024, 1031, 926, 1002, 934, 896, 861, 792, 826, 811, 803, 843, 901,
        1041, 1132, 1269, 1422, 1491, 1614, 1663, 1750, 1863, 1869, 1968, 1956, 1993,
        2007, 2015, 1981, 1972, 1987, 1913, 1872, 1716, 1774, 1635, 1546, 1566, 1486,
        1396, 1479, 1391, 1282, 1298, 1213, 1208, 1161, 1055, 1068, 955, 853, 801,
        797, 683, 629, 534, 505, 510, 492, 438, 397, 378, 369, 354, 368, 259, 286,
        225, 234, 194, 226, 200, 215, 195, 147, 140, 86, 84, 53, 52, 29, 24, 17, 10,
        7, 3, 4
      ),
      rep(c(5L, 15L, 5L, 10L, 5L, 10L, 5L), c(301L, 1L, 36L, 1L, 56L, 1L, 4L))
    ),
    year = rep(2025, 2020L),
    scen = rep("reference", 2020L),
    spatial_unit = rep(c("1", "2", "3", "4", "5"), 404),
    birthrate = rep(
      c(
        0, 0.000764, 0.001165, 0.00265, 0.005423, 0.009798, 0.016558, 0.025273,
        0.03643, 0.049419, 0.064995, 0.081562, 0.098485, 0.113969, 0.124791, 0.128426,
        0.123673, 0.110565, 0.092099, 0.071365, 0.051621, 0.035345, 0.023476,
        0.015111, 0.009548, 0.006091, 0.004036, 0.002701, 0.001833, 0.001298, 0.00126,
        0.000899, 0, 0.00113, 0.004698, 0.01012, 0.018029, 0.027728, 0.038369,
        0.050934, 0.065229, 0.080512, 0.09604, 0.110943, 0.124577, 0.135363, 0.140837,
        0.142564, 0.137699, 0.12893, 0.116623, 0.102113, 0.086141, 0.070237, 0.056359,
        0.043176, 0.032162, 0.023168, 0.016219, 0.011078, 0.00732, 0.004812, 0.002914,
        0.001693, 0.000611, 0.000646, 0
      ),
      rep(c(600L, 5L, 845L, 5L, 255L), c(1L, 31L, 1L, 33L, 1L))
    ),
    int_mothers = rep(0.25, 2020L),
    mor = rep(
      c(
        0.003221, 0.000398, 0.000404, 0.000382, 0, 0.000359, 0.000351, 0.000368,
        0.000359, 0.000361, 0.000362, 0.000367, 0.000373, 0.00038, 0.000351, 0.000359,
        0.000352, 0.000348, 0.000329, 0.000352, 0.000347, 0.00032, 0.000616, 0.000617,
        0.00061, 0.000609, 0.000616, 0.000599, 0.000623, 0.000596, 0.000901, 0.000891,
        9e-04, 0.000896, 0.001255, 0.001273, 0.001275, 0.00168, 0.001639, 0.001856,
        0.002136, 0.00235, 0.002514, 0.002952, 0.003431, 0.003717, 0.00414, 0.004355,
        0.004972, 0.005387, 0.005671, 0.006214, 0.006686, 0.007339, 0.00786, 0.008484,
        0.009449, 0.010174, 0.011006, 0.011942, 0.013626, 0.014888, 0.016939,
        0.019062, 0.021604, 0.024584, 0.02853, 0.032998, 0.037814, 0.044324, 0.050839,
        0.059132, 0.067762, 0.077748, 0.088977, 0.10057, 0.112195, 0.125853, 0.136553,
        0.146535, 0.161162, 0.177914, 0.194332, 0.219251, 0.243697, 0.272727,
        0.296296, 0.333333, 0.377778, 0.002957, 0.000418, 0.000423, 4e-04, 0,
        0.000377, 0.000364, 0.000369, 0.000353, 0.000348, 0.000344, 0.000336,
        0.000335, 0.000308, 0.000298, 0.000308, 0.000297, 3e-04, 0.000299, 0.00061,
        0.000592, 0.000597, 0.00058, 0.000576, 6e-04, 0.000916, 0.000973, 0.000945,
        0.001198, 0.001244, 0.001242, 0.001529, 0.001455, 0.001869, 0.002063,
        0.002043, 0.002374, 0.002616, 0.002789, 0.003036, 0.003415, 0.003732,
        0.004113, 0.004459, 0.004847, 0.005361, 0.005928, 0.0065, 0.007144, 0.007652,
        0.008634, 0.009557, 0.010543, 0.01167, 0.012996, 0.014904, 0.016825, 0.019137,
        0.022112, 0.02517, 0.029124, 0.033737, 0.039003, 0.04567, 0.053743, 0.063222,
        0.074571, 0.087399, 0.101045, 0.117647, 0.134415, 0.151862, 0.170632, 0.18986,
        0.212598, 0.232715, 0.256293, 0.28, 0.301887, 0.356923, 0.003397, 0.000851, 0,
        0.001009, 0.000945, 0.001046, 0.00092, 0.000903, 0.000964, 0.000991, 0.000933,
        0.000894, 0.000766, 0.000719, 0.00065, 0.000594, 0.000556, 0.000551, 0.000516,
        0.000486, 0.000474, 0.000451, 0.000427, 0.000436, 0.000442, 0.000421,
        0.000431, 0.000432, 0.000846, 0.000886, 0.000877, 0.000888, 0.000914,
        0.000954, 0.000973, 0.001034, 0.001593, 0.001679, 0.001734, 0.001779,
        0.001777, 0.001891, 0.001956, 0.00258, 0.002662, 0.00335, 0.003423, 0.004135,
        0.004389, 0.004864, 0.00551, 0.007243, 0.007531, 0.008136, 0.009957, 0.011542,
        0.012163, 0.014532, 0.014553, 0.016787, 0.017926, 0.020833, 0.021176,
        0.023188, 0.025281, 0.026446, 0.030151, 0.030238, 0.033645, 0.035714,
        0.042065, 0.045226, 0.053812, 0.062992, 0.07767, 0.092166, 0.107623, 0.145455,
        0.18, 0.212121, 0.266667, 0.230769, 0.375, 0.363636, 0.4, 0.5, 0, 0.002659,
        0.000881, 0, 0.000842, 0.000754, 0.000677, 0.000647, 0.000602, 0.000587,
        0.00056, 0.000528, 0.000503, 0.000507, 0.000498, 0.000499, 0.000496, 0.000495,
        0.000504, 0.000507, 0.000503, 0.000523, 0.000534, 0.000583, 0.000564,
        0.000611, 0.001292, 0.001276, 0.001345, 0.00143, 0.001352, 0.001437, 0.001559,
        0.002318, 0.002486, 0.002503, 0.00261, 0.002876, 0.003788, 0.003176, 0.003557,
        0.00507, 0.00506, 0.005887, 0.006385, 0.005629, 0.005946, 0.007866, 0.008155,
        0.009153, 0.010088, 0.010596, 0.013569, 0.014144, 0.016327, 0.019305,
        0.021016, 0.022272, 0.025696, 0.030848, 0.035477, 0.0399, 0.051044, 0.05641,
        0.068027, 0.078853, 0.093023, 0.107143, 0.132075, 0.153846, 0.175439,
        0.170213, 0.235294, 0.3, 0.285714, 0.333333, 0.25
      ),
      rep(
        c(5L, 60L, 5L, 10L, 5L, 105L, 5L, 10L, 5L, 70L, 5L, 10L, 5L, 120L, 5L, 10L, 5L, 10L, 5L),
        c(4L, 1L, 19L, 1L, 68L, 1L, 8L, 1L, 68L, 1L, 83L, 1L, 2L, 1L, 7L, 1L, 60L, 1L, 4L)
      )
    ),
    emi_int = rep(
      c(
        0.001624, 0.004434, 0.004486, 0.004239, 0.004089, 0.003566, 0.003537,
        0.003198, 0.002841, 0.002899, 0.00244, 0.002068, 0.001786, 0.001778, 0.001405,
        0.001393, 0.00145, 0.002125, 0.002588, 0.003236, 0.003975, 0.004703, 0.00514,
        0.005218, 0.005309, 0.005946, 0.006087, 0.005963, 0.005903, 0.005588, 0.0053,
        0.004887, 0.004825, 0.004651, 0.004359, 0.00431, 0.004, 0.003995, 0.003727,
        0.00362, 0.003453, 0.003302, 0.003023, 0.00299, 0.00302, 0.003006, 0.00284,
        0.002561, 0.002565, 0.002703, 0.002636, 0.002797, 0.002758, 0.003243,
        0.003362, 0.003497, 0.003703, 0.004218, 0.004632, 0.004844, 0.004502,
        0.004453, 0.004441, 0.003731, 0.0036, 0.005693, 0.004492, 0.003219, 0.003248,
        0.003082, 0.002828, 0.002321, 0.002043, 0.001772, 0.00154, 0.001524, 0.0012,
        0.001189, 0.000827, 0.000857, 0.000922, 0.000985, 0.000524, 0.000616,
        0.000684, 0.000894, 0.000988, 0.001036, 0.00122, 0, 0.002559, 0.004639,
        0.004693, 0.004441, 0.004399, 0.00428, 0.003451, 0.003413, 0.002966, 0.002605,
        0.002622, 0.002281, 0.001914, 0.001859, 0.001516, 0.001424, 0.001522,
        0.001832, 0.002312, 0.003075, 0.003514, 0.004552, 0.005035, 0.00509, 0.00551,
        0.005652, 0.005451, 0.005525, 0.005293, 0.005236, 0.004834, 0.004728,
        0.004382, 0.004034, 0.004035, 0.003911, 0.003424, 0.003003, 0.003029,
        0.003024, 0.002769, 0.002688, 0.002705, 0.002627, 0.002608, 0.002414,
        0.002762, 0.002608, 0.002845, 0.002704, 0.002809, 0.003116, 0.003067,
        0.003503, 0.003478, 0.003615, 0.00358, 0.003564, 0.003332, 0.003256, 0.003271,
        0.003189, 0.003033, 0.002905, 0.003218, 0.00255, 0.002145, 0.001617, 0.001354,
        0.000857, 0.000883, 0.000925, 0.000637, 0.000639, 0.000686, 0.000684,
        0.000709, 0.000366, 0.000375, 0.000381, 4e-04, 0.000416, 0.000433, 0.000494,
        0.000557, 0.00064, 0.00068, 0, 0.000849, 0, 0.00515, 0.036658, 0.031187,
        0.026619, 0.022318, 0.019147, 0.017094, 0.015013, 0.012069, 0.011309,
        0.009692, 0.009386, 0.008029, 0.006926, 0.006346, 0.005988, 0.006036,
        0.006591, 0.009454, 0.013966, 0.019284, 0.023762, 0.029774, 0.033042,
        0.035547, 0.03748, 0.037481, 0.036437, 0.036263, 0.035591, 0.034208, 0.032944,
        0.031904, 0.031068, 0.029899, 0.029501, 0.028331, 0.027828, 0.027211,
        0.026533, 0.025708, 0.025499, 0.024488, 0.023747, 0.023132, 0.022426,
        0.021968, 0.021411, 0.020704, 0.020191, 0.019608, 0.019086, 0.018969,
        0.018935, 0.019521, 0.020169, 0.021837, 0.02381, 0.025896, 0.025119, 0.027929,
        0.021045, 0.025662, 0.031703, 0.043611, 0.07076, 0.054233, 0.022567, 0.014754,
        0.013841, 0.012635, 0.010352, 0.011933, 0.010204, 0.010363, 0.009368,
        0.008671, 0.008403, 0.006601, 0.006689, 0.008584, 0.007435, 0.003953,
        0.003817, 0.005025, 0.004484, 0.005236, 0.006452, 0.009174, 0.008929,
        0.012048, 0, 0.002705, 0.028394, 0.026342, 0.024145, 0.02336, 0.020779,
        0.018987, 0.016529, 0.014124, 0.012324, 0.012138, 0.011916, 0.010742,
        0.010669, 0.010799, 0.010978, 0.010707, 0.011161, 0.012776, 0.013889,
        0.014528, 0.01603, 0.01868, 0.022539, 0.023307, 0.025937, 0.026502, 0.025217,
        0.025316, 0.025486, 0.025403, 0.025256, 0.024571, 0.023618, 0.021937,
        0.020833, 0.019427, 0.018565, 0.01706, 0.015944, 0.014888, 0.014134, 0.013692,
        0.013085, 0.012546, 0.011752, 0.011655, 0.011274, 0.011009, 0.010349,
        0.010217, 0.010094, 0.010029, 0.010142, 0.010784, 0.01248, 0.015408, 0.019786,
        0.023179, 0.02584, 0.029384, 0.029026, 0.029319, 0.029308, 0.037453, 0.023839,
        0.020498, 0.015898, 0.013109, 0.011881, 0.011765, 0.010163, 0.009132,
        0.010076, 0.010582, 0.01084, 0.011299, 0.01087, 0.011583, 0.013986, 0.013333,
        0.012821, 0.010309, 0.013274, 0.01, 0.009302, 0.010256, 0.013605, 0.014286,
        0.011628, 0.011905, 0.018868, 0.019231, 0.034483, 0.041667, 0
      ),
      rep(c(5L, 60L, 5L, 60L, 5L, 50L, 5L, 30L), c(89L, 1L, 89L, 1L, 91L, 1L, 95L, 1L))
    ),
    emi_nat = rep(
      c(
        0.008932, 0.020556, 0.022023, 0.018882, 0.016014, 0.013909, 0.012027,
        0.010306, 0.008878, 0.007609, 0.006971, 0.00586, 0.005359, 0.004623, 0.004215,
        0.00383, 0.003987, 0.005313, 0.008503, 0.012945, 0.01807, 0.02424, 0.030837,
        0.03839, 0.045506, 0.051766, 0.056212, 0.057874, 0.057292, 0.054898, 0.051237,
        0.046771, 0.042457, 0.03814, 0.033935, 0.03048, 0.027385, 0.024585, 0.02236,
        0.020513, 0.018832, 0.017712, 0.016626, 0.01555, 0.014799, 0.013826, 0.013253,
        0.012804, 0.012183, 0.011486, 0.011203, 0.010876, 0.01042, 0.010024, 0.009526,
        0.009416, 0.008992, 0.008685, 0.008532, 0.008234, 0.00782, 0.007734, 0.007402,
        0.007214, 0.009, 0.012741, 0.006457, 0.006438, 0.0062, 0.005855, 0.005657,
        0.005637, 0.005448, 0.005315, 0.005004, 0.004954, 0.0048, 0.004756, 0.004547,
        0.004713, 0.00461, 0.004431, 0.004193, 0.00431, 0.004107, 0.003575, 0.003953,
        0.004145, 0.003659, 0.003035, 0.003333, 0.00396, 0.002646, 0.003067, 0.004049,
        0.005348, 0, 0.009808, 0.027836, 0.023038, 0.018975, 0.015762, 0.01323,
        0.01112, 0.00948, 0.008157, 0.007071, 0.006367, 0.005701, 0.005358, 0.005204,
        0.005307, 0.00534, 0.006469, 0.008428, 0.012331, 0.018832, 0.027724, 0.039074,
        0.050736, 0.061472, 0.070051, 0.074981, 0.075945, 0.074033, 0.069866,
        0.063874, 0.056975, 0.049983, 0.043141, 0.037232, 0.031968, 0.027377,
        0.023965, 0.021021, 0.018782, 0.016934, 0.015385, 0.014337, 0.013526,
        0.012843, 0.01217, 0.011768, 0.011357, 0.011086, 0.011062, 0.010814, 0.010612,
        0.010284, 0.010123, 0.009924, 0.009631, 0.009553, 0.009205, 0.009028,
        0.008805, 0.008605, 0.008411, 0.0082, 0.008166, 0.007746, 0.009653, 0.008924,
        0.007239, 0.007006, 0.006768, 0.006571, 0.006178, 0.006165, 0.005734,
        0.005749, 0.005489, 0.005128, 0.004966, 0.004755, 0.004503, 0.004194,
        0.003995, 0.00416, 0.003893, 0.003457, 0.003343, 0.003201, 0.003399, 0.002985,
        0.002547, 0.002616, 0.002103, 0.00232, 0.001435, 0.001642, 0.00216, 0.002625,
        0, 0.006009, 0.02387, 0.022133, 0.019521, 0.017167, 0.015666, 0.013675,
        0.01251, 0.011207, 0.009693, 0.008811, 0.007679, 0.007136, 0.006061, 0.00544,
        0.00499, 0.00503, 0.006591, 0.010504, 0.01676, 0.025712, 0.034653, 0.044148,
        0.052478, 0.058934, 0.062998, 0.064468, 0.064777, 0.063921, 0.062572,
        0.059863, 0.056854, 0.053838, 0.050971, 0.047838, 0.045119, 0.042054,
        0.039946, 0.03784, 0.035668, 0.033987, 0.032724, 0.031612, 0.030783, 0.029804,
        0.029291, 0.028176, 0.027737, 0.026915, 0.026036, 0.02521, 0.02487, 0.023711,
        0.022485, 0.021411, 0.020169, 0.019268, 0.018519, 0.017264, 0.015614,
        0.014986, 0.013788, 0.012831, 0.011775, 0.011156, 0.010406, 0.010582,
        0.008463, 0.008197, 0.00692, 0.00722, 0.006211, 0.004773, 0.005102, 0.005181,
        0.004684, 0.00289, 0.002801, 0.0033, 0.003344, 0.004292, 0.003717, 0.003953,
        0.003817, 0, 0.004509, 0.023957, 0.021277, 0.019115, 0.017071, 0.015584,
        0.013562, 0.011938, 0.011299, 0.009683, 0.009337, 0.008249, 0.007813, 0.00679,
        0.006479, 0.005988, 0.005353, 0.007813, 0.013937, 0.025253, 0.038741,
        0.050555, 0.061021, 0.066429, 0.067703, 0.067243, 0.065371, 0.061466,
        0.056962, 0.052985, 0.048947, 0.044498, 0.040571, 0.037037, 0.033708,
        0.030996, 0.02863, 0.026091, 0.024084, 0.022422, 0.02134, 0.020192, 0.01927,
        0.018621, 0.017773, 0.017628, 0.017483, 0.016911, 0.017125, 0.016818,
        0.016603, 0.016824, 0.016476, 0.016227, 0.015816, 0.015601, 0.015408,
        0.014839, 0.014073, 0.01292, 0.012322, 0.011236, 0.009424, 0.008206, 0.007491,
        0.006274, 0.004392, 0.004769, 0.003745, 0.00396, 0.003922, 0.004065, 0.004566,
        0.005038, 0.002646, 0.00271, 0.002825, 0.002717, 0.003861, 0.003497, 0.004444,
        0.004274, 0, 0.004425, 0
      ),
      rep(c(5L, 25L, 5L, 25L, 5L, 85L, 5L, 85L), c(96L, 1L, 96L, 1L, 84L, 1L, 84L, 1L))
    ),
    acq = rep(
      c(
        0, 0.000858, 0.01364, 0.014085, 0.014197, 0.014592, 0.015666, 0.016239,
        0.016681, 0.018966, 0.021002, 0.02467, 0.028157, 0.032114, 0.038095, 0.042611,
        0.043912, 0.045272, 0.045198, 0.038866, 0.021415, 0.016529, 0.015842,
        0.014374, 0.011662, 0.011225, 0.009569, 0.008246, 0.008097, 0.007376,
        0.006889, 0.006842, 0.007439, 0.007478, 0.008252, 0.00874, 0.009978, 0.010624,
        0.011221, 0.01233, 0.012614, 0.013072, 0.0136, 0.014248, 0.014072, 0.014235,
        0.014188, 0.013849, 0.014112, 0.013975, 0.013284, 0.012325, 0.012146,
        0.011855, 0.011243, 0.010705, 0.01041, 0.009634, 0.009259, 0.008632, 0.008147,
        0.008174, 0.007257, 0.007217, 0.006341, 0.006085, 0.005203, 0.005291,
        0.004231, 0.004918, 0.00346, 0.00361, 0.004141, 0.002387, 0.002551, 0.002591,
        0.002342, 0.00289, 0.002801, 0.0033, 0.003344, 0.004292, 0.003717, 0.003953,
        0, 0.000902, 0.020408, 0.01925, 0.017103, 0.016173, 0.015584, 0.015371,
        0.016529, 0.017891, 0.022007, 0.024276, 0.029331, 0.032227, 0.037827,
        0.043197, 0.047904, 0.050321, 0.049107, 0.045296, 0.037879, 0.033898, 0.02836,
        0.023661, 0.021352, 0.017758, 0.01537, 0.011484, 0.009456, 0.007736, 0.008048,
        0.008055, 0.009621, 0.011429, 0.011809, 0.013376, 0.014736, 0.015337,
        0.015554, 0.016056, 0.017439, 0.01737, 0.017668, 0.017748, 0.017111, 0.01725,
        0.017094, 0.0169, 0.016347, 0.014679, 0.014877, 0.014049, 0.013459, 0.012894,
        0.01217, 0.010784, 0.00936, 0.009245, 0.008244, 0.00745, 0.006891, 0.006635,
        0.005618, 0.005236, 0.004689, 0.003745, 0.003764, 0.002928, 0.00318, 0.001873,
        0.00198, 0.001961, 0.002033, 0.002283, 0
      ),
      rep(c(1010L, 5L, 90L, 5L, 140L), c(1L, 83L, 1L, 73L, 1L))
    ),
    imm_int_n = rep(
      c(
        1, 3.4, 3.2, 3, 2.8, 2.6, 2.4, 2.2, 2, 1.8, 1.6, 1.4, 1.2, 1, 1.2, 1.6, 1.8,
        2.2, 2.4, 2.6, 2.8, 2.6, 2.4, 2.2, 2, 1.8, 1.6, 1.8, 2, 2.2, 2.4, 2.2, 2, 1.8,
        1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 0.8, 3, 2.8, 2.6, 2.4, 2.2, 2, 1.8,
        1.6, 1.4, 1.2, 1.4, 1.2, 1.4, 1.6, 1.8, 2, 2.2, 2.4, 2.6, 2.8, 2.6, 2.4, 2.2,
        2, 1.8, 1.6, 1.4, 1.2, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 2.8, 11, 10.6,
        10.2, 9.8, 9.4, 9.2, 9, 8.8, 8.6, 8.4, 8, 7.6, 8, 9.4, 11.6, 14.4, 17.8, 21.4,
        24.8, 27.6, 29.8, 31.6, 32.6, 33, 32.6, 31.8, 30.8, 29.4, 28, 26.8, 25.4, 24,
        22.8, 21.4, 20.2, 19, 18, 17, 16, 15, 14.2, 13.4, 12.8, 12, 11.4, 10.6, 10,
        9.2, 8.6, 7.6, 6.8, 5.8, 5, 4.4, 3.8, 3.2, 2.6, 2.2, 1.8, 1.6, 1.4, 1.2, 1,
        0.8, 0.6, 0.4, 0.2, 0, 3.6, 11.4, 10.6, 10, 9.6, 9.2, 9, 8.8, 8.4, 8.2, 8,
        7.6, 7.4, 7, 6.6, 6.2, 6, 7.4, 10.2, 14.4, 18.6, 22.6, 25.4, 27.2, 28, 27.4,
        26.4, 25.2, 23.8, 22.4, 21, 19.6, 18.4, 17.2, 16.2, 15.2, 14.2, 13.4, 12.6,
        11.8, 11, 10.4, 9.8, 9.4, 8.8, 8.4, 8, 7.6, 7.2, 6.8, 6.4, 5.8, 5.4, 4.6, 4.2,
        3.6, 3, 2.6, 2.4, 2, 1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0
      ),
      rep(
        c(
          5L, 10L, 5L, 10L, 5L, 10L, 15L, 5L, 45L, 10L, 15L, 10L, 20L, 10L, 5L, 10L,
          15L, 5L, 15L, 5L, 15L, 20L, 30L, 50L, 5L, 10L, 5L, 10L, 5L, 25L, 5L, 10L, 5L,
          10L, 5L, 10L, 5L, 35L, 10L, 5L, 10L, 5L, 15L, 20L, 25L, 40L, 30L, 20L, 25L,
          35L, 45L, 30L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 30L, 105L, 5L,
          10L, 5L, 10L, 5L, 10L, 5L, 10L, 20L, 60L, 35L, 40L
        ),
        c(
          2L, 1L, 1L, 1L, 7L, 1L, 1L, 6L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L,
          1L, 4L, 2L, 1L, 1L, 1L, 1L, 6L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L,
          1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 5L, 1L, 1L, 2L, 3L,
          1L, 11L, 1L, 40L, 2L, 1L, 1L, 10L, 1L, 5L, 1L, 7L, 1L, 38L, 2L, 1L, 1L, 1L,
          1L
        )
      )
    ),
    imm_nat_n = rep(
      c(
        10.2, 18.8, 16.8, 14.6, 12.8, 10, 8.2, 6.8, 6, 5.2, 4.6, 4.2, 3.8, 3.6, 3.4,
        3.2, 3.6, 4, 5, 7, 10, 13.6, 17.6, 20.6, 24.2, 25.6, 27.6, 29.4, 31, 31.2, 31,
        30.8, 29.6, 27.4, 24.8, 22.8, 20.2, 18.6, 16.6, 15.6, 13.8, 13, 11.8, 11.2,
        10.4, 9.4, 9.2, 8.6, 8.4, 8.2, 8, 7.8, 7.6, 7.8, 7.4, 7.6, 7, 6.8, 7, 7.2,
        5.8, 5, 4.4, 3.6, 3, 2.8, 2.6, 2.4, 2.2, 2, 1.8, 1.6, 1.4, 1.2, 1, 0.8, 0.6,
        0.4, 0.2, 0, 11.4, 17, 15.2, 13.4, 12.4, 9.2, 7.8, 6.6, 5.4, 4.6, 4, 3.6, 3,
        2.8, 2.6, 3, 4, 6.6, 10.2, 14.4, 19.2, 23, 27.6, 31.4, 36.4, 37.2, 36.8, 36.2,
        33.8, 32, 30.4, 29.2, 27, 25, 22.6, 20.6, 18.2, 16.8, 15.2, 13.6, 12.2, 11.2,
        9.8, 9.2, 8.4, 7.8, 7.6, 7.4, 7.8, 8, 8.2, 8.6, 8.4, 8.6, 8.4, 8.2, 8.4, 8,
        7.6, 7.4, 6.6, 5.8, 5, 4.2, 3.8, 3.4, 3.2, 3, 2.8, 2.4, 2.2, 2, 1.8, 1.6, 1.4,
        1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 0.2, 3.8, 7, 5.6, 5.2, 4.4, 4.2, 4, 3.8, 3.6,
        3.2, 3, 2.6, 2.4, 2.8, 3.4, 4.6, 6.2, 8, 9.8, 12.2, 14.8, 18.4, 20.8, 22.8,
        24.8, 26, 26.6, 27, 27.6, 27.8, 27.4, 27, 25.6, 25.4, 23.4, 22.4, 21.2, 19.6,
        18.2, 17.2, 16, 15.4, 13.8, 13, 11.8, 11, 9.8, 9.4, 8.2, 7.8, 7.2, 6.8, 6.4,
        6, 5.2, 5, 4.4, 4, 3.4, 2.8, 2.4, 1.8, 1.4, 1, 0.6, 0.4, 0.2, 0, 4, 8.4, 6.6,
        5.8, 5.4, 4.6, 4, 3.6, 3.2, 2.8, 2.4, 2.2, 1.8, 1.6, 1.4, 1.2, 1.4, 1.8, 2.6,
        4.2, 6.6, 8.4, 10.4, 12.2, 14, 16.2, 17.6, 19, 20.4, 20.8, 20.6, 19.4, 19.2,
        18, 16.8, 16, 14.8, 13.8, 12.6, 11.6, 10.8, 10, 8.8, 8.2, 7.8, 7.2, 6.6, 6.4,
        6.2, 6, 5.6, 5.4, 5.2, 5, 4.8, 4.6, 4.2, 3.8, 3.4, 3, 2.8, 2.6, 2.2, 1.8, 1.6,
        1.4, 1, 0.8, 0.6, 0.4, 0.2, 0
      ),
      rep(
        c(
          5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 15L, 20L,
          15L, 25L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L,
          25L, 10L, 5L, 10L, 5L, 10L, 15L, 5L, 10L, 5L, 10L, 40L, 30L, 75L, 5L, 10L, 5L,
          10L, 5L, 45L, 40L, 65L
        ),
        c(
          15L, 1L, 12L, 1L, 19L, 1L, 1L, 1L, 1L, 2L, 16L, 3L, 1L, 1L, 1L, 1L, 1L, 1L,
          1L, 14L, 1L, 10L, 1L, 20L, 1L, 8L, 2L, 12L, 3L, 1L, 1L, 1L, 4L, 1L, 1L, 1L,
          4L, 1L, 7L, 1L, 1L, 47L, 1L, 2L, 2L, 1L, 1L, 1L, 64L, 1L, 2L, 1L, 1L, 1L, 1L,
          1L
        )
      )
    ),
    emi_nat_n = rep(
      c(
        4.4, 10.2, 10.8, 9.8, 9.4, 7.8, 6.8, 5.8, 5, 4.2, 4, 3.4, 3, 2.6, 2.4, 2.2, 3,
        4.6, 7.2, 10, 13.4, 16.8, 20.6, 24, 29.6, 31.4, 33, 33.4, 29, 26.8, 26.4,
        24.6, 21.8, 19.8, 17.8, 16, 14.4, 13.6, 12, 11.8, 11, 10.4, 9.8, 9.2, 8.4, 8,
        7.6, 6.8, 7, 6.8, 7, 6.8, 7, 6.8, 6.6, 6, 5.8, 7, 9.4, 4.6, 4.4, 4.2, 3.8,
        3.6, 3.4, 3.2, 3, 2.6, 2.4, 2.2, 2, 1.8, 1.6, 1.4, 1.2, 0.8, 0.6, 0.4, 0.2, 0,
        4.6, 13.2, 10.8, 9.4, 8.6, 6.8, 5.8, 5, 4.4, 3.8, 3.4, 3, 2.8, 3, 3.4, 4.6,
        6.4, 9.8, 14.2, 20.6, 26.2, 31.4, 35.6, 39.8, 41.8, 40.2, 39.6, 36.6, 33,
        29.6, 25.6, 24, 20.6, 18.2, 15.4, 14, 12.4, 11.2, 10, 9.6, 9, 8.8, 8.4, 7.8,
        7.4, 6.8, 7, 7.2, 6.8, 6.6, 6.8, 7.2, 7.4, 7.2, 7.6, 7.4, 7.2, 7, 6.4, 7.8, 7,
        5.4, 5.2, 5, 4.6, 4.2, 4, 3.6, 3.2, 3, 2.8, 2.6, 2.4, 2.2, 2, 1.8, 1.4, 1.2,
        1, 0.8, 0.6, 0.4, 0.2, 0, 1.4, 5.6, 4.4, 4, 3.6, 3.2, 3, 2.6, 2.4, 2, 1.8,
        1.6, 1.4, 1.2, 1, 1.4, 2, 3.6, 5.6, 7, 8.6, 10.8, 12.6, 15.8, 17.2, 19.2,
        20.8, 21.8, 21, 21.4, 21.6, 21, 20.8, 19, 17.8, 16.4, 15.6, 15.4, 14.2, 14,
        13.4, 12.8, 11.8, 11.4, 10.4, 9.8, 9, 8.6, 8, 7.6, 6.8, 6.2, 6, 5.6, 5.2, 4.6,
        4.4, 3.8, 3.2, 2.6, 2.2, 2, 1.6, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 1, 5.4, 4.2,
        3.8, 3.6, 3, 2.6, 2.4, 2.2, 2, 1.8, 1.6, 1.4, 1.2, 1, 1.4, 2.4, 4, 6.4, 8.2,
        9.8, 11.2, 12.2, 14, 14.8, 15.6, 16.2, 15.8, 14.8, 14.2, 13.8, 12.6, 12.2,
        11.2, 10.4, 9.6, 9, 8.6, 8, 7.6, 7.4, 6.8, 6.6, 6, 5.6, 5.2, 5, 4.6, 4.8, 4.4,
        4, 3.6, 3.4, 3, 2.6, 2.4, 1.8, 1.4, 1.2, 1, 0.6, 0.4, 0.2, 0, 0.2, 0
      ),
      rep(
        c(
          5L, 10L, 5L, 10L, 5L, 10L, 5L, 15L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 15L, 5L,
          15L, 20L, 25L, 5L, 15L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L,
          20L, 25L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 20L, 40L, 85L, 5L,
          10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 30L, 40L, 5L, 85L
        ),
        c(
          15L, 1L, 10L, 1L, 20L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 12L, 3L, 5L, 1L, 1L, 1L,
          1L, 1L, 12L, 1L, 36L, 1L, 5L, 2L, 10L, 1L, 6L, 1L, 3L, 1L, 1L, 2L, 1L, 1L, 2L,
          1L, 11L, 1L, 17L, 1L, 1L, 1L, 30L, 1L, 1L, 1L, 1L, 1L, 3L, 1L, 9L, 1L, 13L,
          1L, 15L, 1L, 1L, 1L, 4L, 1L, 9L, 1L, 1L, 1L, 2L, 1L
        )
      )
    ),
    mig_nat_n = rep(
      c(
        5.8, 8.6, 6, 4.8, 3.4, 2.2, 1.4, 1, 0.6, 0.8, 1, 0.6, -0.6, -2.2, -3, -3.4,
        -3.2, -3, -3.4, -5.4, -5.8, -5.4, -3.6, -2.4, 2, 4.4, 4.6, 6.2, 7.8, 7.6, 7,
        6.8, 5.8, 5, 4.6, 3.8, 2.8, 2.6, 2, 1.4, 1.6, 1.8, 1.6, 1.4, 1.2, 0.8, 0.6,
        0.8, 1, 0.8, 1, 0, -2.2, 1.2, 0.6, 0.2, -0.2, -0.6, -0.4, -0.6, -0.4, -0.2, 0,
        -0.2, 0, 0.2, 0, 6.8, 3.8, 4.4, 4, 3.8, 2.4, 2, 1.6, 1, 0.8, 0.6, 0.2, 0,
        -0.2, -0.4, -0.6, 0.2, 0.4, 0.2, -1.4, -3.2, -3.8, -4.2, -3.4, -4.6, -3, -2.8,
        -0.4, 0.8, 2.4, 4.8, 5.2, 6.4, 6.8, 7.2, 6.6, 5.8, 5.6, 5.2, 4, 3.2, 2.4, 1.4,
        1, 0.6, 0.4, 0.6, 1.2, 1.4, 1, 1.4, 0.8, 1.2, 1, 1.2, -0.4, 0.4, -0.2, -0.8,
        -0.6, -0.8, -0.6, -0.4, -0.2, -0.4, -0.2, 0, 0.2, 0, 0.2, 0, 0.2, 0, 0.2, 2.4,
        1.4, 1.2, 0.8, 1.2, 0.8, 1, 1.2, 1, 1.2, 1.4, 1, 0.6, 1, 1.2, 1.4, 2.2, 2.6,
        3.6, 4, 4.2, 5.6, 6, 6.8, 6.6, 6.2, 6.6, 7.6, 5.6, 6, 5.6, 4.2, 4, 3.2, 2.6,
        2, 1.6, 1.4, 1.2, 0.8, 0.2, 0.4, 0.6, 0.4, 0, 0.4, 0, 0.2, 0.4, 0.2, 0, 0.2,
        -0.2, 0, 0.2, 0, 0.2, 0, 3, 2.4, 2, 1.6, 1, 0.8, 0.6, 0.4, 0.2, 0, 0.4, 0.2,
        0.6, 1, 1.8, 2.2, 2.8, 3.4, 4.2, 5, 4.8, 4.6, 5, 4.2, 3.8, 3.6, 3.4, 3, 2.6,
        2.2, 2, 1.2, 0.8, 1, 0.6, 0.4, 0.6, 0.8, 0.4, 0.6, 0.2, 0.4, 0.6, 0.2, 0, 0.2,
        0.4, 0.6, 0.8, 0.4, 0.2, 0, 0.2, 0, 0.2, 0, 0.2, 0
      ),
      rep(
        c(
          5L, 15L, 5L, 10L, 20L, 5L, 15L, 5L, 10L, 5L, 15L, 5L, 20L, 5L, 30L, 15L, 5L,
          10L, 20L, 5L, 40L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 15L, 5L, 15L, 10L, 5L, 10L,
          5L, 20L, 5L, 10L, 5L, 10L, 5L, 30L, 15L, 10L, 5L, 10L, 20L, 5L, 10L, 20L, 5L,
          10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 20L, 5L, 10L, 5L, 25L, 20L, 10L,
          75L, 10L, 5L, 15L, 5L, 10L, 15L, 5L, 10L, 20L, 5L, 10L, 5L, 10L, 5L, 10L, 5L,
          10L, 15L, 5L, 15L, 5L, 15L, 30L, 10L, 5L, 20L, 65L
        ),
        c(
          7L, 1L, 1L, 1L, 1L, 27L, 1L, 4L, 3L, 4L, 1L, 6L, 1L, 1L, 1L, 1L, 2L, 1L, 1L,
          1L, 1L, 10L, 1L, 3L, 1L, 27L, 2L, 4L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 4L,
          2L, 1L, 2L, 1L, 1L, 2L, 7L, 1L, 1L, 1L, 1L, 1L, 7L, 1L, 2L, 1L, 12L, 1L, 4L,
          2L, 2L, 1L, 3L, 1L, 1L, 1L, 3L, 1L, 2L, 1L, 1L, 1L, 3L, 1L, 2L, 1L, 1L, 1L,
          1L, 1L, 11L, 1L, 10L, 1L, 3L, 1L, 4L, 3L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L,
          1L
        )
      )
    ),
    fso_projection_n = rep(
      c(
        2486, 2545, 2500, 2639, 2972, 2837, 2857, 2843, 2847, 2794, 2903, 2941, 2842,
        2863, 2901, 2923, 2809, 2872, 2736, 2789, 2766, 2758, 2718, 2677, 2630, 2840,
        2771, 2832, 2870, 3038, 2850, 2900, 3145, 3270, 3267, 3306, 3310, 3276, 3366,
        3237, 3380, 3351, 3386, 3349, 3364, 3203, 3156, 3150, 2989, 3061, 3240, 3284,
        3409, 3582, 3725, 3785, 4026, 4094, 4119, 4206, 4249, 4035, 4001, 3863, 3642,
        3535, 3390, 3354, 3209, 3143, 2977, 2894, 2778, 2553, 2572, 2445, 2459, 2349,
        2256, 2086, 1940, 1811, 1527, 1362, 1032, 921, 867, 728, 577, 519, 431, 318,
        268, 199, 146, 90, 64, 38, 16, 28, 2371, 2416, 2388, 2516, 2766, 2601, 2637,
        2664, 2722, 2717, 2700, 2667, 2648, 2730, 2679, 2857, 2675, 2772, 2635, 2632,
        2588, 2648, 2581, 2549, 2532, 2648, 2738, 2708, 2828, 2873, 2912, 2988, 3011,
        3271, 3279, 3387, 3280, 3396, 3363, 3370, 3310, 3402, 3376, 3469, 3487, 3350,
        3287, 3096, 3185, 3347, 3222, 3228, 3277, 3441, 3747, 3875, 3914, 4204, 4196,
        4292, 4272, 4379, 4273, 4118, 4015, 3899, 3711, 3689, 3667, 3474, 3371, 3214,
        3109, 3096, 2878, 2885, 2775, 2688, 2614, 2565, 2440, 2333, 2234, 1947, 1714,
        1480, 1378, 1242, 1076, 1033, 841, 748, 593, 506, 376, 300, 228, 163, 108, 74,
        105, 1180, 1175, 1008, 1136, 1177, 1160, 1183, 1212, 1175, 1249, 1146, 1178,
        1124, 1151, 1095, 997, 987, 1053, 959, 1098, 1124, 1063, 1043, 1113, 1167,
        1356, 1448, 1596, 1740, 1853, 1872, 1992, 2110, 2159, 2262, 2378, 2330, 2298,
        2400, 2345, 2334, 2375, 2267, 2287, 2255, 2191, 2098, 2055, 1934, 1882, 1786,
        1729, 1683, 1582, 1528, 1540, 1489, 1474, 1443, 1428, 1350, 1214, 1068, 940,
        891, 713, 690, 596, 566, 539, 472, 408, 382, 374, 414, 336, 346, 294, 289,
        223, 257, 242, 250, 190, 211, 178, 142, 98, 99, 70, 41, 26, 11, 10, 5, 7, 3,
        1, 0, 1135, 1143, 1007, 1013, 1125, 1164, 1118, 1102, 1074, 1141, 1074, 1088,
        1019, 912, 976, 910, 874, 842, 789, 838, 848, 865, 924, 1000, 1145, 1242,
        1381, 1532, 1597, 1709, 1746, 1823, 1922, 1921, 2008, 1991, 2022, 2017, 2023,
        2027, 1990, 1974, 1985, 1912, 1869, 1716, 1770, 1637, 1549, 1566, 1487, 1399,
        1477, 1390, 1282, 1287, 1198, 1186, 1135, 1028, 1040, 931, 831, 773, 780, 672,
        620, 529, 501, 503, 485, 432, 392, 373, 363, 348, 361, 254, 279, 219, 227,
        189, 217, 193, 205, 184, 137, 128, 78, 75, 46, 44, 23, 19, 13, 7, 5, 2, 3
      ),
      rep(
        c(5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L),
        c(35L, 1L, 217L, 1L, 45L, 1L, 12L, 1L, 81L, 1L, 4L)
      )
    ),
    mig_sub = rep(c(-0.1253, -0.1794, -0.1924, 0.0434, 0.4537), 404),
  )

  ## Create short version of fso population with fictitious subregions
  # nolint start
  # fso_population |>
  #   dplyr::rename(n_tot = n) |>
  #   # duplicating rows 5 times
  #   tidyr::uncount(5) |>
  #   # create 5 subregions
  #   dplyr::mutate(subregion = rep(1:5, times = nrow(fso_population))) |>
  #   dplyr::mutate(
  #     # Create fictitious n
  #     n = case_match(
  #       subregion,
  #       1 ~ round(n_tot * 0.3),
  #       2 ~ round(n_tot * 0.25),
  #       3 ~ round(n_tot * 0.2),
  #       4 ~ round(n_tot * 0.15),
  #       # 5 ~ round(n_tot * 0.1),
  #       .default = NA
  #     ),
  #     .keep = "all"
  #   ) |>
  #   # create region 5 by subtracting sum of 1:4 from original n to get exact same n
  #   # (avoid rounding errors)
  #   ## get sum of regions 1-4
  #   dplyr::mutate(sum = sum(n, na.rm = TRUE), .by=c(year,nat,sex,age)) |>
  #   ## compute region 5
  #   dplyr::mutate(
  #     n = case_match(
  #       subregion,
  #       5 ~ (n_tot - sum),
  #       .default = n
  #     )) |>
  #   dplyr::select(-n_tot, -sum) |>
  # constructive::construct()
  # nolint end

  population_short_subregions <- tibble::tibble(
    year = rep(2024, 2020L),
    spatial_unit = rep("Aargau", 2020L),
    nat = rep(c("ch", "int"), each = 1010L),
    sex = rep(rep(c("m", "f"), 2), each = 505L),
    age = rep(rep(seq(0, 100, by = 1), 4), each = 5L),
    subregion = rep(1:5, 404),
    n = c(
      738, 615, 492, 369, 247, 744, 620, 496, 372, 249, 736, 613, 490, 368, 245,
      778, 649, 519, 389, 260, 880, 734, 587, 440, 294, 841, 701, 561, 421, 280,
      848, 707, 565, 424, 283, 844, 704, 563, 422, 281, 845, 704, 563, 422, 282,
      828, 690, 552, 414, 276, 861, 717, 574, 430, 287, 870, 725, 580, 435, 291,
      840, 700, 560, 420, 279, 844, 703, 562, 422, 281, 854, 712, 569, 427, 285,
      862, 718, 574, 431, 287, 828, 690, 552, 414, 275, 847, 706, 565, 423, 282,
      812, 676, 541, 406, 270, 834, 695, 556, 417, 279, 830, 692, 553, 415, 277,
      829, 691, 553, 415, 276, 817, 681, 545, 409, 272, 805, 671, 537, 402, 268,
      791, 659, 527, 396, 264, 858, 715, 572, 429, 285, 838, 698, 559, 419, 279,
      855, 713, 570, 428, 285, 864, 720, 576, 432, 288, 913, 760, 608, 456, 305,
      849, 708, 566, 424, 283, 860, 716, 573, 430, 286, 933, 777, 622, 466, 311,
      968, 806, 645, 484, 322, 964, 803, 642, 482, 321, 974, 812, 650, 487, 325,
      975, 812, 650, 488, 325, 976, 814, 651, 488, 325, 966, 805, 644, 483, 322,
      994, 829, 663, 497, 332, 956, 796, 637, 478, 319, 999, 833, 666, 500, 333,
      992, 827, 662, 496, 331, 1003, 836, 669, 502, 334, 993, 828, 662, 497, 331,
      998, 832, 665, 499, 333, 951, 792, 634, 475, 317, 937, 781, 625, 469, 312,
      936, 780, 624, 468, 311, 888, 740, 592, 444, 296, 910, 759, 607, 455, 304,
      965, 804, 644, 483, 322, 979, 816, 653, 489, 326, 1018, 848, 678, 509, 339,
      1071, 892, 714, 535, 357, 1115, 929, 743, 558, 372, 1134, 945, 756, 567, 379,
      1209, 1008, 806, 604, 403, 1231, 1026, 820, 615, 410, 1239, 1032, 826, 619,
      413, 1266, 1055, 844, 633, 422, 1280, 1067, 853, 640, 427, 1216, 1013, 811,
      608, 405, 1206, 1005, 804, 603, 402, 1167, 972, 778, 583, 389, 1107, 922, 738,
      553, 369, 1069, 890, 712, 534, 357, 1025, 854, 683, 513, 342, 1016, 847, 677,
      508, 339, 974, 811, 649, 487, 324, 955, 796, 636, 477, 318, 905, 754, 603,
      452, 302, 881, 734, 587, 441, 294, 847, 706, 564, 423, 282, 779, 650, 520,
      390, 259, 787, 656, 525, 394, 262, 750, 625, 500, 375, 250, 757, 631, 505,
      378, 252, 726, 605, 484, 363, 241, 700, 584, 467, 350, 233, 651, 542, 434,
      325, 217, 609, 508, 406, 305, 203, 572, 477, 382, 286, 191, 487, 406, 325,
      244, 162, 438, 365, 292, 219, 147, 336, 280, 224, 168, 111, 304, 253, 202,
      152, 101, 290, 241, 193, 145, 96, 246, 205, 164, 123, 82, 198, 165, 132, 99,
      65, 180, 150, 120, 90, 60, 152, 126, 101, 76, 50, 113, 94, 76, 57, 38, 98, 82,
      65, 49, 32, 74, 62, 49, 37, 25, 56, 47, 37, 28, 19, 36, 30, 24, 18, 11, 26,
      22, 18, 13, 9, 16, 14, 11, 8, 5, 7, 6, 5, 4, 2, 14, 11, 9, 7, 4, 707, 589,
      471, 353, 236, 711, 593, 474, 356, 237, 703, 586, 469, 352, 234, 743, 619,
      495, 372, 248, 818, 682, 546, 409, 273, 771, 642, 514, 386, 257, 782, 652,
      522, 391, 261, 791, 659, 527, 396, 264, 809, 674, 539, 405, 270, 806, 672,
      537, 403, 269, 801, 668, 534, 400, 267, 789, 658, 526, 395, 263, 784, 653,
      523, 392, 261, 807, 672, 538, 404, 269, 791, 660, 528, 396, 263, 843, 702,
      562, 421, 281, 788, 657, 526, 394, 263, 819, 682, 546, 409, 273, 778, 649,
      519, 389, 260, 781, 650, 520, 390, 261, 768, 640, 512, 384, 257, 791, 659,
      527, 395, 264, 775, 646, 516, 387, 258, 766, 638, 511, 383, 256, 762, 635,
      508, 381, 255, 796, 664, 531, 398, 265, 826, 688, 550, 413, 275, 814, 679,
      543, 407, 272, 850, 708, 567, 425, 284, 860, 716, 573, 430, 286, 869, 724,
      579, 434, 290, 888, 740, 592, 444, 297, 890, 742, 593, 445, 297, 967, 806,
      645, 483, 322, 967, 806, 644, 483, 322, 997, 831, 665, 499, 332, 964, 803,
      643, 482, 321, 999, 832, 666, 500, 333, 990, 825, 660, 495, 331, 992, 827,
      661, 496, 331, 975, 812, 650, 488, 325, 1004, 837, 670, 502, 335, 998, 832,
      665, 499, 333, 1028, 856, 685, 514, 343, 1035, 863, 690, 518, 345, 994, 828,
      663, 497, 332, 977, 814, 652, 489, 326, 920, 767, 613, 460, 307, 949, 791,
      633, 475, 316, 999, 832, 666, 499, 333, 961, 801, 641, 481, 320, 963, 802,
      642, 481, 321, 978, 815, 652, 489, 326, 1028, 856, 685, 514, 343, 1121, 934,
      748, 561, 374, 1162, 968, 775, 581, 387, 1173, 978, 782, 587, 391, 1263, 1052,
      842, 631, 421, 1261, 1050, 840, 630, 421, 1290, 1075, 860, 645, 430, 1284,
      1070, 856, 642, 428, 1317, 1098, 878, 658, 439, 1286, 1072, 857, 643, 428,
      1239, 1033, 826, 620, 413, 1212, 1010, 808, 606, 404, 1177, 980, 784, 588,
      393, 1119, 932, 746, 560, 373, 1113, 928, 742, 557, 371, 1108, 924, 739, 554,
      369, 1050, 875, 700, 525, 350, 1020, 850, 680, 510, 339, 973, 811, 649, 487,
      324, 942, 785, 628, 471, 313, 939, 783, 626, 470, 313, 874, 729, 583, 437,
      292, 878, 731, 585, 439, 292, 846, 705, 564, 423, 281, 820, 684, 547, 410,
      273, 800, 666, 533, 400, 266, 787, 656, 525, 393, 262, 751, 626, 501, 375,
      250, 721, 601, 481, 361, 240, 694, 578, 462, 347, 231, 608, 506, 405, 304,
      202, 538, 449, 359, 269, 180, 469, 390, 312, 234, 157, 441, 368, 294, 221,
      147, 402, 335, 268, 201, 134, 353, 294, 236, 177, 118, 344, 287, 229, 172,
      115, 285, 238, 190, 143, 95, 259, 216, 172, 129, 86, 209, 174, 139, 105, 70,
      183, 152, 122, 91, 61, 139, 116, 93, 69, 46, 114, 95, 76, 57, 39, 89, 74, 59,
      44, 30, 65, 54, 44, 33, 22, 45, 38, 30, 22, 15, 32, 26, 21, 16, 11, 49, 40,
      32, 24, 17, 359, 299, 239, 180, 120, 352, 293, 235, 176, 117, 298, 248, 199,
      149, 100, 338, 282, 225, 169, 113, 350, 291, 233, 175, 116, 345, 287, 230,
      172, 115, 351, 292, 234, 176, 117, 360, 300, 240, 180, 119, 348, 290, 232,
      174, 116, 371, 310, 248, 186, 123, 340, 284, 227, 170, 114, 352, 293, 234,
      176, 117, 336, 280, 224, 168, 113, 346, 289, 231, 173, 116, 331, 276, 221,
      165, 110, 301, 250, 200, 150, 101, 298, 248, 199, 149, 100, 319, 266, 212,
      159, 106, 286, 238, 190, 143, 95, 322, 268, 215, 161, 108, 327, 272, 218, 163,
      109, 303, 252, 202, 152, 101, 292, 244, 195, 146, 97, 309, 257, 206, 154, 103,
      321, 267, 214, 160, 107, 376, 314, 251, 188, 125, 400, 334, 267, 200, 133,
      445, 370, 296, 222, 149, 488, 407, 325, 244, 163, 523, 436, 348, 261, 174,
      526, 438, 351, 263, 176, 565, 470, 376, 282, 189, 602, 502, 401, 301, 200,
      618, 515, 412, 309, 206, 652, 544, 435, 326, 217, 692, 576, 461, 346, 230,
      678, 565, 452, 339, 225, 668, 557, 446, 334, 223, 706, 588, 470, 353, 235,
      690, 575, 460, 345, 229, 688, 574, 459, 344, 230, 706, 588, 471, 353, 235,
      674, 562, 449, 337, 224, 682, 568, 455, 341, 228, 674, 562, 450, 337, 225,
      656, 546, 437, 328, 218, 628, 524, 419, 314, 209, 616, 514, 411, 308, 206,
      580, 483, 386, 290, 193, 565, 470, 376, 282, 189, 536, 446, 357, 268, 178,
      519, 432, 346, 259, 173, 506, 422, 337, 253, 169, 507, 422, 338, 254, 169,
      476, 397, 318, 238, 159, 461, 384, 307, 231, 154, 467, 389, 311, 234, 156,
      454, 378, 302, 227, 151, 452, 376, 301, 226, 151, 442, 368, 295, 221, 147,
      440, 367, 294, 220, 147, 413, 344, 276, 207, 138, 374, 312, 249, 187, 125,
      331, 276, 221, 166, 110, 296, 246, 197, 148, 99, 288, 240, 192, 144, 97, 227,
      189, 151, 113, 76, 213, 177, 142, 106, 71, 183, 152, 122, 92, 61, 173, 144,
      116, 87, 58, 166, 138, 111, 83, 56, 145, 121, 97, 72, 48, 126, 105, 84, 63,
      41, 118, 98, 78, 59, 39, 116, 96, 77, 58, 39, 128, 107, 85, 64, 43, 104, 86,
      69, 52, 35, 107, 89, 71, 54, 36, 91, 76, 61, 45, 30, 90, 75, 60, 45, 29, 70,
      58, 47, 35, 23, 81, 67, 54, 40, 27, 76, 63, 51, 38, 25, 79, 66, 52, 39, 26,
      60, 50, 40, 30, 19, 67, 56, 45, 33, 22, 57, 48, 38, 29, 19, 46, 39, 31, 23,
      16, 33, 27, 22, 16, 11, 34, 28, 22, 17, 11, 25, 21, 17, 12, 8, 15, 12, 10, 8,
      5, 10, 8, 7, 5, 3, 4, 4, 3, 2, 2, 4, 3, 3, 2, 1, 2, 2, 2, 1, 1, 3, 3, 2, 2, 1,
      2, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 346, 288, 230,
      173, 115, 338, 282, 225, 169, 113, 296, 247, 197, 148, 99, 298, 248, 199, 149,
      100, 334, 278, 223, 167, 111, 346, 289, 231, 173, 116, 332, 276, 221, 166,
      111, 327, 272, 218, 163, 109, 319, 266, 212, 159, 106, 341, 284, 227, 170,
      114, 321, 268, 214, 161, 107, 327, 273, 218, 164, 109, 307, 256, 205, 154,
      102, 309, 258, 206, 155, 103, 278, 232, 185, 139, 92, 301, 250, 200, 150, 101,
      280, 234, 187, 140, 93, 269, 224, 179, 134, 90, 258, 215, 172, 129, 87, 238,
      198, 158, 119, 79, 248, 206, 165, 124, 83, 243, 203, 162, 122, 81, 241, 201,
      161, 120, 80, 253, 211, 169, 126, 84, 270, 225, 180, 135, 91, 312, 260, 208,
      156, 105, 340, 283, 226, 170, 113, 381, 317, 254, 190, 127, 427, 356, 284,
      213, 142, 447, 373, 298, 224, 149, 484, 404, 323, 242, 161, 499, 416, 333,
      249, 166, 525, 438, 350, 262, 175, 559, 466, 373, 279, 186, 561, 467, 374,
      280, 187, 590, 492, 394, 295, 197, 587, 489, 391, 293, 196, 598, 498, 399,
      299, 199, 598, 498, 399, 299, 199, 602, 502, 401, 301, 201, 604, 504, 403,
      302, 202, 594, 495, 396, 297, 199, 592, 493, 394, 296, 197, 596, 497, 397,
      298, 199, 574, 478, 383, 287, 191, 562, 468, 374, 281, 187, 515, 429, 343,
      257, 172, 532, 444, 355, 266, 177, 490, 409, 327, 245, 164, 464, 386, 309,
      232, 155, 470, 392, 313, 235, 156, 446, 372, 297, 223, 148, 419, 349, 279,
      209, 140, 444, 370, 296, 222, 147, 417, 348, 278, 209, 139, 385, 320, 256,
      192, 129, 389, 324, 260, 195, 130, 364, 303, 243, 182, 121, 362, 302, 242,
      181, 121, 348, 290, 232, 174, 117, 316, 264, 211, 158, 106, 320, 267, 214,
      160, 107, 286, 239, 191, 143, 96, 256, 213, 171, 128, 85, 240, 200, 160, 120,
      81, 239, 199, 159, 120, 80, 205, 171, 137, 102, 68, 189, 157, 126, 94, 63,
      160, 134, 107, 80, 53, 152, 126, 101, 76, 50, 153, 128, 102, 76, 51, 148, 123,
      98, 74, 49, 131, 110, 88, 66, 43, 119, 99, 79, 60, 40, 113, 94, 76, 57, 38,
      111, 92, 74, 55, 37, 106, 88, 71, 53, 36, 110, 92, 74, 55, 37, 78, 65, 52, 39,
      25, 86, 72, 57, 43, 28, 68, 56, 45, 34, 22, 70, 58, 47, 35, 24, 58, 48, 39,
      29, 20, 68, 56, 45, 34, 23, 60, 50, 40, 30, 20, 64, 54, 43, 32, 22, 58, 49,
      39, 29, 20, 44, 37, 29, 22, 15, 42, 35, 28, 21, 14, 26, 22, 17, 13, 8, 25, 21,
      17, 13, 8, 16, 13, 11, 8, 5, 16, 13, 10, 8, 5, 9, 7, 6, 4, 3, 7, 6, 5, 4, 2,
      5, 4, 3, 3, 2, 5, 4, 3, 3, 2, 3, 2, 2, 2, 1, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 1,
      1, 1, 1, 0
    ),
  )

  # Run project_raw
  # Iterate over projection function (for all projection units)

  # Get all available subregions
  spatial_levels <- parameters_short_subregions |>
    select(spatial_unit) |>
    distinct() |>
    pull()

  # Set name of variable containing regions in population data
  spatial_unit <- "subregion"

  output_table_subregions <- purrr::map_df(
    .x = spatial_levels,
    .f = ~ project_raw(
      parameters_short_subregions |>
        filter(spatial_unit == .x),
      year_first = 2025,
      year_last = 2025,
      age_groups = 101,
      fert_first = 16,
      fert_last = 50,
      share_born_female = 100 / 205,
      n = population_short_subregions |>
        filter(!!sym(spatial_unit) == .x) |>
        dplyr::pull(n),
      subregional = TRUE
    )
  )

  ## Run test for subregion ----
  expect_snapshot(constructive::construct(output_table_subregions))


  # prepare comparison 1 vs 5 regions ----

  ## prepare data for comparison ----
  ### n in starting populations should be identical in both versions

  ### simplify to make comparable
  compare_pop1r <- population_short |>
    select(-spatial_unit) |>
    arrange(year, nat, sex, age)

  ### simplify to make comparable
  compare_pop5r <- population_short_subregions |>
    summarise(n = sum(n), .by = c(year, nat, sex, age)) |>
    arrange(year, nat, sex, age)


  # run equal starting populations ----
  expect_equal(compare_pop1r, compare_pop5r)

  ### parameters should be identical in both versions
  compare_params_1r <- parameters_short |>
    dplyr::select(-spatial_unit) |>
    arrange(year, nat, sex, age)

  compare_params_5r <- parameters_short_subregions |>
    # remove column that includes redundancy
    dplyr::select(-mig_sub, -spatial_unit) |>
    # remove redundant columns
    dplyr::distinct(year, nat, sex, age, .keep_all = TRUE) |>
    # multiply columns with number-of-people parameters
    # by number of regions to get the n right again
    dplyr::mutate_at(vars(imm_int_n, imm_nat_n, emi_nat_n, mig_nat_n), ~ . * 5) |>
    arrange(year, nat, sex, age)

  # run equal parameters ----
  expect_equal(compare_params_1r, compare_params_5r)


  # Ensure that outputs are different (before data wrangling)
  expect_failure(expect_equal(output_table, output_table_subregions))


  # equal results for projections with 1 vs 5 regions

  # Prepare comparison
  # Identifiers are lacking, compare total N
  N_1r <- output_table |>
    summarise(sum_N = sum(N, na.rm = TRUE))

  N_5r <- output_table_subregions |>
    summarise(sum_N = sum(N, na.rm = TRUE))

  # run equal output ----
  expect_equal(N_1r, N_5r, ignore_attr = TRUE)
})
